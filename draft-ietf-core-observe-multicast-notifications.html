<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Observe Notifications as CoAP Multicast Responses</title>
<meta content="Marco Tiloca" name="author">
<meta content="Rikard Höglund" name="author">
<meta content="Christian Amsüss" name="author">
<meta content="Francesca Palombini" name="author">
<meta content='
       The Constrained Application Protocol (CoAP) allows clients to "observe" resources at a server, and receive notifications as unicast responses upon changes of the resource state. In some use cases, such as based on publish-subscribe, it would be convenient for the server to send a single notification addressed to all the clients observing a same target resource. This document updates RFC7252 and RFC7641, and defines how a server sends observe notifications as response messages over multicast, synchronizing  all the observers of a same resource on a same shared Token value. Besides, this document defines how Group OSCORE can be used to protect multicast notifications end-to-end between the server and the observer clients. 
    ' name="description">
<meta content="xml2rfc 3.27.0" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-ietf-core-observe-multicast-notifications-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.27.0
    Python 3.12.9
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.5
    lxml 5.3.0
    platformdirs 4.3.6
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.3
    setuptools 70.3.0
    wcwidth 0.2.13
-->
<link href="draft-ietf-core-observe-multicast-notifications.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Observe Multicast Notifications</td>
<td class="right">February 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Tiloca, et al.</td>
<td class="center">Expires 31 August 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">CoRE Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-core-observe-multicast-notifications-latest</dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a href="https://www.rfc-editor.org/rfc/rfc7252" class="eref">7252</a>, <a href="https://www.rfc-editor.org/rfc/rfc7641" class="eref">7641</a> (if approved)</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-02-27" class="published">27 February 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-08-31">31 August 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. Tiloca</div>
<div class="org">RISE AB</div>
</div>
<div class="author">
      <div class="author-name">R. Höglund</div>
<div class="org">RISE AB</div>
</div>
<div class="author">
      <div class="author-name">C. Amsüss</div>
</div>
<div class="author">
      <div class="author-name">F. Palombini</div>
<div class="org">Ericsson AB</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Observe Notifications as CoAP Multicast Responses</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">The Constrained Application Protocol (CoAP) allows clients to "observe" resources at a server, and receive notifications as unicast responses upon changes of the resource state. In some use cases, such as based on publish-subscribe, it would be convenient for the server to send a single notification addressed to all the clients observing a same target resource. This document updates RFC7252 and RFC7641, and defines how a server sends observe notifications as response messages over multicast, synchronizing  all the observers of a same resource on a same shared Token value. Besides, this document defines how Group OSCORE can be used to protect multicast notifications end-to-end between the server and the observer clients.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Discussion of this document takes place on the
  Constrained RESTful Environments Working Group mailing list (core@ietf.org),
  which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/core/">https://mailarchive.ietf.org/arch/browse/core/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
  <span><a href="https://github.com/core-wg/observe-multicast-notifications">https://github.com/core-wg/observe-multicast-notifications</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 31 August 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-prerequisites" class="internal xref">Prerequisites</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-high-level-overview-of-avai" class="internal xref">High-Level Overview of Available Variants</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-server-side-requirements" class="internal xref">Server-Side Requirements</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-request" class="internal xref">Request</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-informative-response" class="internal xref">Informative Response</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="auto internal xref">4.2.1</a>.  <a href="#name-transport-specific-message-" class="internal xref">Transport-Specific Message Information</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a href="#section-4.2.2" class="auto internal xref">4.2.2</a>.  <a href="#name-transport-independent-messa" class="internal xref">Transport-Independent Message Information</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-notifications" class="internal xref">Notifications</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.  <a href="#name-congestion-control" class="internal xref">Congestion Control</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="auto internal xref">4.5</a>.  <a href="#name-cancellation" class="internal xref">Cancellation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-client-side-requirements" class="internal xref">Client-Side Requirements</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-request-2" class="internal xref">Request</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-informative-response-2" class="internal xref">Informative Response</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-notifications-2" class="internal xref">Notifications</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="auto internal xref">5.4</a>.  <a href="#name-cancellation-2" class="internal xref">Cancellation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-web-linking" class="internal xref">Web Linking</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-example" class="internal xref">Example</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-rough-counting-of-clients-i" class="internal xref">Rough Counting of Clients in the Group Observation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-multicast-response-feedback" class="internal xref">Multicast-Response-Feedback-Divider Option</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-processing-on-the-client-si" class="internal xref">Processing on the Client Side</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-processing-on-the-server-si" class="internal xref">Processing on the Server Side</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3.2.1">
                    <p id="section-toc.1-1.8.2.3.2.1.1"><a href="#section-8.3.1" class="auto internal xref">8.3.1</a>.  <a href="#name-request-for-feedback" class="internal xref">Request for Feedback</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3.2.2">
                    <p id="section-toc.1-1.8.2.3.2.2.1"><a href="#section-8.3.2" class="auto internal xref">8.3.2</a>.  <a href="#name-collection-of-feedback" class="internal xref">Collection of Feedback</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3.2.3">
                    <p id="section-toc.1-1.8.2.3.2.3.1"><a href="#section-8.3.3" class="auto internal xref">8.3.3</a>.  <a href="#name-processing-of-feedback" class="internal xref">Processing of Feedback</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="auto internal xref">8.4</a>.  <a href="#name-impact-from-proxies" class="internal xref">Impact from Proxies</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-protection-of-multicast-not" class="internal xref">Protection of Multicast Notifications with Group OSCORE</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-signaling-the-oscore-group-" class="internal xref">Signaling the OSCORE Group in the Informative Response</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-server-side-requirements-2" class="internal xref">Server-Side Requirements</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.1">
                    <p id="section-toc.1-1.9.2.2.2.1.1"><a href="#section-9.2.1" class="auto internal xref">9.2.1</a>.  <a href="#name-registration" class="internal xref">Registration</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.2">
                    <p id="section-toc.1-1.9.2.2.2.2.1"><a href="#section-9.2.2" class="auto internal xref">9.2.2</a>.  <a href="#name-informative-response-3" class="internal xref">Informative Response</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.3">
                    <p id="section-toc.1-1.9.2.2.2.3.1"><a href="#section-9.2.3" class="auto internal xref">9.2.3</a>.  <a href="#name-notifications-3" class="internal xref">Notifications</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.4">
                    <p id="section-toc.1-1.9.2.2.2.4.1"><a href="#section-9.2.4" class="auto internal xref">9.2.4</a>.  <a href="#name-cancellation-3" class="internal xref">Cancellation</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#section-9.3" class="auto internal xref">9.3</a>.  <a href="#name-client-side-requirements-2" class="internal xref">Client-Side Requirements</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3.2.1">
                    <p id="section-toc.1-1.9.2.3.2.1.1"><a href="#section-9.3.1" class="auto internal xref">9.3.1</a>.  <a href="#name-informative-response-4" class="internal xref">Informative Response</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3.2.2">
                    <p id="section-toc.1-1.9.2.3.2.2.1"><a href="#section-9.3.2" class="auto internal xref">9.3.2</a>.  <a href="#name-notifications-4" class="internal xref">Notifications</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-example-with-group-oscore" class="internal xref">Example with Group OSCORE</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-intermediaries" class="internal xref">Intermediaries</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-intermediaries-together-wit" class="internal xref">Intermediaries Together with End-to-End Security</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="auto internal xref">12.1</a>.  <a href="#name-listen-to-multicast-respons" class="internal xref">Listen-To-Multicast-Responses Option</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-12.2" class="auto internal xref">12.2</a>.  <a href="#name-message-processing" class="internal xref">Message Processing</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="auto internal xref">13</a>. <a href="#name-informative-response-parame" class="internal xref">Informative Response Parameters</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14" class="auto internal xref">14</a>. <a href="#name-transport-protocol-informat" class="internal xref">Transport Protocol Information</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#section-15" class="auto internal xref">15</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1">
                <p id="section-toc.1-1.15.2.1.1"><a href="#section-15.1" class="auto internal xref">15.1</a>.  <a href="#name-unprotected-communications" class="internal xref">Unprotected Communications</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.2">
                <p id="section-toc.1-1.15.2.2.1"><a href="#section-15.2" class="auto internal xref">15.2</a>.  <a href="#name-protected-communications" class="internal xref">Protected Communications</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.3">
                <p id="section-toc.1-1.15.2.3.1"><a href="#section-15.3" class="auto internal xref">15.3</a>.  <a href="#name-listen-to-multicast-response" class="internal xref">Listen-To-Multicast-Responses Option</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#section-16" class="auto internal xref">16</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.1">
                <p id="section-toc.1-1.16.2.1.1"><a href="#section-16.1" class="auto internal xref">16.1</a>.  <a href="#name-media-type-registrations" class="internal xref">Media Type Registrations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.2">
                <p id="section-toc.1-1.16.2.2.1"><a href="#section-16.2" class="auto internal xref">16.2</a>.  <a href="#name-coap-content-formats-regist" class="internal xref">CoAP Content-Formats Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.3">
                <p id="section-toc.1-1.16.2.3.1"><a href="#section-16.3" class="auto internal xref">16.3</a>.  <a href="#name-coap-option-numbers-registr" class="internal xref">CoAP Option Numbers Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.4">
                <p id="section-toc.1-1.16.2.4.1"><a href="#section-16.4" class="auto internal xref">16.4</a>.  <a href="#name-informative-response-paramete" class="internal xref">Informative Response Parameters Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.5">
                <p id="section-toc.1-1.16.2.5.1"><a href="#section-16.5" class="auto internal xref">16.5</a>.  <a href="#name-coap-transport-information-r" class="internal xref">CoAP Transport Information Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.6">
                <p id="section-toc.1-1.16.2.6.1"><a href="#section-16.6" class="auto internal xref">16.6</a>.  <a href="#name-target-attributes-registry" class="internal xref">Target Attributes Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.7">
                <p id="section-toc.1-1.16.2.7.1"><a href="#section-16.7" class="auto internal xref">16.7</a>.  <a href="#name-expert-review-instructions" class="internal xref">Expert Review Instructions</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#section-17" class="auto internal xref">17</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.1">
                <p id="section-toc.1-1.17.2.1.1"><a href="#section-17.1" class="auto internal xref">17.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.2">
                <p id="section-toc.1-1.17.2.2.1"><a href="#section-17.2" class="auto internal xref">17.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18">
            <p id="section-toc.1-1.18.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-different-sources-for-group" class="internal xref">Different Sources for Group Observation Data</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.1">
                <p id="section-toc.1-1.18.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-topic-discovery-in-publish-" class="internal xref">Topic Discovery in Publish-Subscribe Settings</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.2">
                <p id="section-toc.1-1.18.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-introspection-at-the-multic" class="internal xref">Introspection at the Multicast Notification Sender</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19">
            <p id="section-toc.1-1.19.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-pseudo-code-for-rough-count" class="internal xref">Pseudo-Code for Rough Counting of Clients</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.1">
                <p id="section-toc.1-1.19.2.1.1"><a href="#appendix-B.1" class="auto internal xref">B.1</a>.  <a href="#name-client-side" class="internal xref">Client Side</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.2">
                <p id="section-toc.1-1.19.2.2.1"><a href="#appendix-B.2" class="auto internal xref">B.2</a>.  <a href="#name-client-side-optimized-versi" class="internal xref">Client Side - Optimized Version</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.3">
                <p id="section-toc.1-1.19.2.3.1"><a href="#appendix-B.3" class="auto internal xref">B.3</a>.  <a href="#name-server-side" class="internal xref">Server Side</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20">
            <p id="section-toc.1-1.20.1"><a href="#appendix-C" class="auto internal xref">Appendix C</a>.  <a href="#name-oscore-group-self-managed-b" class="internal xref">OSCORE Group Self-Managed by the Server</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21">
            <p id="section-toc.1-1.21.1"><a href="#appendix-D" class="auto internal xref">Appendix D</a>.  <a href="#name-phantom-request-as-determin" class="internal xref">Phantom Request as Deterministic Request</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.22">
            <p id="section-toc.1-1.22.1"><a href="#appendix-E" class="auto internal xref">Appendix E</a>.  <a href="#name-example-with-a-proxy" class="internal xref">Example with a Proxy</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.23">
            <p id="section-toc.1-1.23.1"><a href="#appendix-F" class="auto internal xref">Appendix F</a>.  <a href="#name-example-with-a-proxy-and-gr" class="internal xref">Example with a Proxy and Group OSCORE</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.24">
            <p id="section-toc.1-1.24.1"><a href="#appendix-G" class="auto internal xref">Appendix G</a>.  <a href="#name-example-with-a-proxy-and-de" class="internal xref">Example with a Proxy and Deterministic Requests</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.24.2.1">
                <p id="section-toc.1-1.24.2.1.1"><a href="#appendix-G.1" class="auto internal xref">G.1</a>.  <a href="#name-assumptions-and-walkthrough" class="internal xref">Assumptions and Walkthrough</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.24.2.2">
                <p id="section-toc.1-1.24.2.2.1"><a href="#appendix-G.2" class="auto internal xref">G.2</a>.  <a href="#name-message-exchange" class="internal xref">Message Exchange</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.25">
            <p id="section-toc.1-1.25.1"><a href="#appendix-H" class="auto internal xref">Appendix H</a>.  <a href="#name-document-updates" class="internal xref">Document Updates</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.25.2.1">
                <p id="section-toc.1-1.25.2.1.1"><a href="#appendix-H.1" class="auto internal xref">H.1</a>.  <a href="#name-version-10-to-11" class="internal xref">Version -10 to -11</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.25.2.2">
                <p id="section-toc.1-1.25.2.2.1"><a href="#appendix-H.2" class="auto internal xref">H.2</a>.  <a href="#name-version-09-to-10" class="internal xref">Version -09 to -10</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.25.2.3">
                <p id="section-toc.1-1.25.2.3.1"><a href="#appendix-H.3" class="auto internal xref">H.3</a>.  <a href="#name-version-08-to-09" class="internal xref">Version -08 to -09</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.25.2.4">
                <p id="section-toc.1-1.25.2.4.1"><a href="#appendix-H.4" class="auto internal xref">H.4</a>.  <a href="#name-version-07-to-08" class="internal xref">Version -07 to -08</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.25.2.5">
                <p id="section-toc.1-1.25.2.5.1"><a href="#appendix-H.5" class="auto internal xref">H.5</a>.  <a href="#name-version-06-to-07" class="internal xref">Version -06 to -07</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.25.2.6">
                <p id="section-toc.1-1.25.2.6.1"><a href="#appendix-H.6" class="auto internal xref">H.6</a>.  <a href="#name-version-05-to-06" class="internal xref">Version -05 to -06</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.25.2.7">
                <p id="section-toc.1-1.25.2.7.1"><a href="#appendix-H.7" class="auto internal xref">H.7</a>.  <a href="#name-version-04-to-05" class="internal xref">Version -04 to -05</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.25.2.8">
                <p id="section-toc.1-1.25.2.8.1"><a href="#appendix-H.8" class="auto internal xref">H.8</a>.  <a href="#name-version-03-to-04" class="internal xref">Version -03 to -04</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.25.2.9">
                <p id="section-toc.1-1.25.2.9.1"><a href="#appendix-H.9" class="auto internal xref">H.9</a>.  <a href="#name-version-02-to-03" class="internal xref">Version -02 to -03</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.25.2.10">
                <p id="section-toc.1-1.25.2.10.1"><a href="#appendix-H.10" class="auto internal xref">H.10</a>. <a href="#name-version-01-to-02" class="internal xref">Version -01 to -02</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.25.2.11">
                <p id="section-toc.1-1.25.2.11.1"><a href="#appendix-H.11" class="auto internal xref">H.11</a>. <a href="#name-version-00-to-01" class="internal xref">Version -00 to -01</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.26">
            <p id="section-toc.1-1.26.1"><a href="#appendix-I" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.27">
            <p id="section-toc.1-1.27.1"><a href="#appendix-J" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="intro">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">The Constrained Application Protocol (CoAP) <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span> has been extended with a number of mechanisms, including resource Observation <span>[<a href="#RFC7641" class="cite xref">RFC7641</a>]</span>. This enables CoAP clients to register at a CoAP server as "observers" of a resource, and hence being automatically notified with an unsolicited response upon changes of the resource state.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">CoAP supports group communication <span>[<a href="#I-D.ietf-core-groupcomm-bis" class="cite xref">I-D.ietf-core-groupcomm-bis</a>]</span>, e.g., over IP multicast. This includes support for Observe registration requests over multicast, in order for clients to efficiently register as observers of a resource hosted at multiple servers.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">However, in a number of use cases, using multicast messages for responses would also be desirable. That is, it would be useful that a server sends observe notifications for a same target resource to multiple observers as responses over IP multicast.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">For instance, in CoAP publish-subscribe <span>[<a href="#I-D.ietf-core-coap-pubsub" class="cite xref">I-D.ietf-core-coap-pubsub</a>]</span>, multiple clients can subscribe to a topic, by observing the related resource hosted at the responsible broker. When a new value is published on that topic, it would be convenient for the broker to send a single multicast notification at once, to all the subscriber clients observing that topic.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">A different use case concerns clients observing a same registration resource at the CoRE Resource Directory <span>[<a href="#RFC9176" class="cite xref">RFC9176</a>]</span>. For example, multiple clients can benefit of observation for discovering (to-be-created) groups that use the security protocol Group Object Security for Constrained RESTful Environments (Group OSCORE) <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>, by retrieving from the Resource Directory updated links and descriptions to join those groups through the respective Group Manager <span>[<a href="#I-D.tiloca-core-oscore-discovery" class="cite xref">I-D.tiloca-core-oscore-discovery</a>]</span>.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">More in general, multicast notifications would be beneficial whenever several CoAP clients observe a same target resource at a CoAP server, and can be all notified at once by means of a single response message. However, CoAP does not originally define response messages addressed to multiple clients, e.g., over IP multicast. This document fills this gap and provides the following twofold contribution.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">First, it updates <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span> and <span>[<a href="#RFC7641" class="cite xref">RFC7641</a>]</span>, by defining a method to deliver Observe notifications as CoAP responses addressed to multiple clients, e.g., over IP multicast. In particular, the group of potential observers entrusts the server to manage the Token space for multicast notifications. Building on that, the server provides all the observers of a target resource with the same Token value to bind to their own observation, by sending a unicast informative response to each observer client. That Token value is then used in every multicast notification for the target resource under that observation.<a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8">Second, this document defines how to use Group OSCORE <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span> to protect multicast notifications end-to-end between the server and the observer clients. This is also achieved by means of the unicast informative response mentioned above, which additionally includes parameter values used by the server to protect every multicast notification for the target resource by using Group OSCORE. This provides a secure binding between each of such notifications and the observation of each of the clients.<a href="#section-1-8" class="pilcrow">¶</a></p>
<div id="terminology">
<section id="section-1.1">
        <h3 id="name-terminology">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.1-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">Readers are expected to be familiar with terms and concepts described in CoAP <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>, group communication for CoAP <span>[<a href="#I-D.ietf-core-groupcomm-bis" class="cite xref">I-D.ietf-core-groupcomm-bis</a>]</span>, Observe <span>[<a href="#RFC7641" class="cite xref">RFC7641</a>]</span>, Concise Data Definition Language (CDDL) <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span>, Concise Binary Object Representation (CBOR) <span>[<a href="#RFC8949" class="cite xref">RFC8949</a>]</span>, Object Security for Constrained RESTful Environments (OSCORE) <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>, Group OSCORE <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>, and Constrained Resource Identifiers (CRIs) <span>[<a href="#I-D.ietf-core-href" class="cite xref">I-D.ietf-core-href</a>]</span>.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<p id="section-1.1-3">This document additionally defines the following terminology.<a href="#section-1.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-4.1">
            <p id="section-1.1-4.1.1">Traditional observation. A resource observation associated with a single observer client, as defined in <span>[<a href="#RFC7641" class="cite xref">RFC7641</a>]</span>.<a href="#section-1.1-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-4.2">
            <p id="section-1.1-4.2.1">Group observation. A resource observation associated with a group of clients. The server sends notifications for the group-observed resource over IP multicast to all the observer clients.<a href="#section-1.1-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-4.3">
            <p id="section-1.1-4.3.1">Phantom request. The CoAP request message that the server would have received to start a group observation on one of its resources. A phantom request is generated inside the server and does not hit the wire.<a href="#section-1.1-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-4.4">
            <p id="section-1.1-4.4.1">Informative response. A CoAP response message that the server sends to a given client via unicast, providing the client with information on a group observation.<a href="#section-1.1-4.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="sec-prereq">
<section id="section-2">
      <h2 id="name-prerequisites">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-prerequisites" class="section-name selfRef">Prerequisites</a>
      </h2>
<p id="section-2-1">In order to use multicast notifications as defined in this document, the following prerequisites have to be fulfilled.<a href="#section-2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-2.1">
          <p id="section-2-2.1.1">The server and the clients need to be on a network on which multicast notifications can reach a sufficiently large portion of the clients. These may leverage intermediaries such as proxies, if some clients are not able to directly listen to multicast traffic.<a href="#section-2-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-2.2">
          <p id="section-2-2.2.1">The server needs to be provisioned with multicast addresses whose token space is placed under its control. On general purpose networks, unmanaged multicast addresses such as "All CoAP Nodes" (see <span><a href="https://rfc-editor.org/rfc/rfc7252#section-12.8" class="relref">Section 12.8</a> of [<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>) are not suitable for this purpose.<a href="#section-2-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-2.3">
          <p id="section-2-2.3.1">The server and the clients need to agree out-of-band that multicast notifications may be used.<a href="#section-2-2.3.1" class="pilcrow">¶</a></p>
<p id="section-2-2.3.2">
This document does not describe a way for a client to influence the server's decision to start group observations and thus to use multicast notifications. This is done on purpose.<a href="#section-2-2.3.2" class="pilcrow">¶</a></p>
<p id="section-2-2.3.3">
That is, the method specified in this document is expected to be used in situations where sending individual notifications is not feasible, or is not preferred beyond a certain number of clients observing a target resource.<a href="#section-2-2.3.3" class="pilcrow">¶</a></p>
<p id="section-2-2.3.4">
If applications arise where a negotiation between the clients and the server does make sense, those applications are welcome to specify additional means for clients to opt in for receiving multicast notifications.<a href="#section-2-2.3.4" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="sec-variants">
<section id="section-3">
      <h2 id="name-high-level-overview-of-avai">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-high-level-overview-of-avai" class="section-name selfRef">High-Level Overview of Available Variants</a>
      </h2>
<p id="section-3-1">The method defined in this document fundamentally enables a server to set up a group observation. This is associated with a phantom observation request generated by the server, and to which the multicast notifications of the group observation are bound.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">While the server can provide the phantom request in question to the interested clients as they reach out for registering to the group observation, the server may alternatively distribute the phantom request in advance by alternative means (e.g., see <a href="#appendix-different-sources" class="auto internal xref">Appendix A</a>). Clients that have already retrieved the phantom request can immediately start listening to multicast notifications if able to directly do so, or instead instruct an assisting intermediary such as a proxy to do that on their behalf.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">The following provides an overview of the available variants to enforce a group observation, depending on whether a proxy is deployed or not, and on whether exchanged messages are protected end-to-end between the observer clients and the server.<a href="#section-3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-4.1">
          <p id="section-3-4.1.1">Without proxy - This is the simplest network configuration, where the clients participating in the group observation are capable to listen to multicast traffic. In such a setup, the clients directly receive multicast notifications from the server.<a href="#section-3-4.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-4.1.2.1">
              <p id="section-3-4.1.2.1.1">Without end-to-end security - Messages pertaining to the group observation are not protected. This basic case is defined in <a href="#sec-server-side" class="auto internal xref">Section 4</a> and <a href="#sec-client-side" class="auto internal xref">Section 5</a> from the server and the client side, respectively. An example is provided in <a href="#sec-example-no-security" class="auto internal xref">Section 7</a>.<a href="#section-3-4.1.2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3-4.1.2.2">
              <p id="section-3-4.1.2.2.1">With end-to-end security - Messages pertaining to the group observation are protected end-to-end between the clients and the server, by using the security protocol Group OSCORE <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>. This case is defined in <a href="#sec-secured-notifications" class="auto internal xref">Section 9</a>. An example is provided in <a href="#sec-example-with-security" class="auto internal xref">Section 10</a>.<a href="#section-3-4.1.2.2.1" class="pilcrow">¶</a></p>
<p id="section-3-4.1.2.2.2">
If the participating endpoints using Group OSCORE also support the concept of Deterministic Client <span>[<a href="#I-D.amsuess-core-cachable-oscore" class="cite xref">I-D.amsuess-core-cachable-oscore</a>]</span>, then the possible early distribution of the phantom request can specifically make available its smaller, plain version. Then, all the clients are able to compute the same protected phantom request to use (see <a href="#deterministic-phantom-Request" class="auto internal xref">Appendix D</a>).<a href="#section-3-4.1.2.2.2" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
        <li class="normal" id="section-3-4.2">
          <p id="section-3-4.2.1">With proxy - This network configuration is expected in case (some of) the clients participating in the group observation are not capable to listen to multicast traffic. In such a setup, the proxy directly receives multicast notifications from the server, and relays them back to the clients.<a href="#section-3-4.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-4.2.2.1">
              <p id="section-3-4.2.2.1.1">Without end-to-end security - Messages pertaining to the group observation are not protected end-to-end between the clients and the server. This basic case is defined in <a href="#intermediaries" class="auto internal xref">Section 11</a>. An example is provided in <a href="#intermediaries-example" class="auto internal xref">Appendix E</a>.<a href="#section-3-4.2.2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3-4.2.2.2">
              <p id="section-3-4.2.2.2.1">With end-to-end security - Messages pertaining to the group observation are protected end-to-end between the clients and the server, by using the security protocol Group OSCORE <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>. In particular, the clients are required to separately provide the proxy with the obtained phantom request, thus enabling the proxy to receive the multicast notifications from the server. This case is defined in <a href="#intermediaries-e2e-security" class="auto internal xref">Section 12</a>. An example is provided in <a href="#intermediaries-example-e2e-security" class="auto internal xref">Appendix F</a>.<a href="#section-3-4.2.2.2.1" class="pilcrow">¶</a></p>
<p id="section-3-4.2.2.2.2">
If the participating endpoints using Group OSCORE also support the concept of Deterministic Client <span>[<a href="#I-D.amsuess-core-cachable-oscore" class="cite xref">I-D.amsuess-core-cachable-oscore</a>]</span>, the same advantages mentioned above for the case without a proxy applies (see <a href="#deterministic-phantom-Request" class="auto internal xref">Appendix D</a>). In addition, this allows for a more efficient setup and enforcement of the group observation, by reducing the amount of message exchanges and allowing the proxy to effectively serve protected multicast notifications from its cache. An example is provided in <a href="#intermediaries-example-e2e-security-det-exchange" class="auto internal xref">Appendix G.2</a>.<a href="#section-3-4.2.2.2.2" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
      </ul>
</section>
</div>
<div id="sec-server-side">
<section id="section-4">
      <h2 id="name-server-side-requirements">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-server-side-requirements" class="section-name selfRef">Server-Side Requirements</a>
      </h2>
<p id="section-4-1">The server can, at any time, start a group observation on one of its resources. Practically, the server may want to do that under the following circumstances.<a href="#section-4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-2.1">
          <p id="section-4-2.1.1">In the absence of observations for the target resource, the server receives a registration request from a first client wishing to start a traditional observation on that resource.<a href="#section-4-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-2.2">
          <p id="section-4-2.2.1">When a certain amount of traditional observations has been established on the target resource, the server decides to make the corresponding observer clients part of a group observation on that resource.<a href="#section-4-2.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-4-3">The server maintains an observer counter for each group observation to a target resource, as a rough estimation of the observers actively taking part in the group observation.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">The server initializes the counter to 0 when starting the group observation, and increments it after a new client starts taking part in that group observation. Also, the server should keep the counter up-to-date over time, for instance by using the method described in <a href="#sec-rough-counting" class="auto internal xref">Section 8</a>. This allows the server to possibly terminate a group observation in case, at some point in time, not enough clients are estimated to be still active and interested.<a href="#section-4-4" class="pilcrow">¶</a></p>
<div id="ssec-server-side-request">
<section id="section-4.1">
        <h3 id="name-request">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-request" class="section-name selfRef">Request</a>
        </h3>
<p id="section-4.1-1">Assuming that the server is reachable at the address SRV_ADDR and port number SRV_PORT, the server starts a group observation on one of its resources as defined below. The server intends to send multicast notifications for the target resource to the multicast IP address GRP_ADDR and port number GRP_PORT.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.1-2">
<li id="section-4.1-2.1">
            <p id="section-4.1-2.1.1">The server builds a phantom observation request, i.e., a GET request with an Observe Option set to 0 (register).<a href="#section-4.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.1-2.2">
            <p id="section-4.1-2.2.1">The server selects an available value T, from the Token space of a CoAP endpoint used for messages that have:<a href="#section-4.1-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-2.2.2.1">
                <p id="section-4.1-2.2.2.1.1">As source address and port number, the IP multicast address GRP_ADDR and port number GRP_PORT.<a href="#section-4.1-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.1-2.2.2.2">
                <p id="section-4.1-2.2.2.2.1">As destination address and port number, the server address SRV_ADDR and port number SRV_PORT, intended for accessing the target resource.<a href="#section-4.1-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-4.1-2.2.3">
This Token space is under exclusive control of the server.<a href="#section-4.1-2.2.3" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.1-2.3">
            <p id="section-4.1-2.3.1">The server processes the phantom observation request above, without transmitting it on the wire. The request is addressed to the resource for which the server wants to start the group observation, as if sent by the group of observers, i.e., with GRP_ADDR as source address and GRP_PORT as source port.<a href="#section-4.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.1-2.4">
            <p id="section-4.1-2.4.1">Upon processing the self-generated phantom registration request, the server interprets it as an observe registration received from the group of potential observer clients. In particular, from then on, the server <span class="bcp14">MUST</span> use T as its own local Token value associated with that observation, with respect to the (previous hop towards the) clients.<a href="#section-4.1-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.1-2.5">
            <p id="section-4.1-2.5.1">The server does not immediately respond to the phantom observation request with a multicast notification sent on the wire. The server stores the phantom observation request as is, throughout the lifetime of the group observation.<a href="#section-4.1-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.1-2.6">
            <p id="section-4.1-2.6.1">The server builds a CoAP response message INIT_NOTIF as initial multicast notification for the target resource, in response to the phantom observation request. This message is formatted as other multicast notifications (see <a href="#ssec-server-side-notifications" class="auto internal xref">Section 4.3</a>) and <span class="bcp14">MUST</span> include the current representation of the target resource as payload.<a href="#section-4.1-2.6.1" class="pilcrow">¶</a></p>
<p id="section-4.1-2.6.2">
The server stores the message INIT_NOTIF and does not transmit it. The server considers this message as the latest multicast notification for the target resource, until it transmits a new multicast notification for that resource as a CoAP message on the wire, after which the server deletes the message INIT_NOTIF.<a href="#section-4.1-2.6.2" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="ssec-server-side-informative">
<section id="section-4.2">
        <h3 id="name-informative-response">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-informative-response" class="section-name selfRef">Informative Response</a>
        </h3>
<p id="section-4.2-1">After having started a group observation on a target resource, the server proceeds as follows.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">For each traditional observation ongoing on the target resource, the server <span class="bcp14">MAY</span> cancel that observation. Then, the server considers the corresponding clients as now taking part in the group observation, for which it increases the corresponding observer counter accordingly.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">The server sends to each of such clients an informative response message, encoded as a unicast response with response code 5.03 (Service Unavailable). As per <span>[<a href="#RFC7641" class="cite xref">RFC7641</a>]</span>, such a response does not include an Observe Option. The response <span class="bcp14">MUST</span> be Confirmable and <span class="bcp14">MUST NOT</span> encode link-local addresses.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2-4">The Content-Format of the informative response is set to "application/informative-response+cbor", which is registered in <a href="#content-format" class="auto internal xref">Section 16.2</a>. The payload of the informative response is a CBOR map including the following parameters, whose CBOR abbreviations are defined in <a href="#informative-response-params" class="auto internal xref">Section 13</a>.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-5.1">
            <p id="section-4.2-5.1.1">'tp_info', with value a CBOR array. This includes the transport-specific information required to correctly receive multicast notifications bound to the phantom observation request. Typically, this comprises the Token value associated with the group observation, as well as the source and destination addressing information of the related multicast notifications. The CBOR array is formatted as defined in <a href="#sssec-transport-specific-encoding" class="auto internal xref">Section 4.2.1</a>. This parameter <span class="bcp14">MUST</span> be included.<a href="#section-4.2-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-5.2">
            <p id="section-4.2-5.2.1">'ph_req', with value the byte serialization of the transport-independent information of the phantom observation request (see <a href="#ssec-server-side-request" class="auto internal xref">Section 4.1</a>), encoded as a CBOR byte string. The value of the CBOR byte string is formatted as defined in <a href="#sssec-transport-independent-encoding" class="auto internal xref">Section 4.2.2</a>.<a href="#section-4.2-5.2.1" class="pilcrow">¶</a></p>
<p id="section-4.2-5.2.2">
This parameter <span class="bcp14">MAY</span> be omitted, in case the phantom request is, in terms of transport-independent information, identical to the registration request from the client. Otherwise, this parameter <span class="bcp14">MUST</span> be included.<a href="#section-4.2-5.2.2" class="pilcrow">¶</a></p>
<p id="section-4.2-5.2.3">
Note that the registration request from the client may indeed differ from the phantom observation request in terms of transport-independent information, but still be acceptable for the server to register the client as taking part in the group observation.<a href="#section-4.2-5.2.3" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-5.3">
            <p id="section-4.2-5.3.1">'last_notif', with value the byte serialization of the transport-independent information of the latest multicast notification for the target resource, encoded as a CBOR byte string. The value of the CBOR byte string is formatted as defined in <a href="#sssec-transport-independent-encoding" class="auto internal xref">Section 4.2.2</a>. This parameter <span class="bcp14">MAY</span> be included.<a href="#section-4.2-5.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-5.4">
            <p id="section-4.2-5.4.1">'next_not_before', with value the amount of seconds that will minimally elapse before the server sends the next multicast notification for the group observation of the target resource, encoded as a CBOR unsigned integer. This parameter <span class="bcp14">MAY</span> be included.<a href="#section-4.2-5.4.1" class="pilcrow">¶</a></p>
<p id="section-4.2-5.4.2">
This information can help a new client to align itself with the server's timeline, especially in scenarios where multicast notifications are regularly sent. Also, it can help synchronizing different clients when orchestrating a content distribution through multicast notifications.<a href="#section-4.2-5.4.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-5.5">
            <p id="section-4.2-5.5.1">'ending', with value the point in time when the group observation of the target resource is planned to be canceled, encoded as a CBOR unsigned integer. The value is the number of seconds from 1970-01-01T00:00:00Z UTC until the specified UTC date/time, ignoring leap seconds, analogous to what is specified for NumericDate in <span><a href="https://rfc-editor.org/rfc/rfc7519#section-2" class="relref">Section 2</a> of [<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>. This parameter <span class="bcp14">MAY</span> be included.<a href="#section-4.2-5.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.2-6">The CDDL notation <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span> provided below describes the payload of the informative response.<a href="#section-4.2-6" class="pilcrow">¶</a></p>
<span id="name-format-of-the-informative-r"></span><div id="informative-response-payload">
<figure id="figure-1">
          <div class="alignLeft art-text artwork" id="section-4.2-7.1">
<pre>
informative_response_payload = {
   0 =&gt; array, ; 'tp_info' (transport-specific information)
 ? 1 =&gt; bstr,  ; 'ph_req' (transport-independent information)
 ? 2 =&gt; bstr,  ; 'last_notif' (transport-independent information)
 ? 3 =&gt; uint   ; 'next_not_before',
 ? 4 =&gt; uint   ; 'ending'
}
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-format-of-the-informative-r" class="selfRef">Format of the Informative Response Payload</a>
          </figcaption></figure>
</div>
<p id="section-4.2-8">Upon receiving a registration request to observe the target resource, the server does not create a corresponding individual observation for the requesting client. Instead, the server considers that client as now taking part in the group observation of the target resource, of which it increments the observer counter by 1. Then, the server replies to the client with the same informative response message defined above, which <span class="bcp14">MUST</span> be Confirmable.<a href="#section-4.2-8" class="pilcrow">¶</a></p>
<p id="section-4.2-9">Note that this also applies when, with no ongoing traditional observations on the target resource, the server receives a registration request from a first client and decides to start a group observation on the target resource.<a href="#section-4.2-9" class="pilcrow">¶</a></p>
<div id="sssec-transport-specific-encoding">
<section id="section-4.2.1">
          <h4 id="name-transport-specific-message-">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-transport-specific-message-" class="section-name selfRef">Transport-Specific Message Information</a>
          </h4>
<p id="section-4.2.1-1">The CBOR array specified in the 'tp_info' parameter is formatted according to the following CDDL notation.<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
<span id="name-general-format-of-tp_info"></span><div id="tp-info-general">
<figure id="figure-2">
            <div class="alignLeft art-text artwork" id="section-4.2.1-2.1">
<pre>
tp_info = [
    tpi_server: CRI-no-local,  ; Addressing information of the server
  ? tpi_details                ; Further information about the request
]

tpi_details = (
  + elements  ; Number, format, and encoding of the elements depend
              ; on the scheme-id of the CRI specified as 'tpi_server'
)

CRI-no-local = [
  scheme-id,
  authority
]

scheme-id = nint  ; -1 - scheme-number

authority = [?userinfo, host, ?port]
userinfo  = (false, text .feature "userinfo")
host      = (host-ip // host-name)
host-name = (*text) ; lowercase, NFC labels
host-ip   = (bytes .size 4 //
               (bytes .size 16, ?zone-id))
zone-id   = text
port      = 0..65535
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-general-format-of-tp_info" class="selfRef">General Format of 'tp_info'</a>
            </figcaption></figure>
</div>
<p id="section-4.2.1-3">The following holds for the two elements 'tpi_server' and 'tpi_details'.<a href="#section-4.2.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.1-4.1">
              <p id="section-4.2.1-4.1.1">The 'tpi_server' element <span class="bcp14">MUST</span> be present and specifies:<a href="#section-4.2.1-4.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.1-4.1.2.1">
                  <p id="section-4.2.1-4.1.2.1.1">The transport protocol used to transport a CoAP response from the server, i.e., a multicast notification in this document; and<a href="#section-4.2.1-4.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-4.2.1-4.1.2.2">
                  <p id="section-4.2.1-4.1.2.2.1">The addressing information of the server, i.e., the source addressing information of the multicast notifications that are sent for the group observation.<a href="#section-4.2.1-4.1.2.2.1" class="pilcrow">¶</a></p>
<p id="section-4.2.1-4.1.2.2.2">
Such addressing information <span class="bcp14">MUST</span> be equal to the destination addressing information of the registration requests sent by the clients to observe the target resource at the server.<a href="#section-4.2.1-4.1.2.2.2" class="pilcrow">¶</a></p>
</li>
              </ul>
<p id="section-4.2.1-4.1.3">
This element specifies a CRI <span>[<a href="#I-D.ietf-core-href" class="cite xref">I-D.ietf-core-href</a>]</span>, of which both 'scheme' and 'authority' are given, while 'path', 'query', and 'fragment' are not given. The CRI scheme is given as a negative integer 'scheme-id', with value taken from the "Scheme ID" column of the "CoAP Transport Information" registry defined in <a href="#iana-coap-transport-information" class="auto internal xref">Section 16.5</a> of this document.<a href="#section-4.2.1-4.1.3" class="pilcrow">¶</a></p>
<p id="section-4.2.1-4.1.4">
Consistent with <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-href-18#section-5.1.1" class="relref">Section 5.1.1</a> of [<a href="#I-D.ietf-core-href" class="cite xref">I-D.ietf-core-href</a>]</span>, a 'scheme-id' with value ID denotes the CRI scheme that has CRI scheme number equal to (-1 - ID). The latter identifies the corresponding URI scheme, per the associated entry in the "CRI Scheme Numbers" registry defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-href-18#section-11.1" class="relref">Section 11.1</a> of [<a href="#I-D.ietf-core-href" class="cite xref">I-D.ietf-core-href</a>]</span>.<a href="#section-4.2.1-4.1.4" class="pilcrow">¶</a></p>
<p id="section-4.2.1-4.1.5">
Furthermore, the CRI scheme determines how many elements are required in the 'tpi_details' element of the 'tp_info' array, as well as what information they convey, their encoding, and their semantics.<a href="#section-4.2.1-4.1.5" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.2.1-4.2">
              <p id="section-4.2.1-4.2.1">The 'tpi_details' element <span class="bcp14">MAY</span> be present and specifies transport-specific information related to a pertinent request message, i.e., the phantom observation request in this document.<a href="#section-4.2.1-4.2.1" class="pilcrow">¶</a></p>
<p id="section-4.2.1-4.2.2">
The exact format of 'tpi_details' depends on the CRI scheme of the CRI specified by the 'tpi_server' element.<a href="#section-4.2.1-4.2.2" class="pilcrow">¶</a></p>
<p id="section-4.2.1-4.2.3">
In the "CoAP Transport Information" registry defined in <a href="#iana-coap-transport-information" class="auto internal xref">Section 16.5</a> of this document, the entry corresponding to a certain CRI scheme specifies the list of elements composing 'tpi_details' for that CRI scheme, as value of the column "Transport Information Details". Within 'tpi_details', its elements <span class="bcp14">MUST</span> be ordered according to what is specified in the column "Transport Information Details" of the "CoAP Transport Information" registry.<a href="#section-4.2.1-4.2.3" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.1-5"><a href="#transport-protocol-identifiers" class="auto internal xref">Section 14</a> registers an entry in the "CoAP Transport Information" registry, for the CRI scheme identified by the negative integer -1 ("coap"). This value is used as 'scheme-id' for the CRI in the 'tpi_server' element, when CoAP responses are transported over UDP. In such a case, the full encoding of the 'tp_info' CBOR array is as defined in <a href="#ssssec-udp-transport-specific" class="auto internal xref">Section 4.2.1.1</a>.<a href="#section-4.2.1-5" class="pilcrow">¶</a></p>
<p id="section-4.2.1-6">If a future specification defines the use of CoAP multicast notifications transported over different transport protocols, then that specification <span class="bcp14">MUST</span> perform the following actions, unless those have been already performed for different reasons:<a href="#section-4.2.1-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.1-7.1">
              <p id="section-4.2.1-7.1.1">Define the elements in 'tpi_details', as to what information they convey, their encoding, and their semantics.<a href="#section-4.2.1-7.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.2.1-7.2">
              <p id="section-4.2.1-7.2.1">Register an entry in the "CoAP Transport Information" registry defined in <a href="#iana-coap-transport-information" class="auto internal xref">Section 16.5</a> of this document.<a href="#section-4.2.1-7.2.1" class="pilcrow">¶</a></p>
<p id="section-4.2.1-7.2.2">
The value of the column "Scheme ID" is the negative integer ID to be used as 'scheme-id' for the CRI specified by the 'tpi_server' element, which provides source addressing information of the multicast notifications. The same use applies to the CRI specified by an element of 'tpi_details', which provides destination addressing information of the multicast notifications.<a href="#section-4.2.1-7.2.2" class="pilcrow">¶</a></p>
<p id="section-4.2.1-7.2.3">
As a pre-condition for such a registration, it is <span class="bcp14">REQUIRED</span> that the "CRI Scheme Numbers" registry defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-href-18#section-11.1" class="relref">Section 11.1</a> of [<a href="#I-D.ietf-core-href" class="cite xref">I-D.ietf-core-href</a>]</span> includes an entry where the value in the column "CRI scheme number" is (-1 - ID).<a href="#section-4.2.1-7.2.3" class="pilcrow">¶</a></p>
</li>
          </ul>
<div id="ssssec-udp-transport-specific">
<section id="section-4.2.1.1">
            <h5 id="name-udp-transport-specific-info">
<a href="#section-4.2.1.1" class="section-number selfRef">4.2.1.1. </a><a href="#name-udp-transport-specific-info" class="section-name selfRef">UDP Transport-Specific Information</a>
            </h5>
<p id="section-4.2.1.1-1">When CoAP multicast notifications are transported over UDP as per <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span> and <span>[<a href="#I-D.ietf-core-groupcomm-bis" class="cite xref">I-D.ietf-core-groupcomm-bis</a>]</span>, the server specifies the 'tp_info' CBOR array as follows.<a href="#section-4.2.1.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.1.1-2.1">
                <p id="section-4.2.1.1-2.1.1">In the 'tpi_server' element, the CRI has 'scheme-id' with value -1 ("coap"), while 'authority' conveys addressing information of the server, i.e., the source addressing information of the multicast notifications that are sent for the group observation.<a href="#section-4.2.1.1-2.1.1" class="pilcrow">¶</a></p>
<p id="section-4.2.1.1-2.1.2">
This information consists of the IP address SRV_ADDR (expressed as a literal or resulting from a name resolution) and the port number SRV_PORT of the server hosting the target resource, and from where the server will send multicast notifications for the target resource.<a href="#section-4.2.1.1-2.1.2" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.2.1.1-2.2">
                <p id="section-4.2.1.1-2.2.1">The 'tpi_details' element <span class="bcp14">MUST</span> be present and in turn includes the following two elements:<a href="#section-4.2.1.1-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.1.1-2.2.2.1">
                    <p id="section-4.2.1.1-2.2.2.1.1">'tpi_client' is a CRI, with the same format of 'tpi_server' (see <a href="#sssec-transport-specific-encoding" class="auto internal xref">Section 4.2.1</a>). In particular, the CRI has 'scheme-id' with value -1 ("coap"), while 'authority' conveys the destination addressing information of the multicast notifications that the server sends for the group observation.<a href="#section-4.2.1.1-2.2.2.1.1" class="pilcrow">¶</a></p>
<p id="section-4.2.1.1-2.2.2.1.2">
This information consists of the IP multicast address GRP_ADDR (expressed as a literal or resulting from a name resolution) and the port number GRP_PORT, where the server will send multicast notifications for the target resource.<a href="#section-4.2.1.1-2.2.2.1.2" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-4.2.1.1-2.2.2.2">
                    <p id="section-4.2.1.1-2.2.2.2.1">'tpi_token' is a CBOR byte string, with value the Token value of the phantom observation request generated by the server (see <a href="#ssec-server-side-request" class="auto internal xref">Section 4.1</a>). Note that the same Token value is used for the multicast notifications bound to that phantom observation request (see <a href="#ssec-server-side-notifications" class="auto internal xref">Section 4.3</a>).<a href="#section-4.2.1.1-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
<p id="section-4.2.1.1-3">The CDDL notation in <a href="#tp-info-udp" class="auto internal xref">Figure 3</a> describes the format of the 'tp_info' CBOR array when using UDP as transport protocol.<a href="#section-4.2.1.1-3" class="pilcrow">¶</a></p>
<span id="name-format-of-tp_info-with-udp-"></span><div id="tp-info-udp">
<figure id="figure-3">
              <div class="alignLeft art-text artwork" id="section-4.2.1.1-4.1">
<pre>
tp_info_coap_udp = [
  tpi_server: CRI-no-local,  ; Source addressing information
                             ; of the multicast notifications
  tpi_client: CRI-no-local,  ; Destination addressing information
                             ; of the multicast notifications
  tpi_token: bstr            ; Token value of the phantom request and
                             ; associated multicast notifications
]
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-format-of-tp_info-with-udp-" class="selfRef">Format of 'tp_info' with UDP as Transport Protocol</a>
              </figcaption></figure>
</div>
<p id="section-4.2.1.1-5">The CBOR diagnostic notation in <a href="#tp-info-udp-example" class="auto internal xref">Figure 4</a> provides an example of the 'tp_info' CBOR array when using UDP as transport protocol. In the example, SRV_ADDR is 2001:db8::ab, SRV_PORT is 5683 (omitted in the CRI of 'tpi_server' as it is the CoAP default port number), GRP_ADDR is ff35:30:2001:db8::23, and GRP_PORT is 61616.<a href="#section-4.2.1.1-5" class="pilcrow">¶</a></p>
<span id="name-example-of-tp_info-with-udp"></span><div id="tp-info-udp-example">
<figure id="figure-4">
              <div class="alignLeft art-text artwork" id="section-4.2.1.1-6.1">
<pre>
[ / tp_info /
  [ / tpi_server /
    -1,        / scheme-id -- equivalent to "coap" /
    h'20010db80000000000000000000000ab'  / host-ip /
  ],
  [ / tpi_client /
    -1,        / scheme-id -- equivalent to "coap" /
    h'ff35003020010db80000000000000023', / host-ip /
    61616                                   / port /
  ],
  h'7b'                                / tpi_token /
]
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-example-of-tp_info-with-udp" class="selfRef">Example of 'tp_info' with UDP as Transport Protocol</a>
              </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="sssec-transport-independent-encoding">
<section id="section-4.2.2">
          <h4 id="name-transport-independent-messa">
<a href="#section-4.2.2" class="section-number selfRef">4.2.2. </a><a href="#name-transport-independent-messa" class="section-name selfRef">Transport-Independent Message Information</a>
          </h4>
<p id="section-4.2.2-1">For both the parameters 'ph_req' and 'last_notif' in the informative response, the value of the CBOR byte string is the concatenation of the following components, in the order specified below.<a href="#section-4.2.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2.2-2">When defining the value of each component, "CoAP message" refers to the phantom observation request for the 'ph_req' parameter, and to the corresponding latest multicast notification for the 'last_notif' parameter.<a href="#section-4.2.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.2-3.1">
              <p id="section-4.2.2-3.1.1">A single byte, with value the content of the Code field in the CoAP message.<a href="#section-4.2.2-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.2.2-3.2">
              <p id="section-4.2.2-3.2.1">The byte serialization of the complete sequence of CoAP options in the CoAP message.<a href="#section-4.2.2-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.2.2-3.3">
              <p id="section-4.2.2-3.3.1">If the CoAP message includes a non-zero length payload, the one-byte Payload Marker (0xff) followed by the payload.<a href="#section-4.2.2-3.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="ssec-server-side-notifications">
<section id="section-4.3">
        <h3 id="name-notifications">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-notifications" class="section-name selfRef">Notifications</a>
        </h3>
<p id="section-4.3-1">Upon a change in the status of the target resource under group observation, the server sends a multicast notification, intended to all the clients taking part in the group observation of that resource. In particular, each of such multicast notifications is formatted as follows.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3-2.1">
            <p id="section-4.3-2.1.1">It <span class="bcp14">MUST</span> be Non-confirmable.<a href="#section-4.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.3-2.2">
            <p id="section-4.3-2.2.1">It <span class="bcp14">MUST</span> include an Observe Option, as per <span>[<a href="#RFC7641" class="cite xref">RFC7641</a>]</span>.<a href="#section-4.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.3-2.3">
            <p id="section-4.3-2.3.1">It <span class="bcp14">MUST</span> have the same Token value T of the phantom registration request that started the group observation.<a href="#section-4.3-2.3.1" class="pilcrow">¶</a></p>
<p id="section-4.3-2.3.2">
That is, every multicast notification for a target resource is not bound to the observation requests from the different clients, but instead to the phantom registration request associated with the whole set of clients taking part in the group observation of that resource.<a href="#section-4.3-2.3.2" class="pilcrow">¶</a></p>
<p id="section-4.3-2.3.3">
The Token value T is specified by an element of 'tpi_details' within the 'tp_info' parameter, in the informative response sent to the observer clients. In particular, when transporting CoAP over UDP, the Token value is specified by the element 'tpi_token' (see <a href="#ssssec-udp-transport-specific" class="auto internal xref">Section 4.2.1.1</a>).<a href="#section-4.3-2.3.3" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.3-2.4">
            <p id="section-4.3-2.4.1">It <span class="bcp14">MUST</span> be sent from the same IP address SRV_ADDR and port number SRV_PORT where the corresponding informative responses are sent from by the server (see <a href="#ssec-server-side-informative" class="auto internal xref">Section 4.2</a>). That is, redirection <span class="bcp14">MUST NOT</span> be used.<a href="#section-4.3-2.4.1" class="pilcrow">¶</a></p>
<p id="section-4.3-2.4.2">
Note that, in most cases, such SRV_ADDR and SRV_PORT are those to which original observation requests are sent to by clients (see <a href="#ssec-client-side-request" class="auto internal xref">Section 5.1</a>), unless those requests are sent to a multicast address (see <span>[<a href="#I-D.ietf-core-groupcomm-bis" class="cite xref">I-D.ietf-core-groupcomm-bis</a>]</span>).<a href="#section-4.3-2.4.2" class="pilcrow">¶</a></p>
<p id="section-4.3-2.4.3">
The addressing information above is provided to the observer clients through the CRI specified by the element 'tpi_server' within the 'tp_info' parameter, in the informative response (see <a href="#sssec-transport-specific-encoding" class="auto internal xref">Section 4.2.1</a>).<a href="#section-4.3-2.4.3" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.3-2.5">
            <p id="section-4.3-2.5.1">It <span class="bcp14">MUST</span> be sent to the IP multicast address GRP_ADDR and port number GRP_PORT.<a href="#section-4.3-2.5.1" class="pilcrow">¶</a></p>
<p id="section-4.3-2.5.2">
The addressing information above is provided to the observer clients through the CRI specified by an element of 'tpi_details' within the 'tp_info' parameter, in the informative response. In particular, when transporting CoAP over UDP, the CRI is conveyed by the element 'tpi_client' (see <a href="#ssssec-udp-transport-specific" class="auto internal xref">Section 4.2.1.1</a>).<a href="#section-4.3-2.5.2" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.3-3">For each target resource with an active group observation, the server <span class="bcp14">MUST</span> store the latest multicast notification.<a href="#section-4.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-server-side-congestion">
<section id="section-4.4">
        <h3 id="name-congestion-control">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-congestion-control" class="section-name selfRef">Congestion Control</a>
        </h3>
<p id="section-4.4-1">In order to not cause congestion, the server should conservatively control the sending of multicast notifications. In particular:<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4-2.1">
            <p id="section-4.4-2.1.1">The multicast notifications <span class="bcp14">MUST</span> be Non-confirmable.<a href="#section-4.4-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.4-2.2">
            <p id="section-4.4-2.2.1">In constrained environments such as low-power, lossy networks (LLNs), the server should only support multicast notifications for resources that are small. Following related guidelines from <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-groupcomm-bis-13#section-3.6" class="relref">Section 3.6</a> of [<a href="#I-D.ietf-core-groupcomm-bis" class="cite xref">I-D.ietf-core-groupcomm-bis</a>]</span>, this can consist, for example, in having the payload of multicast notifications as limited to approximately 5% of the IP Maximum Transmit Unit (MTU) size, so that it fits into a single link-layer frame in case IPv6 over Low-Power Wireless Personal Area Networks (6LoWPAN) (see <span><a href="https://rfc-editor.org/rfc/rfc4944#section-4" class="relref">Section 4</a> of [<a href="#RFC4944" class="cite xref">RFC4944</a>]</span>) is used.<a href="#section-4.4-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.4-2.3">
            <p id="section-4.4-2.3.1">The server <span class="bcp14">SHOULD</span> provide multicast notifications with the smallest possible IP multicast scope that fulfills the application needs. For example, following related guidelines from <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-groupcomm-bis-13#section-3.6" class="relref">Section 3.6</a> of [<a href="#I-D.ietf-core-groupcomm-bis" class="cite xref">I-D.ietf-core-groupcomm-bis</a>]</span>, site-local scope is always preferred over global scope IP multicast, if this fulfills the application needs. Similarly, realm-local scope is always preferred over site-local scope, if this fulfills the application needs. Ultimately, it is up to the server administrator to explicitly configure the most appropriate IP multicast scope.<a href="#section-4.4-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.4-2.4">
            <p id="section-4.4-2.4.1">Following related guidelines from <span><a href="https://rfc-editor.org/rfc/rfc7641#section-4.5.1" class="relref">Section 4.5.1</a> of [<a href="#RFC7641" class="cite xref">RFC7641</a>]</span>, the server <span class="bcp14">SHOULD NOT</span> send more than one multicast notification every 3 seconds, and <span class="bcp14">SHOULD</span> use an even less aggressive rate when possible (see also <span><a href="https://rfc-editor.org/rfc/rfc8085#section-3.1.2" class="relref">Section 3.1.2</a> of [<a href="#RFC8085" class="cite xref">RFC8085</a>]</span>). The transmission rate of multicast notifications should also take into account the avoidance of a possible "broadcast storm" problem <span>[<a href="#MOBICOM99" class="cite xref">MOBICOM99</a>]</span>. This prevents a following, considerable increase of the channel load, whose origin would be likely attributed to a router rather than to the server.<a href="#section-4.4-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="ssec-server-side-cancellation">
<section id="section-4.5">
        <h3 id="name-cancellation">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-cancellation" class="section-name selfRef">Cancellation</a>
        </h3>
<p id="section-4.5-1">At a certain point in time, the server might want to cancel a group observation of a target resource. For instance, the server realizes that no clients or not enough clients are interested in taking part in the group observation anymore. <a href="#sec-rough-counting" class="auto internal xref">Section 8</a> defines a possible approach that the server can use to make an assessment in this respect. Another reason is that the group observation has reached its ending time, as originally scheduled by the server.<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<p id="section-4.5-2">In order to cancel the group observation, the server sends a multicast response with response code 5.03 (Service Unavailable), signaling that the group observation has been terminated. The response has the same Token value T of the phantom registration request, it has no payload, and it does not include an Observe Option.<a href="#section-4.5-2" class="pilcrow">¶</a></p>
<p id="section-4.5-3">The server sends the response to the same multicast IP address GRP_ADDR and port number GRP_PORT used to send the multicast notifications related to the target resource. Finally, the server releases the resources allocated for the group observation, and especially frees up the Token value T used at its CoAP endpoint.<a href="#section-4.5-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-client-side">
<section id="section-5">
      <h2 id="name-client-side-requirements">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-client-side-requirements" class="section-name selfRef">Client-Side Requirements</a>
      </h2>
<div id="ssec-client-side-request">
<section id="section-5.1">
        <h3 id="name-request-2">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-request-2" class="section-name selfRef">Request</a>
        </h3>
<p id="section-5.1-1">A client sends an observation request to the server as described in <span>[<a href="#RFC7641" class="cite xref">RFC7641</a>]</span>, i.e., a GET request with an Observe Option set to 0 (register). The request <span class="bcp14">MUST NOT</span> encode link-local addresses. If the server is not configured to accept registrations on that target resource specifically for a group observation, this would still result in a positive notification response to the client as described in <span>[<a href="#RFC7641" class="cite xref">RFC7641</a>]</span>, in case the server is able and willing to add the client to the list of observers.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">In a particular setup, the information typically specified in the 'tp_info' parameter of the informative response (see <a href="#ssec-server-side-informative" class="auto internal xref">Section 4.2</a>) can be pre-configured on the server and the clients. For example, the destination multicast address and port number where to send multicast notifications for a group observation, as well as the associated Token value to use, can be set aside for particular tasks (e.g., enforcing observations of a specific resource). Alternative mechanisms can rely on using some bytes from the hash of the observation request as the last bytes of the multicast address or as part of the Token value.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">In such a particular setup, the client may also have an early knowledge of the phantom request, i.e., it will be possible for the server to safely omit the parameter 'ph_req' from the informative response to the observation request (see <a href="#ssec-server-side-informative" class="auto internal xref">Section 4.2</a>). In this case, the client can include a No-Response Option <span>[<a href="#RFC7967" class="cite xref">RFC7967</a>]</span> with value 16 in its Observe registration request, which results in the server suppressing the informative response. As a consequence, the observation request only informs the server that there is one additional client interested to take part in the group observation.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1-4">While the considered client is able to simply set up its multicast address and start receiving multicast notifications for the group observation, sending an observation request as above allows the server to increment the observer counter. This helps the server to assess the current number of clients interested in the group observation over time (e.g., by using the method defined in <a href="#sec-rough-counting" class="auto internal xref">Section 8</a>), which in turn can play a role in deciding to cancel the group observation (see <a href="#ssec-server-side-cancellation" class="auto internal xref">Section 4.5</a>).<a href="#section-5.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-client-side-informative">
<section id="section-5.2">
        <h3 id="name-informative-response-2">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-informative-response-2" class="section-name selfRef">Informative Response</a>
        </h3>
<p id="section-5.2-1">Upon receiving the informative response defined in <a href="#ssec-server-side-informative" class="auto internal xref">Section 4.2</a>, the client proceeds as follows.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.2-2">
<li id="section-5.2-2.1">
            <p id="section-5.2-2.1.1">The client configures an observation of the target resource. To this end, it relies on a CoAP endpoint used for messages having:<a href="#section-5.2-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2-2.1.2.1">
                <p id="section-5.2-2.1.2.1.1">As source address and port number, the server address SRV_ADDR and port number SRV_PORT intended for accessing the target resource. These are specified by the CRI conveyed by the element 'tpi_server' within the 'tp_info' parameter, in the informative response (see <a href="#sssec-transport-specific-encoding" class="auto internal xref">Section 4.2.1</a>).<a href="#section-5.2-2.1.2.1.1" class="pilcrow">¶</a></p>
<p id="section-5.2-2.1.2.1.2">
If the port number is not present in the CRI, then the client <span class="bcp14">MUST</span> use as SRV_PORT the default port number defined for the URI scheme that corresponds to the CRI scheme number (e.g., 5683 when the URI scheme is "coap").<a href="#section-5.2-2.1.2.1.2" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.2-2.1.2.2">
                <p id="section-5.2-2.1.2.2.1">As destination address and port number, the IP multicast address GRP_ADDR and port number GRP_PORT. These are specified by the CRI conveyed by a dedicated element of 'tpi_details' within the 'tp_info' parameter, in the informative response. In particular, when transporting CoAP over UDP, the CRI is conveyed by the element 'tpi_client' (see <a href="#ssssec-udp-transport-specific" class="auto internal xref">Section 4.2.1.1</a>).<a href="#section-5.2-2.1.2.2.1" class="pilcrow">¶</a></p>
<p id="section-5.2-2.1.2.2.2">
If the port number is not present in the CRI, then the client <span class="bcp14">MUST</span> use as GRP_PORT the default port number defined for the URI scheme that corresponds to the CRI scheme number (e.g., 5683 when the URI scheme is "coap").<a href="#section-5.2-2.1.2.2.2" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="section-5.2-2.2">
            <p id="section-5.2-2.2.1">The client rebuilds the phantom registration request as follows.<a href="#section-5.2-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2-2.2.2.1">
                <p id="section-5.2-2.2.2.1.1">The client uses the Token value T, specified by a dedicated element of 'tpi_details' within the 'tp_info' parameter, in the informative response. In particular, when transporting CoAP over UDP, the Token value is specified by the element 'tpi_token' (see <a href="#ssssec-udp-transport-specific" class="auto internal xref">Section 4.2.1.1</a>).<a href="#section-5.2-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.2-2.2.2.2">
                <p id="section-5.2-2.2.2.2.1">If the 'ph_req' parameter is not present in the informative response, the client uses the transport-independent information from its original Observe registration request.<a href="#section-5.2-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.2-2.2.2.3">
                <p id="section-5.2-2.2.2.3.1">If the 'ph_req' parameter is present in the informative response, the client uses the transport-independent information specified in the parameter.<a href="#section-5.2-2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="section-5.2-2.3">
            <p id="section-5.2-2.3.1">If the informative response includes the parameter 'ph_req', and the transport-independent information specified therein differs from the one in the original Observe registration request, then the client checks whether a response to the rebuilt phantom request can, if available in a cache entry, be used to satisfy the original observation request. If this is not the case, the client <span class="bcp14">SHOULD</span> explicitly withdraw from the group observation.<a href="#section-5.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.2-2.4">
            <p id="section-5.2-2.4.1">The client stores the phantom registration request, as associated with the observation of the target resource. In particular, the client <span class="bcp14">MUST</span> use the Token value T of this phantom registration request as its own local Token value associated with that group observation, with respect to the server. The particular way to achieve this is implementation specific.<a href="#section-5.2-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.2-2.5">
            <p id="section-5.2-2.5.1">If the informative response includes the parameter 'last_notif', the client rebuilds the latest multicast notification, by using:<a href="#section-5.2-2.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2-2.5.2.1">
                <p id="section-5.2-2.5.2.1.1">The same Token value T used at Step 2; and<a href="#section-5.2-2.5.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.2-2.5.2.2">
                <p id="section-5.2-2.5.2.2.1">The transport-independent information, specified in the 'last_notif' parameter of the informative response.<a href="#section-5.2-2.5.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="section-5.2-2.6">
            <p id="section-5.2-2.6.1">If the informative response includes the parameter 'last_notif', the client processes the multicast notification rebuilt at Step 5 as defined in <span><a href="https://rfc-editor.org/rfc/rfc7641#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC7641" class="cite xref">RFC7641</a>]</span>. In particular, the value of the Observe Option is used as initial baseline for notification reordering in this group observation.<a href="#section-5.2-2.6.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.2-2.7">
            <p id="section-5.2-2.7.1">If a traditional observation to the target resource is ongoing, the client <span class="bcp14">MAY</span> silently cancel it without notifying the server.<a href="#section-5.2-2.7.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-5.2-3">If any of the expected fields in the informative response are not present or malformed, the client <span class="bcp14">MAY</span> try sending a new registration request to the server (see <a href="#ssec-client-side-request" class="auto internal xref">Section 5.1</a>). If the client chooses not to, then the client <span class="bcp14">SHOULD</span> explicitly withdraw from the group observation.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<p id="section-5.2-4"><a href="#appendix-different-sources" class="auto internal xref">Appendix A</a> describes possible alternative ways for clients to retrieve the phantom registration request and other information related to a group observation.<a href="#section-5.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-client-side-notifications">
<section id="section-5.3">
        <h3 id="name-notifications-2">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-notifications-2" class="section-name selfRef">Notifications</a>
        </h3>
<p id="section-5.3-1">After having successfully processed the informative response as defined in <a href="#ssec-client-side-informative" class="auto internal xref">Section 5.2</a>, the client will receive, accept, and process multicast notifications about the state of the target resource from the server, as responses to the phantom registration request and with Token value T.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">The client relies on the value of the Observe Option for notification reordering, as defined in <span><a href="https://rfc-editor.org/rfc/rfc7641#section-3.4" class="relref">Section 3.4</a> of [<a href="#RFC7641" class="cite xref">RFC7641</a>]</span>.<a href="#section-5.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-client-side-cancellation">
<section id="section-5.4">
        <h3 id="name-cancellation-2">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-cancellation-2" class="section-name selfRef">Cancellation</a>
        </h3>
<p id="section-5.4-1">At a certain point in time, a client may become not interested in receiving further multicast notifications about a target resource. When this happens, the client can simply "forget" about being part of the group observation for that target resource, as per <span><a href="https://rfc-editor.org/rfc/rfc7641#section-3.6" class="relref">Section 3.6</a> of [<a href="#RFC7641" class="cite xref">RFC7641</a>]</span>.<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<p id="section-5.4-2">When, later on, the server sends the next multicast notification, the client will not recognize the Token value T in the message. Since the multicast notification is Non-confirmable, it is <span class="bcp14">OPTIONAL</span> for the client to reject the multicast notification with a Reset message, as defined in <span><a href="https://rfc-editor.org/rfc/rfc7641#section-3.5" class="relref">Section 3.5</a> of [<a href="#RFC7641" class="cite xref">RFC7641</a>]</span>.<a href="#section-5.4-2" class="pilcrow">¶</a></p>
<p id="section-5.4-3">In case the server has canceled a group observation as defined in <a href="#ssec-server-side-cancellation" class="auto internal xref">Section 4.5</a>, the client simply forgets about the group observation and frees up the used Token value T for that endpoint, upon receiving the multicast error response defined in <a href="#ssec-server-side-cancellation" class="auto internal xref">Section 4.5</a>.<a href="#section-5.4-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-web-linking">
<section id="section-6">
      <h2 id="name-web-linking">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-web-linking" class="section-name selfRef">Web Linking</a>
      </h2>
<p id="section-6-1">The possible use of multicast notifications in a group observation may be indicated by a target attribute "gp-obs" in a web link <span>[<a href="#RFC8288" class="cite xref">RFC8288</a>]</span> to a resource, e.g., using a link-format document <span>[<a href="#RFC6690" class="cite xref">RFC6690</a>]</span>.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">The "gp-obs" attribute is a hint, indicating that the server might send multicast notifications for observations of the resource targeted by the link. Note that this is simply a hint, i.e., it does not include any information required to participate in a group observation, and to receive and process multicast notifications.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">A value <span class="bcp14">MUST NOT</span> be given for the "gp-obs" attribute and any present value <span class="bcp14">MUST</span> be ignored by the recipient.  The "gp-obs" attribute <span class="bcp14">MUST NOT</span> appear more than once in a given link-value; occurrences after the first <span class="bcp14">MUST</span> be ignored by the recipient.<a href="#section-6-3" class="pilcrow">¶</a></p>
<p id="section-6-4">The example in <a href="#example-web-link" class="auto internal xref">Figure 5</a> shows a use of the "gp-obs" attribute: the client does resource discovery on a server and gets back a list of resources, one of which includes the "gp-obs" attribute indicating that the server might send multicast notifications for observations of that resource. The CoRE Link-Format notation from <span><a href="https://rfc-editor.org/rfc/rfc6690#section-5" class="relref">Section 5</a> of [<a href="#RFC6690" class="cite xref">RFC6690</a>]</span> is used.<a href="#section-6-4" class="pilcrow">¶</a></p>
<span id="name-the-web-link"></span><div id="example-web-link">
<figure id="figure-5">
        <div class="alignLeft art-text artwork" id="section-6-5.1">
<pre>
REQ: GET /.well-known/core

RES: 2.05 Content
    &lt;/sensors/temp&gt;;gp-obs,
    &lt;/sensors/light&gt;;if="sensor"
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-the-web-link" class="selfRef">The Web Link</a>
        </figcaption></figure>
</div>
</section>
</div>
<div id="sec-example-no-security">
<section id="section-7">
      <h2 id="name-example">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-example" class="section-name selfRef">Example</a>
      </h2>
<p id="section-7-1">The following example refers to two clients C1 and C2 that register to observe a resource /r at a server S, which has address SRV_ADDR and listens to the port number SRV_PORT. Before the following exchanges occur, no clients are observing the resource /r , which has value "1234".<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">The server S sends multicast notifications to the IP multicast address GRP_ADDR and port number GRP_PORT, and starts the group observation upon receiving a registration request from a first client that wishes to start a traditional observation on the resource /r.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">The following notation is used for the payload of the informative responses:<a href="#section-7-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-4.1">
          <p id="section-7-4.1.1">The application-extension identifier "cri" defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-href-18#appendix-C" class="relref">Appendix C</a> of [<a href="#I-D.ietf-core-href" class="cite xref">I-D.ietf-core-href</a>]</span> is used to notate a CBOR Extended Diagnostic Notation (EDN) literal for a CRI.<a href="#section-7-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-4.2">
          <p id="section-7-4.2.1">'bstr(X)' denotes a CBOR byte string with value the byte serialization of X, with '|' denoting byte concatenation.<a href="#section-7-4.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-4.3">
          <p id="section-7-4.3.1">'OPT' denotes a sequence of CoAP options. This refers to the phantom registration request encoded by the 'ph_req' parameter, or to the corresponding latest multicast notification encoded by the 'last_notif' parameter.<a href="#section-7-4.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-4.4">
          <p id="section-7-4.4.1">'PAYLOAD' denotes a CoAP payload. This refers to the latest multicast notification encoded by the 'last_notif' parameter.<a href="#section-7-4.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<span id="name-example-of-group-observatio"></span><div id="example-no-oscore">
<figure id="figure-6">
        <div id="section-7-5.1">
          <div class="alignLeft art-svg artwork" id="section-7-5.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="1296" width="552" viewBox="0 0 552 1296" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 8,48 L 8,432" fill="none" stroke="black"></path>
              <path d="M 8,464 L 8,672" fill="none" stroke="black"></path>
              <path d="M 8,704 L 8,832" fill="none" stroke="black"></path>
              <path d="M 8,864 L 8,1120" fill="none" stroke="black"></path>
              <path d="M 8,1184 L 8,1280" fill="none" stroke="black"></path>
              <path d="M 32,1120 L 32,1184" fill="none" stroke="black"></path>
              <path d="M 512,48 L 512,432" fill="none" stroke="black"></path>
              <path d="M 512,464 L 512,672" fill="none" stroke="black"></path>
              <path d="M 512,704 L 512,832" fill="none" stroke="black"></path>
              <path d="M 512,864 L 512,1136" fill="none" stroke="black"></path>
              <path d="M 512,1168 L 512,1280" fill="none" stroke="black"></path>
              <path d="M 32,32 L 192,32" fill="none" stroke="black"></path>
              <path d="M 304,32 L 496,32" fill="none" stroke="black"></path>
              <path d="M 80,208 L 496,208" fill="none" stroke="black"></path>
              <path d="M 80,256 L 496,256" fill="none" stroke="black"></path>
              <path d="M 32,448 L 192,448" fill="none" stroke="black"></path>
              <path d="M 304,448 L 496,448" fill="none" stroke="black"></path>
              <path d="M 32,688 L 192,688" fill="none" stroke="black"></path>
              <path d="M 304,688 L 496,688" fill="none" stroke="black"></path>
              <path d="M 32,848 L 192,848" fill="none" stroke="black"></path>
              <path d="M 304,848 L 496,848" fill="none" stroke="black"></path>
              <path d="M 8,1120 L 32,1120" fill="none" stroke="black"></path>
              <path d="M 48,1152 L 192,1152" fill="none" stroke="black"></path>
              <path d="M 320,1152 L 496,1152" fill="none" stroke="black"></path>
              <path d="M 8,1184 L 32,1184" fill="none" stroke="black"></path>
              <path d="M 68,232 L 80,256" fill="none" stroke="black"></path>
              <path d="M 68,232 L 80,208" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="504,688 492,682.4 492,693.6" fill="black" transform="rotate(0,496,688)"></polygon>
              <polygon class="arrowhead" points="504,256 492,250.4 492,261.6" fill="black" transform="rotate(0,496,256)"></polygon>
              <polygon class="arrowhead" points="504,32 492,26.4 492,37.6" fill="black" transform="rotate(0,496,32)"></polygon>
              <polygon class="arrowhead" points="56,1152 44,1146.4 44,1157.6" fill="black" transform="rotate(180,48,1152)"></polygon>
              <polygon class="arrowhead" points="40,848 28,842.4 28,853.6" fill="black" transform="rotate(180,32,848)"></polygon>
              <polygon class="arrowhead" points="40,448 28,442.4 28,453.6" fill="black" transform="rotate(180,32,448)"></polygon>
              <g class="text">
                <text x="12" y="36">C1</text>
                <text x="208" y="36">[</text>
                <text x="248" y="36">Unicast</text>
                <text x="288" y="36">]</text>
                <text x="512" y="36">S</text>
                <text x="540" y="36">/r</text>
                <text x="40" y="52">GET</text>
                <text x="52" y="68">Token:</text>
                <text x="100" y="68">0x4a</text>
                <text x="60" y="84">Observe:</text>
                <text x="104" y="84">0</text>
                <text x="156" y="84">(register)</text>
                <text x="64" y="100">Uri-Path:</text>
                <text x="120" y="100">"r"</text>
                <text x="52" y="116">&lt;Other</text>
                <text x="116" y="116">options&gt;</text>
                <text x="136" y="148">(</text>
                <text x="152" y="148">S</text>
                <text x="200" y="148">allocates</text>
                <text x="256" y="148">the</text>
                <text x="312" y="148">available</text>
                <text x="376" y="148">Token</text>
                <text x="424" y="148">value</text>
                <text x="468" y="148">0x7b</text>
                <text x="496" y="148">)</text>
                <text x="56" y="180">(</text>
                <text x="72" y="180">S</text>
                <text x="104" y="180">sends</text>
                <text x="140" y="180">to</text>
                <text x="180" y="180">itself</text>
                <text x="216" y="180">a</text>
                <text x="256" y="180">phantom</text>
                <text x="336" y="180">observation</text>
                <text x="416" y="180">request</text>
                <text x="476" y="180">PH_REQ</text>
                <text x="76" y="196">as</text>
                <text x="116" y="196">coming</text>
                <text x="164" y="196">from</text>
                <text x="200" y="196">the</text>
                <text x="228" y="196">IP</text>
                <text x="280" y="196">multicast</text>
                <text x="352" y="196">address</text>
                <text x="420" y="196">GRP_ADDR</text>
                <text x="464" y="196">)</text>
                <text x="540" y="260">/r</text>
                <text x="336" y="276">GET</text>
                <text x="348" y="292">Token:</text>
                <text x="396" y="292">0x7b</text>
                <text x="356" y="308">Observe:</text>
                <text x="400" y="308">0</text>
                <text x="452" y="308">(register)</text>
                <text x="360" y="324">Uri-Path:</text>
                <text x="416" y="324">"r"</text>
                <text x="348" y="340">&lt;Other</text>
                <text x="412" y="340">options&gt;</text>
                <text x="192" y="372">(</text>
                <text x="208" y="372">S</text>
                <text x="248" y="372">creates</text>
                <text x="288" y="372">a</text>
                <text x="320" y="372">group</text>
                <text x="392" y="372">observation</text>
                <text x="452" y="372">of</text>
                <text x="476" y="372">/r</text>
                <text x="496" y="372">)</text>
                <text x="224" y="404">(</text>
                <text x="240" y="404">S</text>
                <text x="292" y="404">increments</text>
                <text x="352" y="404">the</text>
                <text x="404" y="404">observer</text>
                <text x="472" y="404">counter</text>
                <text x="248" y="420">for</text>
                <text x="280" y="420">the</text>
                <text x="320" y="420">group</text>
                <text x="392" y="420">observation</text>
                <text x="452" y="420">of</text>
                <text x="476" y="420">/r</text>
                <text x="496" y="420">)</text>
                <text x="12" y="452">C1</text>
                <text x="208" y="452">[</text>
                <text x="248" y="452">Unicast</text>
                <text x="288" y="452">]</text>
                <text x="512" y="452">S</text>
                <text x="44" y="468">5.03</text>
                <text x="52" y="484">Token:</text>
                <text x="100" y="484">0x4a</text>
                <text x="88" y="500">Content-Format:</text>
                <text x="304" y="500">application/informative-response+cbor</text>
                <text x="60" y="516">Max-Age:</text>
                <text x="104" y="516">0</text>
                <text x="52" y="532">&lt;Other</text>
                <text x="116" y="532">options&gt;</text>
                <text x="60" y="548">Payload:</text>
                <text x="104" y="548">{</text>
                <text x="48" y="564">/</text>
                <text x="88" y="564">tp_info</text>
                <text x="128" y="564">/</text>
                <text x="168" y="564">0</text>
                <text x="184" y="564">:</text>
                <text x="200" y="564">[</text>
                <text x="328" y="580">cri'coap://SRV_ADDR:SRV_PORT/',</text>
                <text x="344" y="596">cri'coap://GRP_ADDR:GRP_PORT/',</text>
                <text x="252" y="612">0x7b</text>
                <text x="204" y="628">],</text>
                <text x="48" y="644">/</text>
                <text x="100" y="644">last_notif</text>
                <text x="152" y="644">/</text>
                <text x="168" y="644">2</text>
                <text x="184" y="644">:</text>
                <text x="232" y="644">bstr(0x45</text>
                <text x="280" y="644">|</text>
                <text x="304" y="644">OPT</text>
                <text x="328" y="644">|</text>
                <text x="356" y="644">0xff</text>
                <text x="384" y="644">|</text>
                <text x="428" y="644">PAYLOAD)</text>
                <text x="32" y="660">}</text>
                <text x="12" y="692">C2</text>
                <text x="208" y="692">[</text>
                <text x="248" y="692">Unicast</text>
                <text x="288" y="692">]</text>
                <text x="512" y="692">S</text>
                <text x="540" y="692">/r</text>
                <text x="40" y="708">GET</text>
                <text x="52" y="724">Token:</text>
                <text x="100" y="724">0x01</text>
                <text x="60" y="740">Observe:</text>
                <text x="104" y="740">0</text>
                <text x="156" y="740">(register)</text>
                <text x="64" y="756">Uri-Path:</text>
                <text x="120" y="756">"r"</text>
                <text x="52" y="772">&lt;Other</text>
                <text x="116" y="772">options&gt;</text>
                <text x="216" y="804">(</text>
                <text x="232" y="804">S</text>
                <text x="284" y="804">increments</text>
                <text x="344" y="804">the</text>
                <text x="396" y="804">observer</text>
                <text x="464" y="804">counter</text>
                <text x="240" y="820">for</text>
                <text x="272" y="820">the</text>
                <text x="312" y="820">group</text>
                <text x="384" y="820">observation</text>
                <text x="444" y="820">of</text>
                <text x="468" y="820">/r</text>
                <text x="488" y="820">)</text>
                <text x="12" y="852">C2</text>
                <text x="208" y="852">[</text>
                <text x="248" y="852">Unicast</text>
                <text x="288" y="852">]</text>
                <text x="512" y="852">S</text>
                <text x="44" y="868">5.03</text>
                <text x="52" y="884">Token:</text>
                <text x="100" y="884">0x01</text>
                <text x="88" y="900">Content-Format:</text>
                <text x="304" y="900">application/informative-response+cbor</text>
                <text x="60" y="916">Max-Age:</text>
                <text x="104" y="916">0</text>
                <text x="52" y="932">&lt;Other</text>
                <text x="116" y="932">options&gt;</text>
                <text x="60" y="948">Payload:</text>
                <text x="104" y="948">{</text>
                <text x="48" y="964">/</text>
                <text x="88" y="964">tp_info</text>
                <text x="128" y="964">/</text>
                <text x="168" y="964">0</text>
                <text x="184" y="964">:</text>
                <text x="200" y="964">[</text>
                <text x="328" y="980">cri'coap://SRV_ADDR:SRV_PORT/',</text>
                <text x="344" y="996">cri'coap://GRP_ADDR:GRP_PORT/',</text>
                <text x="252" y="1012">0x7b</text>
                <text x="204" y="1028">],</text>
                <text x="48" y="1044">/</text>
                <text x="100" y="1044">last_notif</text>
                <text x="152" y="1044">/</text>
                <text x="168" y="1044">2</text>
                <text x="184" y="1044">:</text>
                <text x="232" y="1044">bstr(0x45</text>
                <text x="280" y="1044">|</text>
                <text x="304" y="1044">OPT</text>
                <text x="328" y="1044">|</text>
                <text x="356" y="1044">0xff</text>
                <text x="384" y="1044">|</text>
                <text x="428" y="1044">PAYLOAD)</text>
                <text x="32" y="1060">}</text>
                <text x="104" y="1092">(</text>
                <text x="128" y="1092">The</text>
                <text x="168" y="1092">value</text>
                <text x="204" y="1092">of</text>
                <text x="232" y="1092">the</text>
                <text x="284" y="1092">resource</text>
                <text x="332" y="1092">/r</text>
                <text x="376" y="1092">changes</text>
                <text x="420" y="1092">to</text>
                <text x="460" y="1092">"5678"</text>
                <text x="496" y="1092">)</text>
                <text x="12" y="1140">C1</text>
                <text x="208" y="1156">[</text>
                <text x="256" y="1156">Multicast</text>
                <text x="304" y="1156">]</text>
                <text x="512" y="1156">S</text>
                <text x="12" y="1172">C2</text>
                <text x="88" y="1172">(</text>
                <text x="144" y="1172">Destination</text>
                <text x="248" y="1172">address/port:</text>
                <text x="376" y="1172">GRP_ADDR/GRP_PORT</text>
                <text x="456" y="1172">)</text>
                <text x="60" y="1204">2.05</text>
                <text x="68" y="1220">Token:</text>
                <text x="116" y="1220">0x7b</text>
                <text x="76" y="1236">Observe:</text>
                <text x="124" y="1236">11</text>
                <text x="68" y="1252">&lt;Other</text>
                <text x="132" y="1252">options&gt;</text>
                <text x="76" y="1268">Payload:</text>
                <text x="140" y="1268">"5678"</text>
              </g>
            </svg><a href="#section-7-5.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-example-of-group-observatio" class="selfRef">Example of Group Observation</a>
        </figcaption></figure>
</div>
</section>
</div>
<div id="sec-rough-counting">
<section id="section-8">
      <h2 id="name-rough-counting-of-clients-i">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-rough-counting-of-clients-i" class="section-name selfRef">Rough Counting of Clients in the Group Observation</a>
      </h2>
<p id="section-8-1">This section specifies a method that the server can use to keep an estimate of still active and interested clients, without creating undue traffic on the network.<a href="#section-8-1" class="pilcrow">¶</a></p>
<div id="multicast-response-feedback-divider-option">
<section id="section-8.1">
        <h3 id="name-multicast-response-feedback">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-multicast-response-feedback" class="section-name selfRef">Multicast-Response-Feedback-Divider Option</a>
        </h3>
<p id="section-8.1-1">In order to enable the rough counting of still active and interested clients, a new CoAP option is introduced, which <span class="bcp14">SHOULD</span> be supported by clients that listen to multicast responses.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">The option is called Multicast-Response-Feedback-Divider and has the properties summarized in <a href="#mrfd-table" class="auto internal xref">Table 1</a>, which extends Table 4 of <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>. The option is not Critical, not Safe-to-Forward, and integer valued. Since the option is not Safe-to-Forward, the column "N" indicates a dash for "not applicable".<a href="#section-8.1-2" class="pilcrow">¶</a></p>
<span id="name-the-multicast-response-feed"></span><div id="mrfd-table">
<table class="center" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-the-multicast-response-feed" class="selfRef">The Multicast-Response-Feedback-Divider Option. C=Critical, U=Unsafe, N=NoCacheKey, R=Repeatable</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">No.</th>
              <th class="text-left" rowspan="1" colspan="1">C</th>
              <th class="text-left" rowspan="1" colspan="1">U</th>
              <th class="text-left" rowspan="1" colspan="1">N</th>
              <th class="text-left" rowspan="1" colspan="1">R</th>
              <th class="text-left" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">Format</th>
              <th class="text-left" rowspan="1" colspan="1">Length</th>
              <th class="text-left" rowspan="1" colspan="1">Default</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">TBD</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">x</td>
              <td class="text-left" rowspan="1" colspan="1">-</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">Multicast-Response-<br>Feedback-Divider</td>
              <td class="text-left" rowspan="1" colspan="1">uint</td>
              <td class="text-left" rowspan="1" colspan="1">0-1</td>
              <td class="text-left" rowspan="1" colspan="1">(none)</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-8.1-4">The Multicast-Response-Feedback-Divider Option is of class E for OSCORE <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span><span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>.<a href="#section-8.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-rough-counting-client-side">
<section id="section-8.2">
        <h3 id="name-processing-on-the-client-si">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-processing-on-the-client-si" class="section-name selfRef">Processing on the Client Side</a>
        </h3>
<p id="section-8.2-1">Upon receiving a response with a Multicast-Response-Feedback-Divider Option, a client that is interested in continuing receiving multicast notifications for the target resource <span class="bcp14">SHOULD</span> acknowledge its interest, as described below.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<p id="section-8.2-2">The client picks an integer random number I, from 0 inclusive to the number Z = (2^Q) exclusive, where Q is the value specified in the option and "^" is the exponentiation operator. If I is different from 0, the client takes no further action. Otherwise, the client should wait a random fraction of the Leisure time (see <span><a href="https://rfc-editor.org/rfc/rfc7252#section-8.2" class="relref">Section 8.2</a> of [<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>), and then registers a regular unicast observation on the same target resource.<a href="#section-8.2-2" class="pilcrow">¶</a></p>
<p id="section-8.2-3">To this end, the client essentially follows the steps that got it originally subscribed to group notifications for the target resource. In particular, the client sends an observation request to the server, i.e., a GET request with an Observe Option set to 0 (register). The request <span class="bcp14">MUST</span> be addressed to the same target resource, and <span class="bcp14">MUST</span> have the same destination IP address and port number used for the original registration request, regardless of the source IP address and port number of the received multicast notification.<a href="#section-8.2-3" class="pilcrow">¶</a></p>
<p id="section-8.2-4">Since the Observe registration is only done for its side effect of showing as an attempted observation at the server, the client <span class="bcp14">MUST</span> send the unicast request in a non confirmable way, and with the maximum No-Response setting <span>[<a href="#RFC7967" class="cite xref">RFC7967</a>]</span>. In the request, the client <span class="bcp14">MUST</span> include a Multicast-Response-Feedback-Divider Option, whose value <span class="bcp14">MUST</span> be set to 0. As per <span><a href="https://rfc-editor.org/rfc/rfc7252#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>, this is represented with an empty option value (a zero-length sequence of bytes). The client does not need to wait for responses, and can keep processing further notifications on the same Token.<a href="#section-8.2-4" class="pilcrow">¶</a></p>
<p id="section-8.2-5">The client <span class="bcp14">MUST</span> ignore the Multicast-Response-Feedback-Divider Option, if the multicast notification is retrieved from the 'last_notif' parameter of an informative response (see <a href="#ssec-server-side-informative" class="auto internal xref">Section 4.2</a>). A client includes the Multicast-Response-Feedback-Divider Option only in a re-registration request triggered by the server as described above, and <span class="bcp14">MUST NOT</span> include it in any other request.<a href="#section-8.2-5" class="pilcrow">¶</a></p>
<p id="section-8.2-6"><a href="#appendix-pseudo-code-counting-client" class="auto internal xref">Appendix B.1</a> and <a href="#appendix-pseudo-code-counting-client-constrained" class="auto internal xref">Appendix B.2</a> provide a description in pseudo-code of the operations above performed by the client.<a href="#section-8.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="processing-on-the-server-side">
<section id="section-8.3">
        <h3 id="name-processing-on-the-server-si">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-processing-on-the-server-si" class="section-name selfRef">Processing on the Server Side</a>
        </h3>
<p id="section-8.3-1">In order to avoid needless use of network resources, a server <span class="bcp14">SHOULD</span> keep a rough, updated count of the number of clients taking part in the group observation of a target resource. To this end, the server updates the value COUNT of the associated observer counter (see <a href="#sec-server-side" class="auto internal xref">Section 4</a>), for instance by using the method described below.<a href="#section-8.3-1" class="pilcrow">¶</a></p>
<div id="request-for-feedback">
<section id="section-8.3.1">
          <h4 id="name-request-for-feedback">
<a href="#section-8.3.1" class="section-number selfRef">8.3.1. </a><a href="#name-request-for-feedback" class="section-name selfRef">Request for Feedback</a>
          </h4>
<p id="section-8.3.1-1">When it wants to obtain a new estimated count, the server considers a number M of confirmations it would like to receive from the clients. It is up to applications to define policies about how the server determines and possibly adjusts the value of M.<a href="#section-8.3.1-1" class="pilcrow">¶</a></p>
<p id="section-8.3.1-2">Then, the server computes the value Q = max(L, 0), where:<a href="#section-8.3.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.3.1-3.1">
              <p id="section-8.3.1-3.1.1">L is computed as L = ceil(log2(N / M)).<a href="#section-8.3.1-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.3.1-3.2">
              <p id="section-8.3.1-3.2.1">N is the current value of the observer counter, possibly rounded up to 1, i.e., N = max(COUNT, 1).<a href="#section-8.3.1-3.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-8.3.1-4">Finally, the server sets Q as the value of the Multicast-Response-Feedback-Divider Option, which is sent within a successful multicast notification.<a href="#section-8.3.1-4" class="pilcrow">¶</a></p>
<p id="section-8.3.1-5">If several multicast notifications are sent in a burst fashion, it is <span class="bcp14">RECOMMENDED</span> for the server to include the Multicast-Response-Feedback-Divider Option only in the first notification of such a burst.<a href="#section-8.3.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="collection-of-feedback">
<section id="section-8.3.2">
          <h4 id="name-collection-of-feedback">
<a href="#section-8.3.2" class="section-number selfRef">8.3.2. </a><a href="#name-collection-of-feedback" class="section-name selfRef">Collection of Feedback</a>
          </h4>
<p id="section-8.3.2-1">The server collects unicast observation requests from the clients, for an amount of time of MAX_CONFIRMATION_WAIT seconds. During this time, the server regularly increments the observer counter when adding a new client to the group observation (see <a href="#ssec-server-side-informative" class="auto internal xref">Section 4.2</a>).<a href="#section-8.3.2-1" class="pilcrow">¶</a></p>
<p id="section-8.3.2-2">It is up to applications to define the value of MAX_CONFIRMATION_WAIT, which has to take into account the transmission time of the multicast notification and of unicast observation requests, as well as the leisure time of the clients, which may be hard to know or estimate for the server.<a href="#section-8.3.2-2" class="pilcrow">¶</a></p>
<p id="section-8.3.2-3">If this information is not known to the server, it is recommended to define MAX_CONFIRMATION_WAIT as follows.<a href="#section-8.3.2-3" class="pilcrow">¶</a></p>
<p id="section-8.3.2-4">MAX_CONFIRMATION_WAIT = MAX_RTT + MAX_CLIENT_REQUEST_DELAY<a href="#section-8.3.2-4" class="pilcrow">¶</a></p>
<p id="section-8.3.2-5">where MAX_RTT is as defined in <span><a href="https://rfc-editor.org/rfc/rfc7252#section-4.8.2" class="relref">Section 4.8.2</a> of [<a href="#RFC7252" class="cite xref">RFC7252</a>]</span> and has default value 202 seconds, while MAX_CLIENT_REQUEST_DELAY is equivalent to MAX_SERVER_RESPONSE_DELAY defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-groupcomm-bis-13#section-3.1.5" class="relref">Section 3.1.5</a> of [<a href="#I-D.ietf-core-groupcomm-bis" class="cite xref">I-D.ietf-core-groupcomm-bis</a>]</span> and has default value 250 seconds. In the absence of more specific information, the server can thus consider a conservative MAX_CONFIRMATION_WAIT of 452 seconds.<a href="#section-8.3.2-5" class="pilcrow">¶</a></p>
<p id="section-8.3.2-6">If more information is available in deployments, a much shorter MAX_CONFIRMATION_WAIT can be set. This can be based on a realistic round trip time (replacing MAX_RTT) and on the largest leisure time configured on the clients (replacing MAX_CLIENT_REQUEST_DELAY), e.g., DEFAULT_LEISURE = 5 seconds, thus shortening MAX_CONFIRMATION_WAIT to a few seconds.<a href="#section-8.3.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="processing-of-feedback">
<section id="section-8.3.3">
          <h4 id="name-processing-of-feedback">
<a href="#section-8.3.3" class="section-number selfRef">8.3.3. </a><a href="#name-processing-of-feedback" class="section-name selfRef">Processing of Feedback</a>
          </h4>
<p id="section-8.3.3-1">Once MAX_CONFIRMATION_WAIT seconds have passed, the server counts the R confirmations arrived as unicast observation requests to the target resource, since the multicast notification with the Multicast-Response-Feedback-Divider Option has been sent. In particular, the server considers a unicast observation request as a confirmation from a client only if it includes a Multicast-Response-Feedback-Divider Option with value 0.<a href="#section-8.3.3-1" class="pilcrow">¶</a></p>
<p id="section-8.3.3-2">Then, the server computes a feedback indicator as E = R * (2^Q), where "^" is the exponentiation operator. According to what is defined by application policies, the server determines the next time when to ask clients for their confirmation, e.g., after a certain number of multicast notifications has been sent. For example, the decision can be influenced by the reception of no confirmations from the clients, i.e., R = 0, or by the value of the ratios (E/N) and (N/E).<a href="#section-8.3.3-2" class="pilcrow">¶</a></p>
<p id="section-8.3.3-3">Finally, the server computes a new estimated count of the observers. To this end, the server first considers COUNT' as the current value of the observer counter at this point in time. Note that COUNT' may be greater than the value COUNT used at the beginning of this process, if the server has incremented the observer counter upon adding new clients to the group observation (see <a href="#ssec-server-side-informative" class="auto internal xref">Section 4.2</a>).<a href="#section-8.3.3-3" class="pilcrow">¶</a></p>
<p id="section-8.3.3-4">In particular, the server computes the new estimated count value as COUNT' + ((E - N) / D), where D &gt; 0 is an integer value used as dampener. This step has to be performed atomically. That is, until this step is completed, the server <span class="bcp14">MUST</span> hold the processing of an observation request for the same target resource from a new client. Finally, the server considers the result as the current observer counter, which can be taken into account for possibly canceling the group observation (see <a href="#ssec-server-side-cancellation" class="auto internal xref">Section 4.5</a>).<a href="#section-8.3.3-4" class="pilcrow">¶</a></p>
<p id="section-8.3.3-5">This estimate is skewed by packet loss, but it gives the server a sufficiently good estimation for further counts and for deciding when to cancel the group observation. It is up to applications to define policies about how the server takes the newly updated estimate into account and determines whether to cancel the group observation.<a href="#section-8.3.3-5" class="pilcrow">¶</a></p>
<p id="section-8.3.3-6">As an example, if the server currently estimates that N = COUNT = 32 observers are active and considers a constant M = 8, it sends out a notification with Multicast-Response-Feedback-Divider with value Q = 2. Then, out of 18 actually active clients, 5 send a re-registration request based on their random draw, of which one request gets lost, thus leaving 4 re-registration requests received by the server. Also, no new clients have been added to the group observation during this time, i.e., COUNT' is equal to COUNT. As a consequence, assuming that a dampener value D = 1 is used, the server computes the new estimated count value as 32 + (16 - 32) = 16, and keeps the group observation active.<a href="#section-8.3.3-6" class="pilcrow">¶</a></p>
<p id="section-8.3.3-7">To produce a most accurate updated counter, a server can include a Multicast-Response-Feedback-Divider Option with value Q = 0 in its multicast notifications, as if M is equal to N. This will trigger all the active clients to state their interest in continuing receiving notifications for the target resource. Thus, the amount R of arrived confirmations is affected only by possible packet loss.<a href="#section-8.3.3-7" class="pilcrow">¶</a></p>
<p id="section-8.3.3-8"><a href="#appendix-pseudo-code-counting-server" class="auto internal xref">Appendix B.3</a> provides a description in pseudo-code of the operations above performed by the server, including example behaviors for scheduling the next count update and deciding whether to cancel the group observation.<a href="#section-8.3.3-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="impact-from-proxies">
<section id="section-8.4">
        <h3 id="name-impact-from-proxies">
<a href="#section-8.4" class="section-number selfRef">8.4. </a><a href="#name-impact-from-proxies" class="section-name selfRef">Impact from Proxies</a>
        </h3>
<p id="section-8.4-1"><a href="#intermediaries" class="auto internal xref">Section 11</a> specifies how the approach presented in <a href="#sec-server-side" class="auto internal xref">Section 4</a> and <a href="#sec-client-side" class="auto internal xref">Section 5</a> works when a proxy is used between the origin clients and the origin server. That is, the clients register as observers at the proxy, which in turn registers as a participant to the group observation at the server, receives the multicast notifications from the server, and forwards those to the clients. In such a case, the following applies.<a href="#section-8.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.4-2.1">
            <p id="section-8.4-2.1.1">Since the Multicast-Response-Feedback-Divider Option is not Safe-to-Forward, the proxy needs to recognize and understand the option in order to participate to the rough counting process.<a href="#section-8.4-2.1.1" class="pilcrow">¶</a></p>
<p id="section-8.4-2.1.2">
If the proxy receives a request that includes the Multicast-Response-Feedback-Divider Option but the proxy does not recognize and understand the option, then the proxy has to stop processing the request and sends a 4.02 (Bad Option) response to the observer client (see <span><a href="https://rfc-editor.org/rfc/rfc7252#section-5.7.1" class="relref">Section 5.7.1</a> of [<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>). This results in the client terminating its observation at the proxy, after which the client stops receiving notifications for the group observation.<a href="#section-8.4-2.1.2" class="pilcrow">¶</a></p>
<p id="section-8.4-2.1.3">
If the proxy receives a multicast notification that includes the Multicast-Response-Feedback-Divider Option but the proxy does not recognize and understand the option, then the proxy has to stop processing the received multicast notification and sends a 5.02 (Bad Gateway) response to each of the observer clients (see <span><a href="https://rfc-editor.org/rfc/rfc7252#section-5.7.1" class="relref">Section 5.7.1</a> of [<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>). This results in all the observer clients terminating their observation at the proxy, after which they stop receiving notifications for the group observation. Consequently, the proxy may decide to forget about its participation to the group observation at the server.<a href="#section-8.4-2.1.3" class="pilcrow">¶</a></p>
<p id="section-8.4-2.1.4">
This is not an issue if communications between the origin endpoints are protected end-to-end, i.e., both for the requests from the origin clients by using OSCORE or Group OSCORE, as well as for the multicast notifications from the origin server by using Group OSCORE (see <a href="#sec-secured-notifications" class="auto internal xref">Section 9</a> and <a href="#intermediaries-e2e-security" class="auto internal xref">Section 12</a>). In fact, in such a case, the Multicast-Response-Feedback-Divider Option is protected end-to-end as well, and is thus hidden from the proxy.<a href="#section-8.4-2.1.4" class="pilcrow">¶</a></p>
<p id="section-8.4-2.1.5">
Therefore, if the server uses the rough counting process defined in this section but communications are not protected end-to-end between the origin endpoints, then it is practically required that the proxy recognizes and understands the Multicast-Response-Feedback-Divider Option. If that is not the case, then every execution of the rough counting process will effectively prevent the clients from receiving further notifications for the group observation, until they register again as observers at the proxy.<a href="#section-8.4-2.1.5" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.4-2.2">
            <p id="section-8.4-2.2.1">The following holds when the proxy receives a multicast notification including the Multicast-Response-Feedback-Divider Option.<a href="#section-8.4-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.4-2.2.2.1">
                <p id="section-8.4-2.2.2.1.1">If the multicast notification is not protected end-to-end by using Group OSCORE (see <a href="#intermediaries" class="auto internal xref">Section 11</a>), then the Multicast-Response-Feedback-Divider Option is visible to the proxy.<a href="#section-8.4-2.2.2.1.1" class="pilcrow">¶</a></p>
<p id="section-8.4-2.2.2.1.2">
In this case, the proxy proceeds like defined in <a href="#ssec-rough-counting-client-side" class="auto internal xref">Section 8.2</a> for an origin client, i.e., by answering to the server on its own in case it picks a random number I equal to 0. When doing so, the proxy will be counted by the server as a single client.<a href="#section-8.4-2.2.2.1.2" class="pilcrow">¶</a></p>
<p id="section-8.4-2.2.2.1.3">
Furthermore, the proxy <span class="bcp14">MUST</span> remove the option before forwarding the notification to (the previous hop towards) any of the origin clients.<a href="#section-8.4-2.2.2.1.3" class="pilcrow">¶</a></p>
<p id="section-8.4-2.2.2.1.4">
The proxy would have to rely on separate means for asserting whether the origin clients are still interested in the observation, e.g., by regularly forwarding notifications to the clients as unicast, Confirmable response messages.<a href="#section-8.4-2.2.2.1.4" class="pilcrow">¶</a></p>
<p id="section-8.4-2.2.2.1.5">
When no interested origin clients remain, the proxy can simply forget about being part of the group observation for the target resource at the server, like an origin client would do (see <a href="#ssec-client-side-cancellation" class="auto internal xref">Section 5.4</a>).<a href="#section-8.4-2.2.2.1.5" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.4-2.2.2.2">
                <p id="section-8.4-2.2.2.2.1">If the multicast notification is protected end-to-end by using Group OSCORE (see <a href="#sec-secured-notifications" class="auto internal xref">Section 9</a> and <a href="#intermediaries-e2e-security" class="auto internal xref">Section 12</a>), then the Multicast-Response-Feedback-Divider Option is protected end-to-end as well, and is thus hidden from the proxy. As a consequence, the proxy forwards the notification to (the previous hop towards) any of the origin clients, each of which answers to the server if it picks a random number I equal to 0.<a href="#section-8.4-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="sec-secured-notifications">
<section id="section-9">
      <h2 id="name-protection-of-multicast-not">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-protection-of-multicast-not" class="section-name selfRef">Protection of Multicast Notifications with Group OSCORE</a>
      </h2>
<p id="section-9-1">A server can protect multicast notifications by using the security protocol Group OSCORE <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>, thus ensuring that they are protected end-to-end for the observer clients. This requires that both the server and the clients interested in receiving multicast notifications from that server are members of the same OSCORE group.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">In some settings, the OSCORE group to refer to can be pre-configured on the clients and the server. In such a case, a server which is aware of such pre-configuration can simply assume a client to be already member of the correct OSCORE group.<a href="#section-9-2" class="pilcrow">¶</a></p>
<p id="section-9-3">In any other case, the server <span class="bcp14">MAY</span> communicate to clients what OSCORE group they are required to join, by providing additional guidance in the informative response as described in <a href="#sec-inf-response" class="auto internal xref">Section 9.1</a>. Note that clients can already be members of the right OSCORE group, in case they have previously joined it to securely communicate with the same server or with other servers to access their resources.<a href="#section-9-3" class="pilcrow">¶</a></p>
<p id="section-9-4">Both the clients and the server <span class="bcp14">MAY</span> join the OSCORE group by using the approach described in <span>[<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="cite xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span> and based on the ACE framework for Authentication and Authorization in constrained environments <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>. Further details on how to discover the OSCORE group and join it are out of the scope of this document.<a href="#section-9-4" class="pilcrow">¶</a></p>
<p id="section-9-5">If multicast notifications are protected using Group OSCORE, then the original registration requests and related unicast (notification) responses <span class="bcp14">MUST</span> also be protected, including and especially the informative responses from the server. An exception is the case discussed in <a href="#deterministic-phantom-Request" class="auto internal xref">Appendix D</a>, where the informative response from the server is not protected.<a href="#section-9-5" class="pilcrow">¶</a></p>
<p id="section-9-6">In order to protect unicast messages exchanged between the server and each client, including the original client registration (see <a href="#sec-client-side" class="auto internal xref">Section 5</a>), alternative security protocols than Group OSCORE can be used, such as OSCORE <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span> and/or DTLS <span>[<a href="#RFC9147" class="cite xref">RFC9147</a>]</span>. However, it is <span class="bcp14">RECOMMENDED</span> to use OSCORE or Group OSCORE.<a href="#section-9-6" class="pilcrow">¶</a></p>
<div id="sec-inf-response">
<section id="section-9.1">
        <h3 id="name-signaling-the-oscore-group-">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-signaling-the-oscore-group-" class="section-name selfRef">Signaling the OSCORE Group in the Informative Response</a>
        </h3>
<p id="section-9.1-1">This section describes a mechanism for the server to communicate to the client what OSCORE group to join, in order to decrypt and verify the multicast notifications protected with Group OSCORE. The client <span class="bcp14">MAY</span> use the information provided by the server to start the ACE joining procedure described in <span>[<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="cite xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span>. The mechanism defined in this section is <span class="bcp14">OPTIONAL</span> to support for the client and server.<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<p id="section-9.1-2">Additionally to what is defined in <a href="#sec-server-side" class="auto internal xref">Section 4</a>, the CBOR map in the informative response payload contains the following fields, whose CBOR abbreviations are defined in <a href="#informative-response-params" class="auto internal xref">Section 13</a>.<a href="#section-9.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.1-3.1">
            <p id="section-9.1-3.1.1">'join_uri', with value the URI for joining the OSCORE group at the respective Group Manager, encoded as a CBOR text string. If the procedure described in <span>[<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="cite xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span> is used for joining, this field specifically indicates the URI of the group-membership resource at the Group Manager.<a href="#section-9.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.1-3.2">
            <p id="section-9.1-3.2.1">'sec_gp', with value the name of the OSCORE group, encoded as a CBOR text string.<a href="#section-9.1-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.1-3.3">
            <p id="section-9.1-3.3.1">Optionally, 'as_uri', with value the URI of the Authorization Server associated with the Group Manager for the OSCORE group, encoded as a CBOR text string.<a href="#section-9.1-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.1-3.4">
            <p id="section-9.1-3.4.1">Optionally, 'hkdf', with value the HKDF Algorithm used in the OSCORE group, encoded as a CBOR text string or integer. The value is taken from the 'Value' column of the "COSE Algorithms" registry <span>[<a href="#COSE.Algorithms" class="cite xref">COSE.Algorithms</a>]</span>.<a href="#section-9.1-3.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.1-3.5">
            <p id="section-9.1-3.5.1">Optionally, 'cred_fmt', with value the format of the authentication credentials used in the OSCORE group, encoded as a CBOR integer. The value is taken from the 'Label' column of the "COSE Header Parameters" Registry <span>[<a href="#COSE.Header.Parameters" class="cite xref">COSE.Header.Parameters</a>]</span>. Consistently with <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-24#section-2.4" class="relref">Section 2.4</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>, acceptable values denote a format that <span class="bcp14">MUST</span> explicitly provide the comprehensive set of information related to the public key algorithm, including, e.g., the used elliptic curve (when applicable).<a href="#section-9.1-3.5.1" class="pilcrow">¶</a></p>
<p id="section-9.1-3.5.2">
At the time of writing this specification, acceptable formats of authentication credentials are CBOR Web Tokens (CWTs) and CWT Claim Sets (CCSs) <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span>, X.509 certificates <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>, and C509 certificates <span>[<a href="#I-D.ietf-cose-cbor-encoded-cert" class="cite xref">I-D.ietf-cose-cbor-encoded-cert</a>]</span>. Further formats may be available in the future, and would be acceptable to use as long as they comply with the criteria defined above.<a href="#section-9.1-3.5.2" class="pilcrow">¶</a></p>
<p id="section-9.1-3.5.3">
[ As to C509 certificates, there is a pending registration requested by draft-ietf-cose-cbor-encoded-cert. ]<a href="#section-9.1-3.5.3" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.1-3.6">
            <p id="section-9.1-3.6.1">Optionally, 'gp_enc_alg', with value the Group Encryption Algorithm used in the OSCORE group to encrypt messages protected with the group mode, encoded as a CBOR text string or integer. The value is taken from the 'Value' column of the "COSE Algorithms" registry <span>[<a href="#COSE.Algorithms" class="cite xref">COSE.Algorithms</a>]</span>.<a href="#section-9.1-3.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.1-3.7">
            <p id="section-9.1-3.7.1">Optionally, 'sign_alg', with value the Signature Algorithm used to sign messages in the OSCORE group, encoded as a CBOR text string or integer. The value is taken from the 'Value' column of the "COSE Algorithms" registry <span>[<a href="#COSE.Algorithms" class="cite xref">COSE.Algorithms</a>]</span>.<a href="#section-9.1-3.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.1-3.8">
            <p id="section-9.1-3.8.1">Optionally, 'sign_params', encoded as a CBOR array and including the following two elements:<a href="#section-9.1-3.8.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.1-3.8.2.1">
                <p id="section-9.1-3.8.2.1.1">'sign_alg_capab': a CBOR array, with the same format and value of the COSE capabilities array for the algorithm indicated in 'sign_alg', as specified for that algorithm in the 'Capabilities' column of the "COSE Algorithms" Registry <span>[<a href="#COSE.Algorithms" class="cite xref">COSE.Algorithms</a>]</span>.<a href="#section-9.1-3.8.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-9.1-3.8.2.2">
                <p id="section-9.1-3.8.2.2.1">'sign_key_type_capab': a CBOR array, with the same format and value of the COSE capabilities array for the COSE key type of the keys used with the algorithm indicated in 'sign_alg', as specified for that key type in the 'Capabilities' column of the "COSE Key Types" Registry <span>[<a href="#COSE.Key.Types" class="cite xref">COSE.Key.Types</a>]</span>.<a href="#section-9.1-3.8.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<p id="section-9.1-4">The values of 'sign_alg', 'sign_params', and 'cred_fmt' provide an early knowledge of the format of authentication credentials as well as of the type of public keys used in the OSCORE group. Thus, the client does not need to ask the Group Manager for this information as a preliminary step before the (ACE) join process, or to perform a trial-and-error exchange with the Group Manager upon joining the group. Hence, the client is able to provide the Group Manager with its own authentication credential in the correct expected format and including a public key of the correct expected type, at the very first step of the (ACE) join process.<a href="#section-9.1-4" class="pilcrow">¶</a></p>
<p id="section-9.1-5">The values of 'hkdf', 'gp_enc_alg', and 'sign_alg' provide an early knowledge of the algorithms used in the OSCORE group. Thus, the client is able to decide whether to actually proceed with the (ACE) join process, depending on its support for the indicated algorithms.<a href="#section-9.1-5" class="pilcrow">¶</a></p>
<p id="section-9.1-6">As mentioned above, since this mechanism is <span class="bcp14">OPTIONAL</span>, all the fields are <span class="bcp14">OPTIONAL</span> in the informative response. However, the 'join_uri' and 'sec_gp' fields <span class="bcp14">MUST</span> be present if the mechanism is implemented and used. If any of the fields are present without the 'join_uri' and 'sec_gp' fields present, the client <span class="bcp14">MUST</span> ignore these fields, since they would not be sufficient to start the (ACE) join procedure. When this happens, the client <span class="bcp14">MAY</span> try sending a new registration request to the server (see <a href="#ssec-client-side-request" class="auto internal xref">Section 5.1</a>). If the client chooses not to, then the client <span class="bcp14">SHOULD</span> explicitly withdraw from the group observation.<a href="#section-9.1-6" class="pilcrow">¶</a></p>
<p id="section-9.1-7"><a href="#self-managed-oscore-group" class="auto internal xref">Appendix C</a> describes a possible alternative approach, where the server self-manages the OSCORE group, and provides the observer clients with the necessary keying material in the informative response. The approach in <a href="#self-managed-oscore-group" class="auto internal xref">Appendix C</a> <span class="bcp14">MUST NOT</span> be used together with the mechanism defined in this section for indicating what OSCORE group to join.<a href="#section-9.1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-server-side-with-security">
<section id="section-9.2">
        <h3 id="name-server-side-requirements-2">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-server-side-requirements-2" class="section-name selfRef">Server-Side Requirements</a>
        </h3>
<p id="section-9.2-1">When using Group OSCORE to protect multicast notifications, the server performs the operations described in <a href="#sec-server-side" class="auto internal xref">Section 4</a>, with the following differences.<a href="#section-9.2-1" class="pilcrow">¶</a></p>
<div id="ssec-server-side-request-oscore">
<section id="section-9.2.1">
          <h4 id="name-registration">
<a href="#section-9.2.1" class="section-number selfRef">9.2.1. </a><a href="#name-registration" class="section-name selfRef">Registration</a>
          </h4>
<p id="section-9.2.1-1">The phantom registration request <span class="bcp14">MUST</span> be protected, by using Group OSCORE. In particular, the group mode of Group OSCORE defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-24#section-7" class="relref">Section 7</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span> <span class="bcp14">MUST</span> be used.<a href="#section-9.2.1-1" class="pilcrow">¶</a></p>
<p id="section-9.2.1-2">The server protects the phantom registration request as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-24#section-7.1" class="relref">Section 7.1</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>, as if it was the actual sender, i.e., by using its Sender Context. As a consequence, the server consumes the current value of its Sender Sequence Number SN in the OSCORE group, and hence updates it to SN* = (SN + 1). Consistently, the OSCORE Option in the phantom registration request includes:<a href="#section-9.2.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.2.1-3.1">
              <p id="section-9.2.1-3.1.1">As 'kid', the Sender ID of the server in the OSCORE group.<a href="#section-9.2.1-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-9.2.1-3.2">
              <p id="section-9.2.1-3.2.1">As 'piv', the Partial IV encoding the previously consumed Sender Sequence Number value SN of the server in the OSCORE group, i.e., (SN* - 1).<a href="#section-9.2.1-3.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="ssec-server-side-informative-oscore">
<section id="section-9.2.2">
          <h4 id="name-informative-response-3">
<a href="#section-9.2.2" class="section-number selfRef">9.2.2. </a><a href="#name-informative-response-3" class="section-name selfRef">Informative Response</a>
          </h4>
<p id="section-9.2.2-1">The value of the CBOR byte string in the 'ph_req' parameter encodes the phantom observation request as a message protected with Group OSCORE (see <a href="#ssec-server-side-request-oscore" class="auto internal xref">Section 9.2.1</a>). Consequently, the following applies:<a href="#section-9.2.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.2.2-2.1">
              <p id="section-9.2.2-2.1.1">The specified Code is always 0.05 (FETCH).<a href="#section-9.2.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-9.2.2-2.2">
              <p id="section-9.2.2-2.2.1">The sequence of CoAP options will be limited to the outer, non encrypted options.<a href="#section-9.2.2-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-9.2.2-2.3">
              <p id="section-9.2.2-2.3.1">A payload is always present, as the authenticated ciphertext followed by the signature.<a href="#section-9.2.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-9.2.2-3">Note that, in terms of transport-independent information, the registration request from the client typically differs from the phantom request. Thus, the server has to include the 'ph_req' parameter in the informative response. An exception is the case discussed in <a href="#deterministic-phantom-Request" class="auto internal xref">Appendix D</a>.<a href="#section-9.2.2-3" class="pilcrow">¶</a></p>
<p id="section-9.2.2-4">Similarly, the value of the CBOR byte string in the 'last_notif' parameter encodes the latest multicast notification as a message protected with Group OSCORE (see <a href="#ssec-server-side-notifications-oscore" class="auto internal xref">Section 9.2.3</a>). This applies also to the initial multicast notification INIT_NOTIF built at Step 6 of <a href="#ssec-server-side-request" class="auto internal xref">Section 4.1</a>.<a href="#section-9.2.2-4" class="pilcrow">¶</a></p>
<p id="section-9.2.2-5">Optionally, the informative response includes information on the OSCORE group to join, as additional parameters (see <a href="#sec-inf-response" class="auto internal xref">Section 9.1</a>).<a href="#section-9.2.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-server-side-notifications-oscore">
<section id="section-9.2.3">
          <h4 id="name-notifications-3">
<a href="#section-9.2.3" class="section-number selfRef">9.2.3. </a><a href="#name-notifications-3" class="section-name selfRef">Notifications</a>
          </h4>
<p id="section-9.2.3-1">The server <span class="bcp14">MUST</span> protect every multicast notification for the target resource with Group OSCORE. In particular, the group mode of Group OSCORE defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-24#section-7" class="relref">Section 7</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span> <span class="bcp14">MUST</span> be used.<a href="#section-9.2.3-1" class="pilcrow">¶</a></p>
<p id="section-9.2.3-2">The process described in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-24#section-7.3" class="relref">Section 7.3</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span> applies, with the following additions when building the two OSCORE 'external_aad' to encrypt and sign the multicast notification (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-24#section-3.4" class="relref">Section 3.4</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>).<a href="#section-9.2.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.2.3-3.1">
              <p id="section-9.2.3-3.1.1">The 'request_kid' is the 'kid' value in the OSCORE Option of the phantom registration request, i.e., the Sender ID of the server.<a href="#section-9.2.3-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-9.2.3-3.2">
              <p id="section-9.2.3-3.2.1">The 'request_piv' is the 'piv' value in the OSCORE Option of the phantom registration request, i.e., the Partial IV encoding the consumed Sender Sequence Number SN of the server.<a href="#section-9.2.3-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-9.2.3-3.3">
              <p id="section-9.2.3-3.3.1">The 'request_kid_context' is the 'kid context' value in the OSCORE Option of the phantom registration request, i.e., the Group Identifier value (Gid) of the OSCORE group used as ID Context.<a href="#section-9.2.3-3.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-9.2.3-4">Note that these same values are used to protect each and every multicast notification sent for the target resource under this group observation.<a href="#section-9.2.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-server-side-cancellation-oscore">
<section id="section-9.2.4">
          <h4 id="name-cancellation-3">
<a href="#section-9.2.4" class="section-number selfRef">9.2.4. </a><a href="#name-cancellation-3" class="section-name selfRef">Cancellation</a>
          </h4>
<p id="section-9.2.4-1">When canceling a group observation as defined in <a href="#ssec-server-side-cancellation" class="auto internal xref">Section 4.5</a>, the multicast response with error code 5.03 (Service Unavailable) is also protected with Group OSCORE, as per <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-24#section-7.3" class="relref">Section 7.3</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>. The server <span class="bcp14">MUST</span> use its own Sender Sequence Number as Partial IV to protect the error response, and include its encoding as the Partial IV in the OSCORE Option of the response.<a href="#section-9.2.4-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-client-side-with-security">
<section id="section-9.3">
        <h3 id="name-client-side-requirements-2">
<a href="#section-9.3" class="section-number selfRef">9.3. </a><a href="#name-client-side-requirements-2" class="section-name selfRef">Client-Side Requirements</a>
        </h3>
<p id="section-9.3-1">When using Group OSCORE to protect multicast notifications, the client performs as described in <a href="#sec-client-side" class="auto internal xref">Section 5</a>, with the following differences.<a href="#section-9.3-1" class="pilcrow">¶</a></p>
<div id="ssec-client-side-informative-oscore">
<section id="section-9.3.1">
          <h4 id="name-informative-response-4">
<a href="#section-9.3.1" class="section-number selfRef">9.3.1. </a><a href="#name-informative-response-4" class="section-name selfRef">Informative Response</a>
          </h4>
<p id="section-9.3.1-1">Upon receiving the informative response from the server, the client performs as described in <a href="#ssec-client-side-informative" class="auto internal xref">Section 5.2</a>, with the following additions.<a href="#section-9.3.1-1" class="pilcrow">¶</a></p>
<p id="section-9.3.1-2">When performing Step 2, the client expects the 'ph_req' parameter to be included in the informative response, which is otherwise considered malformed. An exception is the case discussed in <a href="#deterministic-phantom-Request" class="auto internal xref">Appendix D</a>.<a href="#section-9.3.1-2" class="pilcrow">¶</a></p>
<p id="section-9.3.1-3">Once completed Step 2, the client decrypts and verifies the rebuilt phantom registration request as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-24#section-7.2" class="relref">Section 7.2</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>, with the following differences.<a href="#section-9.3.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.3.1-4.1">
              <p id="section-9.3.1-4.1.1">The client <span class="bcp14">MUST NOT</span> perform any replay check. That is, the client skips Step 3 in <span><a href="https://rfc-editor.org/rfc/rfc8613#section-8.2" class="relref">Section 8.2</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>.<a href="#section-9.3.1-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-9.3.1-4.2">
              <p id="section-9.3.1-4.2.1">If decryption and verification of the phantom registration request succeed:<a href="#section-9.3.1-4.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.3.1-4.2.2.1">
                  <p id="section-9.3.1-4.2.2.1.1">The client <span class="bcp14">MUST NOT</span> update the Replay Window in the Recipient Context associated with the server. That is, the client skips the second bullet of Step 6 in <span><a href="https://rfc-editor.org/rfc/rfc8613#section-8.2" class="relref">Section 8.2</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>.<a href="#section-9.3.1-4.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-9.3.1-4.2.2.2">
                  <p id="section-9.3.1-4.2.2.2.1">The client <span class="bcp14">MUST NOT</span> take any further process as normally expected according to <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>. That is, the client skips Step 8 in <span><a href="https://rfc-editor.org/rfc/rfc8613#section-8.2" class="relref">Section 8.2</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>. In particular, the client <span class="bcp14">MUST NOT</span> deliver the phantom registration request to the application, and <span class="bcp14">MUST NOT</span> take any action in the Token space of its unicast endpoint where the informative response has been received.<a href="#section-9.3.1-4.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-9.3.1-4.2.2.3">
                  <p id="section-9.3.1-4.2.2.3.1">The client stores the values of the 'kid', 'piv', and 'kid context' fields from the OSCORE Option of the phantom registration request.<a href="#section-9.3.1-4.2.2.3.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-9.3.1-4.3">
              <p id="section-9.3.1-4.3.1">If decryption and verification of the phantom registration request fail, the client <span class="bcp14">MAY</span> try sending a new registration request to the server (see <a href="#ssec-client-side-request" class="auto internal xref">Section 5.1</a>). If the client chooses not to, then the client <span class="bcp14">SHOULD</span> explicitly withdraw from the group observation.<a href="#section-9.3.1-4.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-9.3.1-5">After successful decryption and verification, the client performs Step 3 in <a href="#ssec-client-side-informative" class="auto internal xref">Section 5.2</a>, considering the decrypted phantom registration request.<a href="#section-9.3.1-5" class="pilcrow">¶</a></p>
<p id="section-9.3.1-6">If the informative response includes the parameter 'last_notif', the client also decrypts and verifies the latest multicast notification rebuilt at Step 5 in <a href="#ssec-client-side-informative" class="auto internal xref">Section 5.2</a>, just like it would for the multicast notifications transmitted as CoAP messages on the wire (see <a href="#ssec-client-side-notifications-oscore" class="auto internal xref">Section 9.3.2</a>). If decryption and verification succeed, the client proceeds with Step 6, considering the decrypted latest multicast notification. Otherwise, the client proceeds to Step 7.<a href="#section-9.3.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-client-side-notifications-oscore">
<section id="section-9.3.2">
          <h4 id="name-notifications-4">
<a href="#section-9.3.2" class="section-number selfRef">9.3.2. </a><a href="#name-notifications-4" class="section-name selfRef">Notifications</a>
          </h4>
<p id="section-9.3.2-1">After having successfully processed the informative response as defined in <a href="#ssec-client-side-informative-oscore" class="auto internal xref">Section 9.3.1</a>, the client will decrypt and verify every multicast notification for the target resource as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-24#section-7.4" class="relref">Section 7.4</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>, with the following difference.<a href="#section-9.3.2-1" class="pilcrow">¶</a></p>
<p id="section-9.3.2-2">For both decryption and signature verification, the client <span class="bcp14">MUST</span> set the 'external_aad' defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-24#section-3.4" class="relref">Section 3.4</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span> as follows. The particular way to achieve this is implementation specific.<a href="#section-9.3.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.3.2-3.1">
              <p id="section-9.3.2-3.1.1">'request_kid' takes the value of the 'kid' field from the OSCORE Option of the phantom registration request (see <a href="#ssec-client-side-informative-oscore" class="auto internal xref">Section 9.3.1</a>).<a href="#section-9.3.2-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-9.3.2-3.2">
              <p id="section-9.3.2-3.2.1">'request_piv' takes the value of the 'piv' field from the OSCORE Option of the phantom registration request (see <a href="#ssec-client-side-informative-oscore" class="auto internal xref">Section 9.3.1</a>).<a href="#section-9.3.2-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-9.3.2-3.3">
              <p id="section-9.3.2-3.3.1">'request_kid_context' takes the value of the 'kid context' field from the OSCORE Option of the phantom registration request (see <a href="#ssec-client-side-informative-oscore" class="auto internal xref">Section 9.3.1</a>).<a href="#section-9.3.2-3.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-9.3.2-4">Note that these same values are used to decrypt and verify each and every multicast notification received for the target resource under this group observation.<a href="#section-9.3.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sec-example-with-security">
<section id="section-10">
      <h2 id="name-example-with-group-oscore">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-example-with-group-oscore" class="section-name selfRef">Example with Group OSCORE</a>
      </h2>
<p id="section-10-1">The following example refers to two clients C1 and C2 that register to observe a resource /r at a server S, which has address SRV_ADDR and listens to the port number SRV_PORT. Before the following exchanges occur, no clients are observing the resource /r , which has value "1234".<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">The server S sends multicast notifications to the IP multicast address GRP_ADDR and port number GRP_PORT, and starts the group observation upon receiving a registration request from a first client that wishes to start a traditional observation on the resource /r.<a href="#section-10-2" class="pilcrow">¶</a></p>
<p id="section-10-3">Pairwise communication over unicast is protected with OSCORE, while S protects multicast notifications with Group OSCORE. Specifically:<a href="#section-10-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10-4.1">
          <p id="section-10-4.1.1">C1 and S have a pairwise OSCORE Security Context. In particular, C1 has 'kid' = 0x01 as Sender ID, and SN_1 = 101 as Sender Sequence Number. Also, S has 'kid' = 0x03 as Sender ID, and SN_3 = 301 as Sender Sequence Number.<a href="#section-10-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-10-4.2">
          <p id="section-10-4.2.1">C2 and S have a pairwise OSCORE Security Context. In particular, C2 has 'kid' = 0x02 as Sender ID, and SN_2 = 201 as Sender Sequence Number. Also, S has 'kid' = 0x04 as Sender ID, and SN_4 = 401 as Sender Sequence Number.<a href="#section-10-4.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-10-4.3">
          <p id="section-10-4.3.1">S is a member of the OSCORE group with name "myGroup", and 'kid context' = 0x57ab2e as Group ID. In the OSCORE group, S has 'kid' = 0x05 as Sender ID, and SN_5 = 501 as Sender Sequence Number.<a href="#section-10-4.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-10-5">The following notation is used for the payload of the informative responses:<a href="#section-10-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10-6.1">
          <p id="section-10-6.1.1">The application-extension identifier "cri" defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-href-18#appendix-C" class="relref">Appendix C</a> of [<a href="#I-D.ietf-core-href" class="cite xref">I-D.ietf-core-href</a>]</span> is used to notate a CBOR Extended Diagnostic Notation (EDN) literal for a CRI.<a href="#section-10-6.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-10-6.2">
          <p id="section-10-6.2.1">'bstr(X)' denotes a CBOR byte string with value the byte serialization of X, with '|' denoting byte concatenation.<a href="#section-10-6.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-10-6.3">
          <p id="section-10-6.3.1">'OPT' denotes a sequence of CoAP options. This refers to the phantom registration request encoded by the 'ph_req' parameter, or to the corresponding latest multicast notification encoded by the 'last_notif' parameter.<a href="#section-10-6.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-10-6.4">
          <p id="section-10-6.4.1">'PAYLOAD' denotes an encrypted CoAP payload. This refers to the phantom registration request encoded by the 'ph_req' parameter, or to the corresponding latest multicast notification encoded by the 'last_notif' parameter.<a href="#section-10-6.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-10-6.5">
          <p id="section-10-6.5.1">'SIGN' denotes the signature appended to an encrypted CoAP payload. This refers to the phantom registration request encoded by the 'ph_req' parameter, or to the corresponding latest multicast notification encoded by the 'last_notif' parameter.<a href="#section-10-6.5.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<span id="name-example-of-group-observation"></span><div id="example-oscore">
<figure id="figure-7">
        <div id="section-10-7.1">
          <div class="alignLeft art-svg artwork" id="section-10-7.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="2192" width="552" viewBox="0 0 552 2192" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 8,48 L 8,720" fill="none" stroke="black"></path>
              <path d="M 8,752 L 8,1152" fill="none" stroke="black"></path>
              <path d="M 8,1184 L 8,1408" fill="none" stroke="black"></path>
              <path d="M 8,1440 L 8,1888" fill="none" stroke="black"></path>
              <path d="M 8,1952 L 8,2176" fill="none" stroke="black"></path>
              <path d="M 32,1888 L 32,1952" fill="none" stroke="black"></path>
              <path d="M 512,48 L 512,720" fill="none" stroke="black"></path>
              <path d="M 512,752 L 512,1152" fill="none" stroke="black"></path>
              <path d="M 512,1184 L 512,1408" fill="none" stroke="black"></path>
              <path d="M 512,1440 L 512,1904" fill="none" stroke="black"></path>
              <path d="M 512,1936 L 512,2176" fill="none" stroke="black"></path>
              <path d="M 32,32 L 152,32" fill="none" stroke="black"></path>
              <path d="M 352,32 L 496,32" fill="none" stroke="black"></path>
              <path d="M 56,304 L 496,304" fill="none" stroke="black"></path>
              <path d="M 56,352 L 496,352" fill="none" stroke="black"></path>
              <path d="M 432,608 L 448,608" fill="none" stroke="black"></path>
              <path d="M 32,736 L 152,736" fill="none" stroke="black"></path>
              <path d="M 344,736 L 496,736" fill="none" stroke="black"></path>
              <path d="M 32,1168 L 152,1168" fill="none" stroke="black"></path>
              <path d="M 352,1168 L 496,1168" fill="none" stroke="black"></path>
              <path d="M 32,1424 L 152,1424" fill="none" stroke="black"></path>
              <path d="M 344,1424 L 496,1424" fill="none" stroke="black"></path>
              <path d="M 8,1888 L 32,1888" fill="none" stroke="black"></path>
              <path d="M 48,1920 L 136,1920" fill="none" stroke="black"></path>
              <path d="M 392,1920 L 496,1920" fill="none" stroke="black"></path>
              <path d="M 8,1952 L 32,1952" fill="none" stroke="black"></path>
              <path d="M 44,328 L 56,352" fill="none" stroke="black"></path>
              <path d="M 44,328 L 56,304" fill="none" stroke="black"></path>
              <path d="M 248,1936 L 256,1920" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="504,1168 492,1162.4 492,1173.6" fill="black" transform="rotate(0,496,1168)"></polygon>
              <polygon class="arrowhead" points="504,352 492,346.4 492,357.6" fill="black" transform="rotate(0,496,352)"></polygon>
              <polygon class="arrowhead" points="504,32 492,26.4 492,37.6" fill="black" transform="rotate(0,496,32)"></polygon>
              <polygon class="arrowhead" points="440,608 428,602.4 428,613.6" fill="black" transform="rotate(180,432,608)"></polygon>
              <polygon class="arrowhead" points="56,1920 44,1914.4 44,1925.6" fill="black" transform="rotate(180,48,1920)"></polygon>
              <polygon class="arrowhead" points="40,1424 28,1418.4 28,1429.6" fill="black" transform="rotate(180,32,1424)"></polygon>
              <polygon class="arrowhead" points="40,736 28,730.4 28,741.6" fill="black" transform="rotate(180,32,736)"></polygon>
              <g class="text">
                <text x="12" y="36">C1</text>
                <text x="168" y="36">[</text>
                <text x="208" y="36">Unicast</text>
                <text x="252" y="36">w/</text>
                <text x="292" y="36">OSCORE</text>
                <text x="328" y="36">]</text>
                <text x="512" y="36">S</text>
                <text x="540" y="36">/r</text>
                <text x="44" y="52">0.05</text>
                <text x="96" y="52">(FETCH)</text>
                <text x="52" y="68">Token:</text>
                <text x="100" y="68">0x4a</text>
                <text x="56" y="84">OSCORE:</text>
                <text x="112" y="84">{kid:</text>
                <text x="160" y="84">0x01;</text>
                <text x="204" y="84">piv:</text>
                <text x="244" y="84">101;</text>
                <text x="284" y="84">...}</text>
                <text x="52" y="100">&lt;Other</text>
                <text x="104" y="100">class</text>
                <text x="144" y="100">U/I</text>
                <text x="196" y="100">options&gt;</text>
                <text x="44" y="116">0xff</text>
                <text x="96" y="132">Encrypted_payload</text>
                <text x="176" y="132">{</text>
                <text x="60" y="148">0x01</text>
                <text x="108" y="148">(GET),</text>
                <text x="76" y="164">Observe:</text>
                <text x="120" y="164">0</text>
                <text x="176" y="164">(register),</text>
                <text x="80" y="180">Uri-Path:</text>
                <text x="140" y="180">"r",</text>
                <text x="68" y="196">&lt;Other</text>
                <text x="120" y="196">class</text>
                <text x="152" y="196">E</text>
                <text x="196" y="196">options&gt;</text>
                <text x="32" y="212">}</text>
                <text x="136" y="244">(</text>
                <text x="152" y="244">S</text>
                <text x="200" y="244">allocates</text>
                <text x="256" y="244">the</text>
                <text x="312" y="244">available</text>
                <text x="376" y="244">Token</text>
                <text x="424" y="244">value</text>
                <text x="468" y="244">0x7b</text>
                <text x="496" y="244">)</text>
                <text x="56" y="276">(</text>
                <text x="72" y="276">S</text>
                <text x="104" y="276">sends</text>
                <text x="140" y="276">to</text>
                <text x="180" y="276">itself</text>
                <text x="216" y="276">a</text>
                <text x="256" y="276">phantom</text>
                <text x="336" y="276">observation</text>
                <text x="416" y="276">request</text>
                <text x="476" y="276">PH_REQ</text>
                <text x="76" y="292">as</text>
                <text x="116" y="292">coming</text>
                <text x="164" y="292">from</text>
                <text x="200" y="292">the</text>
                <text x="228" y="292">IP</text>
                <text x="280" y="292">multicast</text>
                <text x="352" y="292">address</text>
                <text x="420" y="292">GRP_ADDR</text>
                <text x="472" y="292">)</text>
                <text x="540" y="356">/r</text>
                <text x="228" y="372">0.05</text>
                <text x="280" y="372">(FETCH)</text>
                <text x="236" y="388">Token:</text>
                <text x="284" y="388">0x7b</text>
                <text x="240" y="404">OSCORE:</text>
                <text x="296" y="404">{kid:</text>
                <text x="340" y="404">0x05</text>
                <text x="368" y="404">;</text>
                <text x="396" y="404">piv:</text>
                <text x="436" y="404">501;</text>
                <text x="296" y="420">kid</text>
                <text x="348" y="420">context:</text>
                <text x="424" y="420">0x57ab2e;</text>
                <text x="484" y="420">...}</text>
                <text x="236" y="436">&lt;Other</text>
                <text x="288" y="436">class</text>
                <text x="328" y="436">U/I</text>
                <text x="380" y="436">options&gt;</text>
                <text x="228" y="452">0xff</text>
                <text x="280" y="468">Encrypted_payload</text>
                <text x="360" y="468">{</text>
                <text x="244" y="484">0x01</text>
                <text x="292" y="484">(GET),</text>
                <text x="260" y="500">Observe:</text>
                <text x="304" y="500">0</text>
                <text x="360" y="500">(register),</text>
                <text x="264" y="516">Uri-Path:</text>
                <text x="324" y="516">"r",</text>
                <text x="252" y="532">&lt;Other</text>
                <text x="304" y="532">class</text>
                <text x="336" y="532">E</text>
                <text x="380" y="532">options&gt;</text>
                <text x="216" y="548">}</text>
                <text x="256" y="564">&lt;Signature&gt;</text>
                <text x="232" y="596">(</text>
                <text x="248" y="596">S</text>
                <text x="280" y="596">steps</text>
                <text x="324" y="596">SN_5</text>
                <text x="356" y="596">in</text>
                <text x="384" y="596">the</text>
                <text x="424" y="596">Group</text>
                <text x="476" y="596">OSCORE</text>
                <text x="276" y="612">Security</text>
                <text x="348" y="612">Context:</text>
                <text x="404" y="612">SN_5</text>
                <text x="472" y="612">502</text>
                <text x="496" y="612">)</text>
                <text x="192" y="660">(</text>
                <text x="208" y="660">S</text>
                <text x="248" y="660">creates</text>
                <text x="288" y="660">a</text>
                <text x="320" y="660">group</text>
                <text x="392" y="660">observation</text>
                <text x="452" y="660">of</text>
                <text x="476" y="660">/r</text>
                <text x="496" y="660">)</text>
                <text x="224" y="692">(</text>
                <text x="240" y="692">S</text>
                <text x="292" y="692">increments</text>
                <text x="352" y="692">the</text>
                <text x="404" y="692">observer</text>
                <text x="472" y="692">counter</text>
                <text x="248" y="708">for</text>
                <text x="280" y="708">the</text>
                <text x="320" y="708">group</text>
                <text x="392" y="708">observation</text>
                <text x="452" y="708">of</text>
                <text x="476" y="708">/r</text>
                <text x="496" y="708">)</text>
                <text x="12" y="740">C1</text>
                <text x="168" y="740">[</text>
                <text x="208" y="740">Unicast</text>
                <text x="252" y="740">w/</text>
                <text x="292" y="740">OSCORE</text>
                <text x="328" y="740">]</text>
                <text x="512" y="740">S</text>
                <text x="44" y="756">2.05</text>
                <text x="104" y="756">(Content)</text>
                <text x="52" y="772">Token:</text>
                <text x="100" y="772">0x4a</text>
                <text x="56" y="788">OSCORE:</text>
                <text x="112" y="788">{piv:</text>
                <text x="156" y="788">301;</text>
                <text x="196" y="788">...}</text>
                <text x="60" y="804">Max-Age:</text>
                <text x="104" y="804">0</text>
                <text x="52" y="820">&lt;Other</text>
                <text x="104" y="820">class</text>
                <text x="144" y="820">U/I</text>
                <text x="196" y="820">options&gt;</text>
                <text x="44" y="836">0xff</text>
                <text x="96" y="852">Encrypted_payload</text>
                <text x="176" y="852">{</text>
                <text x="60" y="868">5.03</text>
                <text x="116" y="868">(Service</text>
                <text x="208" y="868">Unavailable),</text>
                <text x="104" y="884">Content-Format:</text>
                <text x="324" y="884">application/informative-response+cbor,</text>
                <text x="68" y="900">&lt;Other</text>
                <text x="120" y="900">class</text>
                <text x="152" y="900">E</text>
                <text x="200" y="900">options&gt;,</text>
                <text x="64" y="916">0xff,</text>
                <text x="72" y="932">Payload</text>
                <text x="112" y="932">{</text>
                <text x="64" y="948">/</text>
                <text x="104" y="948">tp_info</text>
                <text x="144" y="948">/</text>
                <text x="184" y="948">0</text>
                <text x="200" y="948">:</text>
                <text x="216" y="948">[</text>
                <text x="344" y="964">cri'coap://SRV_ADDR:SRV_PORT/',</text>
                <text x="360" y="980">cri'coap://GRP_ADDR:GRP_PORT/',</text>
                <text x="268" y="996">0x7b</text>
                <text x="220" y="1012">],</text>
                <text x="64" y="1028">/</text>
                <text x="100" y="1028">ph_req</text>
                <text x="136" y="1028">/</text>
                <text x="184" y="1028">1</text>
                <text x="200" y="1028">:</text>
                <text x="248" y="1028">bstr(0x05</text>
                <text x="296" y="1028">|</text>
                <text x="320" y="1028">OPT</text>
                <text x="344" y="1028">|</text>
                <text x="372" y="1028">0xff</text>
                <text x="400" y="1028">|</text>
                <text x="280" y="1044">PAYLOAD</text>
                <text x="320" y="1044">|</text>
                <text x="356" y="1044">SIGN),</text>
                <text x="64" y="1060">/</text>
                <text x="116" y="1060">last_notif</text>
                <text x="168" y="1060">/</text>
                <text x="184" y="1060">2</text>
                <text x="200" y="1060">:</text>
                <text x="248" y="1060">bstr(0x45</text>
                <text x="296" y="1060">|</text>
                <text x="320" y="1060">OPT</text>
                <text x="344" y="1060">|</text>
                <text x="372" y="1060">0xff</text>
                <text x="400" y="1060">|</text>
                <text x="280" y="1076">PAYLOAD</text>
                <text x="320" y="1076">|</text>
                <text x="356" y="1076">SIGN),</text>
                <text x="64" y="1092">/</text>
                <text x="108" y="1092">join_uri</text>
                <text x="152" y="1092">/</text>
                <text x="184" y="1092">4</text>
                <text x="200" y="1092">:</text>
                <text x="340" y="1092">"coap://myGM/ace-group/myGroup",</text>
                <text x="64" y="1108">/</text>
                <text x="100" y="1108">sec_gp</text>
                <text x="136" y="1108">/</text>
                <text x="184" y="1108">5</text>
                <text x="200" y="1108">:</text>
                <text x="248" y="1108">"myGroup"</text>
                <text x="48" y="1124">}</text>
                <text x="32" y="1140">}</text>
                <text x="12" y="1172">C2</text>
                <text x="168" y="1172">[</text>
                <text x="208" y="1172">Unicast</text>
                <text x="252" y="1172">w/</text>
                <text x="292" y="1172">OSCORE</text>
                <text x="328" y="1172">]</text>
                <text x="512" y="1172">S</text>
                <text x="540" y="1172">/r</text>
                <text x="44" y="1188">0.05</text>
                <text x="96" y="1188">(FETCH)</text>
                <text x="52" y="1204">Token:</text>
                <text x="100" y="1204">0x01</text>
                <text x="56" y="1220">OSCORE:</text>
                <text x="112" y="1220">{kid:</text>
                <text x="160" y="1220">0x02;</text>
                <text x="204" y="1220">piv:</text>
                <text x="244" y="1220">201;</text>
                <text x="284" y="1220">...}</text>
                <text x="52" y="1236">&lt;Other</text>
                <text x="104" y="1236">class</text>
                <text x="144" y="1236">U/I</text>
                <text x="196" y="1236">options&gt;</text>
                <text x="44" y="1252">0xff</text>
                <text x="96" y="1268">Encrypted_payload</text>
                <text x="176" y="1268">{</text>
                <text x="60" y="1284">0x01</text>
                <text x="108" y="1284">(GET),</text>
                <text x="76" y="1300">Observe:</text>
                <text x="120" y="1300">0</text>
                <text x="176" y="1300">(register),</text>
                <text x="80" y="1316">Uri-Path:</text>
                <text x="140" y="1316">"r",</text>
                <text x="68" y="1332">&lt;Other</text>
                <text x="120" y="1332">class</text>
                <text x="152" y="1332">E</text>
                <text x="196" y="1332">options&gt;</text>
                <text x="32" y="1348">}</text>
                <text x="224" y="1380">(</text>
                <text x="240" y="1380">S</text>
                <text x="292" y="1380">increments</text>
                <text x="352" y="1380">the</text>
                <text x="404" y="1380">observer</text>
                <text x="472" y="1380">counter</text>
                <text x="248" y="1396">for</text>
                <text x="280" y="1396">the</text>
                <text x="320" y="1396">group</text>
                <text x="392" y="1396">observation</text>
                <text x="452" y="1396">of</text>
                <text x="476" y="1396">/r</text>
                <text x="496" y="1396">)</text>
                <text x="12" y="1428">C2</text>
                <text x="168" y="1428">[</text>
                <text x="208" y="1428">Unicast</text>
                <text x="252" y="1428">w/</text>
                <text x="292" y="1428">OSCORE</text>
                <text x="328" y="1428">]</text>
                <text x="512" y="1428">S</text>
                <text x="44" y="1444">2.05</text>
                <text x="104" y="1444">(Content)</text>
                <text x="52" y="1460">Token:</text>
                <text x="100" y="1460">0x01</text>
                <text x="56" y="1476">OSCORE:</text>
                <text x="112" y="1476">{piv:</text>
                <text x="156" y="1476">401;</text>
                <text x="196" y="1476">...}</text>
                <text x="60" y="1492">Max-Age:</text>
                <text x="104" y="1492">0</text>
                <text x="52" y="1508">&lt;Other</text>
                <text x="104" y="1508">class</text>
                <text x="144" y="1508">U/I</text>
                <text x="196" y="1508">options&gt;</text>
                <text x="48" y="1524">0xff,</text>
                <text x="96" y="1540">Encrypted_payload</text>
                <text x="176" y="1540">{</text>
                <text x="60" y="1556">5.03</text>
                <text x="116" y="1556">(Service</text>
                <text x="208" y="1556">Unavailable),</text>
                <text x="104" y="1572">Content-Format:</text>
                <text x="324" y="1572">application/informative-response+cbor,</text>
                <text x="68" y="1588">&lt;Other</text>
                <text x="120" y="1588">class</text>
                <text x="152" y="1588">E</text>
                <text x="200" y="1588">options&gt;,</text>
                <text x="64" y="1604">0xff,</text>
                <text x="72" y="1620">Payload</text>
                <text x="112" y="1620">{</text>
                <text x="64" y="1636">/</text>
                <text x="104" y="1636">tp_info</text>
                <text x="144" y="1636">/</text>
                <text x="184" y="1636">0</text>
                <text x="200" y="1636">:</text>
                <text x="216" y="1636">[</text>
                <text x="344" y="1652">cri'coap://SRV_ADDR:SRV_PORT/',</text>
                <text x="360" y="1668">cri'coap://GRP_ADDR:GRP_PORT/',</text>
                <text x="268" y="1684">0x7b</text>
                <text x="220" y="1700">],</text>
                <text x="64" y="1716">/</text>
                <text x="100" y="1716">ph_req</text>
                <text x="136" y="1716">/</text>
                <text x="184" y="1716">1</text>
                <text x="200" y="1716">:</text>
                <text x="248" y="1716">bstr(0x05</text>
                <text x="296" y="1716">|</text>
                <text x="320" y="1716">OPT</text>
                <text x="344" y="1716">|</text>
                <text x="372" y="1716">0xff</text>
                <text x="400" y="1716">|</text>
                <text x="280" y="1732">PAYLOAD</text>
                <text x="320" y="1732">|</text>
                <text x="356" y="1732">SIGN),</text>
                <text x="64" y="1748">/</text>
                <text x="116" y="1748">last_notif</text>
                <text x="168" y="1748">/</text>
                <text x="184" y="1748">2</text>
                <text x="200" y="1748">:</text>
                <text x="248" y="1748">bstr(0x45</text>
                <text x="296" y="1748">|</text>
                <text x="320" y="1748">OPT</text>
                <text x="344" y="1748">|</text>
                <text x="372" y="1748">0xff</text>
                <text x="400" y="1748">|</text>
                <text x="280" y="1764">PAYLOAD</text>
                <text x="320" y="1764">|</text>
                <text x="356" y="1764">SIGN),</text>
                <text x="64" y="1780">/</text>
                <text x="108" y="1780">join_uri</text>
                <text x="152" y="1780">/</text>
                <text x="184" y="1780">4</text>
                <text x="200" y="1780">:</text>
                <text x="340" y="1780">"coap://myGM/ace-group/myGroup",</text>
                <text x="64" y="1796">/</text>
                <text x="100" y="1796">sec_gp</text>
                <text x="136" y="1796">/</text>
                <text x="184" y="1796">5</text>
                <text x="200" y="1796">:</text>
                <text x="248" y="1796">"myGroup"</text>
                <text x="48" y="1812">}</text>
                <text x="32" y="1828">}</text>
                <text x="104" y="1860">(</text>
                <text x="128" y="1860">The</text>
                <text x="168" y="1860">value</text>
                <text x="204" y="1860">of</text>
                <text x="232" y="1860">the</text>
                <text x="284" y="1860">resource</text>
                <text x="332" y="1860">/r</text>
                <text x="376" y="1860">changes</text>
                <text x="420" y="1860">to</text>
                <text x="460" y="1860">"5678"</text>
                <text x="496" y="1860">)</text>
                <text x="12" y="1908">C1</text>
                <text x="152" y="1924">[</text>
                <text x="200" y="1924">Multicast</text>
                <text x="248" y="1924">w</text>
                <text x="288" y="1924">Group</text>
                <text x="340" y="1924">OSCORE</text>
                <text x="376" y="1924">]</text>
                <text x="512" y="1924">S</text>
                <text x="12" y="1940">C2</text>
                <text x="132" y="1940">(Destination</text>
                <text x="216" y="1940">address</text>
                <text x="272" y="1940">port:</text>
                <text x="372" y="1940">GRP_ADDR/GRP_PORT)</text>
                <text x="60" y="1972">2.05</text>
                <text x="120" y="1972">(Content)</text>
                <text x="68" y="1988">Token:</text>
                <text x="116" y="1988">0x7b</text>
                <text x="72" y="2004">OSCORE:</text>
                <text x="128" y="2004">{kid:</text>
                <text x="176" y="2004">0x05;</text>
                <text x="220" y="2004">piv:</text>
                <text x="260" y="2004">502;</text>
                <text x="300" y="2004">...}</text>
                <text x="68" y="2020">&lt;Other</text>
                <text x="120" y="2020">class</text>
                <text x="160" y="2020">U/I</text>
                <text x="212" y="2020">options&gt;</text>
                <text x="60" y="2036">0xff</text>
                <text x="112" y="2052">Encrypted_payload</text>
                <text x="192" y="2052">{</text>
                <text x="76" y="2068">2.05</text>
                <text x="140" y="2068">(Content),</text>
                <text x="92" y="2084">Observe:</text>
                <text x="164" y="2084">[empty],</text>
                <text x="84" y="2100">&lt;Other</text>
                <text x="136" y="2100">class</text>
                <text x="168" y="2100">E</text>
                <text x="216" y="2100">options&gt;,</text>
                <text x="80" y="2116">0xff,</text>
                <text x="92" y="2132">Payload:</text>
                <text x="156" y="2132">"5678"</text>
                <text x="48" y="2148">}</text>
                <text x="88" y="2164">&lt;Signature&gt;</text>
              </g>
            </svg><a href="#section-10-7.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-example-of-group-observation" class="selfRef">Example of Group Observation with Group OSCORE</a>
        </figcaption></figure>
</div>
<p id="section-10-8">The two external_aad used to encrypt and sign the multicast notification above have 'request_kid' = 5, 'request_piv' = 501, and 'request_kid_context' = 0x57ab2e. These values are specified in the 'kid', 'piv', and 'kid context' field of the OSCORE Option of the phantom observation request, which is encoded in the 'ph_req' parameter of the unicast informative response to the two clients. Thus, the two clients can build the two same external_aad for decrypting and verifying this multicast notification and the following ones in the group observation.<a href="#section-10-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="intermediaries">
<section id="section-11">
      <h2 id="name-intermediaries">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-intermediaries" class="section-name selfRef">Intermediaries</a>
      </h2>
<p id="section-11-1">This section specifies how the approach presented in <a href="#sec-server-side" class="auto internal xref">Section 4</a> and <a href="#sec-client-side" class="auto internal xref">Section 5</a> works when a proxy is used between the clients and the server. In addition to what is specified in <span><a href="https://rfc-editor.org/rfc/rfc7252#section-5.7" class="relref">Section 5.7</a> of [<a href="#RFC7252" class="cite xref">RFC7252</a>]</span> and <span><a href="https://rfc-editor.org/rfc/rfc7641#section-5" class="relref">Section 5</a> of [<a href="#RFC7641" class="cite xref">RFC7641</a>]</span>, the following applies.<a href="#section-11-1" class="pilcrow">¶</a></p>
<p id="section-11-2">A client sends its original observation request to the proxy. If the proxy is not already registered at the server for that target resource, the proxy forwards the observation request to the server, hence registering itself as an observer. If the server has an ongoing group observation for the target resource or decides to start one, the server considers the proxy as taking part in the group observation, and replies to the proxy with an informative response.<a href="#section-11-2" class="pilcrow">¶</a></p>
<p id="section-11-3">Upon receiving an informative response, the proxy performs as specified for the client in <a href="#sec-client-side" class="auto internal xref">Section 5</a>, with the peculiarity that "consuming" the last notification (if present) means populating its cache.<a href="#section-11-3" class="pilcrow">¶</a></p>
<p id="section-11-4">In particular, by using the information retrieved from the informative response, the proxy configures an observation of the target resource at the origin server, acting as a client directly taking part in the group observation.<a href="#section-11-4" class="pilcrow">¶</a></p>
<p id="section-11-5">As a consequence, the proxy listens to the IP multicast address and port number indicated by the server, i.e., per the CRI specified by a dedicated element of 'tpi_details' within the 'tp_info' parameter, in the informative response. In particular, when transporting CoAP over UDP, the CRI is conveyed by the element 'tpi_client' (see <a href="#ssssec-udp-transport-specific" class="auto internal xref">Section 4.2.1.1</a>).<a href="#section-11-5" class="pilcrow">¶</a></p>
<p id="section-11-6">Furthermore, multicast notifications will match the phantom request stored at the proxy, based on the Token value specified by a dedicated element of 'tpi_details' within the 'tp_info' parameter, in the informative response. In particular, when transporting CoAP over UDP, the Token value is specified by the element 'tpi_token' (see <a href="#ssssec-udp-transport-specific" class="auto internal xref">Section 4.2.1.1</a>).<a href="#section-11-6" class="pilcrow">¶</a></p>
<p id="section-11-7">Then, the proxy performs the following actions.<a href="#section-11-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11-8.1">
          <p id="section-11-8.1.1">If the 'last_notif' field is not present, the proxy responds to the client with an Empty Acknowledgement (if indicated by the message type, and if the proxy has not already done so).<a href="#section-11-8.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-11-8.2">
          <p id="section-11-8.2.1">If the 'last_notif' field is present, the proxy rebuilds the latest multicast notification, as defined in <a href="#sec-client-side" class="auto internal xref">Section 5</a>. Then, the proxy responds to the client, by forwarding back the latest multicast notification.<a href="#section-11-8.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-11-9">When responding to an observation request from a client, the proxy also adds that client (and its Token) to the list of its registered observers for the target resource, next to the older observations.<a href="#section-11-9" class="pilcrow">¶</a></p>
<p id="section-11-10">Upon receiving a multicast notification from the server, the proxy forwards it back separately to each observer client over unicast. Note that the notification forwarded back to a certain client has the same Token value of the original observation request sent by that client to the proxy.<a href="#section-11-10" class="pilcrow">¶</a></p>
<p id="section-11-11">Note that the proxy configures the observation of the target resource at the server only once, when receiving the informative response associated with a (newly started) group observation for that target resource.<a href="#section-11-11" class="pilcrow">¶</a></p>
<p id="section-11-12">After that, when receiving an observation request from a following new client to be added to the same group observation, the proxy does not take any further action with the server. Instead, the proxy responds to the client either with the latest multicast notification if available from its cache, or with an Empty Acknowledgement otherwise, as defined above.<a href="#section-11-12" class="pilcrow">¶</a></p>
<p id="section-11-13">As a result, the observer counter at the server (see <a href="#sec-server-side" class="auto internal xref">Section 4</a>) is not incremented when a new origin client behind the proxy registers as an observer at the proxy. Instead, the observer counter takes into account only the proxy, which has registered as observer at the server and has received the informative response from the server.<a href="#section-11-13" class="pilcrow">¶</a></p>
<p id="section-11-14">An example is provided in <a href="#intermediaries-example" class="auto internal xref">Appendix E</a>.<a href="#section-11-14" class="pilcrow">¶</a></p>
<p id="section-11-15">In the general case with a chain of two or more proxies, every proxy in the chain takes the role of client with the (next hop towards the) origin server. Note that the proxy adjacent to the origin server is the only one in the chain that receives informative responses, and that listens to an IP multicast address and port number to receive notifications for the group observation. Furthermore, every proxy in the chain takes the role of server with the (previous hop towards the) origin client.<a href="#section-11-15" class="pilcrow">¶</a></p>
</section>
</div>
<div id="intermediaries-e2e-security">
<section id="section-12">
      <h2 id="name-intermediaries-together-wit">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-intermediaries-together-wit" class="section-name selfRef">Intermediaries Together with End-to-End Security</a>
      </h2>
<p id="section-12-1">As defined in <a href="#sec-secured-notifications" class="auto internal xref">Section 9</a>, Group OSCORE can be used to protect multicast notifications end-to-end between the origin server and the origin clients. In such a case, additional actions are required when also the informative responses from the origin server are protected specifically end-to-end, by using OSCORE or Group OSCORE.<a href="#section-12-1" class="pilcrow">¶</a></p>
<p id="section-12-2">In fact, the proxy adjacent to the origin server is not able to access the encrypted payload of such informative responses. Hence, the proxy cannot retrieve the 'ph_req' and 'tp_info' parameters necessary to correctly receive multicast notifications and forward them back to the clients.<a href="#section-12-2" class="pilcrow">¶</a></p>
<p id="section-12-3">Then, differently from what is defined in <a href="#intermediaries" class="auto internal xref">Section 11</a>, each proxy receiving an informative response simply forwards it back to the client that has sent the corresponding observation request. Note that the proxy does not even realize that the message is an actual informative response, since the outer Code field is set to 2.05 (Content).<a href="#section-12-3" class="pilcrow">¶</a></p>
<p id="section-12-4">Upon receiving the informative response, the client does not configure an observation of the target resource. Instead, the client performs a new observe registration request, by transmitting the re-built phantom request as intended to reach the proxy adjacent to the origin server. In particular, the client includes the new Listen-To-Multicast-Responses CoAP option defined in <a href="#ltmr-option" class="auto internal xref">Section 12.1</a>, to provide that proxy with the transport-specific information required for receiving multicast notifications for the group observation.<a href="#section-12-4" class="pilcrow">¶</a></p>
<p id="section-12-5">As a result, the observer counter at the server (see <a href="#sec-server-side" class="auto internal xref">Section 4</a>) is incremented when, after having received the original observation request from a new origin client, the origin server replies with the informative response. In particular, the observer counter at the server reliably takes into account the new, different origin clients behind the proxy, which the server distinguishes through their security identity specified by the pair (OSCORE Sender ID, OSCORE ID Context) in the OSCORE Option of their original observation request. Note that this does not hold anymore if the origin endpoints use phantom observation requests as deterministic requests (see <a href="#deterministic-phantom-Request" class="auto internal xref">Appendix D</a>).<a href="#section-12-5" class="pilcrow">¶</a></p>
<p id="section-12-6">Details on the additional message exchange and processing are defined in <a href="#intermediaries-e2e-security-processing" class="auto internal xref">Section 12.2</a>.<a href="#section-12-6" class="pilcrow">¶</a></p>
<div id="ltmr-option">
<section id="section-12.1">
        <h3 id="name-listen-to-multicast-respons">
<a href="#section-12.1" class="section-number selfRef">12.1. </a><a href="#name-listen-to-multicast-respons" class="section-name selfRef">Listen-To-Multicast-Responses Option</a>
        </h3>
<p id="section-12.1-1">In order to allow the proxy to listen to the multicast notifications sent by the server, a new CoAP option is introduced. This option <span class="bcp14">MUST</span> be supported by clients interested to take part in group observations through intermediaries, and by proxies that collect multicast notifications and forward them back to the observer clients.<a href="#section-12.1-1" class="pilcrow">¶</a></p>
<p id="section-12.1-2">The option is called Listen-To-Multicast-Response, is intended only for requests, and has the properties summarized in <a href="#ltmr-table" class="auto internal xref">Table 2</a>, which extends Table 4 of <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>. The option is critical and not Safe-to-Forward. Since the option is not Safe-to-Forward, the column "N" indicates a dash for "not applicable".<a href="#section-12.1-2" class="pilcrow">¶</a></p>
<span id="name-the-listen-to-multicast-res"></span><div id="ltmr-table">
<table class="center" id="table-2">
          <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-the-listen-to-multicast-res" class="selfRef">The Listen-To-Multicast-Responses Option. C=Critical, U=Unsafe, N=NoCacheKey, R=Repeatable</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">No.</th>
              <th class="text-left" rowspan="1" colspan="1">C</th>
              <th class="text-left" rowspan="1" colspan="1">U</th>
              <th class="text-left" rowspan="1" colspan="1">N</th>
              <th class="text-left" rowspan="1" colspan="1">R</th>
              <th class="text-left" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">Format</th>
              <th class="text-left" rowspan="1" colspan="1">Length</th>
              <th class="text-left" rowspan="1" colspan="1">Default</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">TBD</td>
              <td class="text-left" rowspan="1" colspan="1">x</td>
              <td class="text-left" rowspan="1" colspan="1">x</td>
              <td class="text-left" rowspan="1" colspan="1">-</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">Listen-To-<br>Multicast-Responses</td>
              <td class="text-left" rowspan="1" colspan="1">(*)</td>
              <td class="text-left" rowspan="1" colspan="1">3-1024</td>
              <td class="text-left" rowspan="1" colspan="1">(none)</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-12.1-4">The Listen-To-Multicast-Responses Option includes the byte serialization of a CBOR array. This specifies transport-specific message information required for listening to the multicast notifications of a group observation, and intended to the proxy adjacent to the origin server sending those notifications. In particular, the serialized CBOR array has the same format specified in <a href="#sssec-transport-specific-encoding" class="auto internal xref">Section 4.2.1</a> for the 'tp_info' parameter of the informative response defined in <a href="#ssec-server-side-informative" class="auto internal xref">Section 4.2</a>.<a href="#section-12.1-4" class="pilcrow">¶</a></p>
<p id="section-12.1-5">The Listen-To-Multicast-Responses Option is of class U for OSCORE <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span><span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>.<a href="#section-12.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="intermediaries-e2e-security-processing">
<section id="section-12.2">
        <h3 id="name-message-processing">
<a href="#section-12.2" class="section-number selfRef">12.2. </a><a href="#name-message-processing" class="section-name selfRef">Message Processing</a>
        </h3>
<p id="section-12.2-1">Compared to <a href="#intermediaries" class="auto internal xref">Section 11</a>, the following additions apply when informative responses are protected end-to-end between the origin server and the origin clients.<a href="#section-12.2-1" class="pilcrow">¶</a></p>
<p id="section-12.2-2">After the origin server sends an informative response, each proxy simply forwards it back to the (previous hop towards the) origin client that has sent the observation request.<a href="#section-12.2-2" class="pilcrow">¶</a></p>
<p id="section-12.2-3">Once received the informative response, the origin client proceeds in a different way than in <a href="#ssec-client-side-informative-oscore" class="auto internal xref">Section 9.3.1</a>:<a href="#section-12.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.2-4.1">
            <p id="section-12.2-4.1.1">The client performs all the additional decryption and verification steps of <a href="#ssec-client-side-informative-oscore" class="auto internal xref">Section 9.3.1</a> on the phantom request specified in the 'ph_req' parameter and on the last notification specified in the 'last_notif' parameter (if present).<a href="#section-12.2-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.2-4.2">
            <p id="section-12.2-4.2.1">The client builds a ticket request (see Appendix B of <span>[<a href="#I-D.amsuess-core-cachable-oscore" class="cite xref">I-D.amsuess-core-cachable-oscore</a>]</span>), as intended to reach the proxy adjacent to the origin server. The ticket request is formatted as follows.<a href="#section-12.2-4.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.2-4.2.2.1">
                <p id="section-12.2-4.2.2.1.1">The Token is chosen as the client sees fit. In fact, there is no reason for this Token to be the same as the phantom request's.<a href="#section-12.2-4.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-12.2-4.2.2.2">
                <p id="section-12.2-4.2.2.2.1">The outer Code field, the outer CoAP options, and the encrypted payload with AEAD tag (protecting the inner Code, the inner CoAP options, and the possible plain CoAP payload) concatenated with the signature are the same of the phantom request used for the group observation. That is, they are as specified in the 'ph_req' parameter of the received informative response.<a href="#section-12.2-4.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-12.2-4.2.2.3">
                <p id="section-12.2-4.2.2.3.1">An outer Observe Option is included and set to 0 (register). This will usually be set in the phantom request already.<a href="#section-12.2-4.2.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-12.2-4.2.2.4">
                <p id="section-12.2-4.2.2.4.1">The client includes: the outer option Proxy-Uri or Proxy-Cri <span>[<a href="#I-D.ietf-core-href" class="cite xref">I-D.ietf-core-href</a>]</span>; or the outer options (Uri-Host, Uri-Port), together with the outer option Proxy-Scheme or Proxy-Scheme-Number <span>[<a href="#I-D.ietf-core-href" class="cite xref">I-D.ietf-core-href</a>]</span>. These options are set in order to specify the same request URI of the original registration request sent by the client.<a href="#section-12.2-4.2.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-12.2-4.2.2.5">
                <p id="section-12.2-4.2.2.5.1">The new option Listen-To-Multicast-Responses is included as an outer option. The value is set to the byte serialization of the CBOR array specified by the 'tp_info' parameter of the informative response.<a href="#section-12.2-4.2.2.5.1" class="pilcrow">¶</a></p>
<p id="section-12.2-4.2.2.5.2">
Note that, except for transport-specific information such as the Token and Message ID values, every different client participating in the same group observation (hence rebuilding the same phantom request) will build the same ticket request.<a href="#section-12.2-4.2.2.5.2" class="pilcrow">¶</a></p>
<p id="section-12.2-4.2.2.5.3">
Note also that, identically to the phantom request, the ticket request is still protected with Group OSCORE, i.e., it has the same OSCORE Option, encrypted payload, and signature.<a href="#section-12.2-4.2.2.5.3" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<p id="section-12.2-5">Then, the client sends the ticket request to the next hop towards the origin server. Every proxy in the chain forwards the ticket request to the next hop towards the origin server, until the last proxy in the chain is reached. This last proxy, adjacent to the origin server, proceeds as follows.<a href="#section-12.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.2-6.1">
            <p id="section-12.2-6.1.1">The proxy <span class="bcp14">MUST NOT</span> further forward the ticket request to the origin server.<a href="#section-12.2-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.2-6.2">
            <p id="section-12.2-6.2.1">The proxy removes the option Proxy-Uri, or Proxy-Scheme, or Proxy-Cri, or Proxy-Scheme-Number from the ticket request.<a href="#section-12.2-6.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.2-6.3">
            <p id="section-12.2-6.3.1">The proxy removes the Listen-To-Multicast-Responses Option from the ticket request, and extracts the transport-specific information conveyed therein.<a href="#section-12.2-6.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.2-6.4">
            <p id="section-12.2-6.4.1">The proxy rebuilds the phantom request associated with the group observation, by using the ticket request as directly providing the required transport-independent information. This includes the outer Code field, the outer CoAP options, and the encrypted payload with AEAD tag concatenated with the signature.<a href="#section-12.2-6.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.2-6.5">
            <p id="section-12.2-6.5.1">The proxy configures an observation of the target resource at the origin server, acting as a client directly taking part in the group observation. To this end, the proxy uses the rebuilt phantom request and the transport-specific information retrieved from the Listen-To-Multicast-Responses Option. The particular way to achieve this is implementation specific.<a href="#section-12.2-6.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-12.2-7">After that, the proxy listens to the IP multicast address and port number indicated in the Listen-To-Multicast-Responses Option, i.e., per the CRI specified by a dedicated element of 'tpi_details' within the serialized CBOR array conveyed in the option. In particular, when transporting CoAP over UDP, the CRI is conveyed by the element 'tpi_client' (see <a href="#ssssec-udp-transport-specific" class="auto internal xref">Section 4.2.1.1</a>).<a href="#section-12.2-7" class="pilcrow">¶</a></p>
<p id="section-12.2-8">Furthermore, multicast notifications will match the phantom request stored at the proxy, based on the Token value specified by a dedicated element of 'tpi_details' within the serialized CBOR array conveyed in the Listen-To-Multicast-Responses Option. In particular, when transporting CoAP over UDP, the Token value is specified by the element 'tpi_token' (see <a href="#ssssec-udp-transport-specific" class="auto internal xref">Section 4.2.1.1</a>).<a href="#section-12.2-8" class="pilcrow">¶</a></p>
<p id="section-12.2-9">An example is provided in <a href="#intermediaries-example-e2e-security" class="auto internal xref">Appendix F</a>.<a href="#section-12.2-9" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="informative-response-params">
<section id="section-13">
      <h2 id="name-informative-response-parame">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-informative-response-parame" class="section-name selfRef">Informative Response Parameters</a>
      </h2>
<p id="section-13-1">This document defines a number of fields used in the informative response defined in <a href="#ssec-server-side-informative" class="auto internal xref">Section 4.2</a>.<a href="#section-13-1" class="pilcrow">¶</a></p>
<p id="section-13-2">The table below summarizes them and specifies the CBOR key to use as abbreviation, instead of the full descriptive name. Note that the media type "application/informative-response+cbor" <span class="bcp14">MUST</span> be used when these fields are transported.<a href="#section-13-2" class="pilcrow">¶</a></p>
<span id="name-informative-response-paramet"></span><div id="_table-informative-response-params">
<table class="center" id="table-3">
        <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-informative-response-paramet" class="selfRef">Informative Response Parameters.</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Name</th>
            <th class="text-left" rowspan="1" colspan="1">CBOR Key</th>
            <th class="text-left" rowspan="1" colspan="1">CBOR Type</th>
            <th class="text-left" rowspan="1" colspan="1">Reference</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">tp_info</td>
            <td class="text-left" rowspan="1" colspan="1">0</td>
            <td class="text-left" rowspan="1" colspan="1">array</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#ssec-server-side-informative" class="auto internal xref">Section 4.2</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">ph_req</td>
            <td class="text-left" rowspan="1" colspan="1">1</td>
            <td class="text-left" rowspan="1" colspan="1">byte string</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#ssec-server-side-informative" class="auto internal xref">Section 4.2</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">last_notif</td>
            <td class="text-left" rowspan="1" colspan="1">2</td>
            <td class="text-left" rowspan="1" colspan="1">byte string</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#ssec-server-side-informative" class="auto internal xref">Section 4.2</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">next_not_before</td>
            <td class="text-left" rowspan="1" colspan="1">3</td>
            <td class="text-left" rowspan="1" colspan="1">unsigned integer</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#ssec-server-side-informative" class="auto internal xref">Section 4.2</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">ending</td>
            <td class="text-left" rowspan="1" colspan="1">4</td>
            <td class="text-left" rowspan="1" colspan="1">unsigned integer</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#ssec-server-side-informative" class="auto internal xref">Section 4.2</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">join_uri</td>
            <td class="text-left" rowspan="1" colspan="1">5</td>
            <td class="text-left" rowspan="1" colspan="1">text string</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#sec-inf-response" class="auto internal xref">Section 9.1</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">sec_gp</td>
            <td class="text-left" rowspan="1" colspan="1">6</td>
            <td class="text-left" rowspan="1" colspan="1">text string</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#sec-inf-response" class="auto internal xref">Section 9.1</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">as_uri</td>
            <td class="text-left" rowspan="1" colspan="1">7</td>
            <td class="text-left" rowspan="1" colspan="1">text string</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#sec-inf-response" class="auto internal xref">Section 9.1</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">hkdf</td>
            <td class="text-left" rowspan="1" colspan="1">8</td>
            <td class="text-left" rowspan="1" colspan="1">integer or text string</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#sec-inf-response" class="auto internal xref">Section 9.1</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">cred_fmt</td>
            <td class="text-left" rowspan="1" colspan="1">9</td>
            <td class="text-left" rowspan="1" colspan="1">integer</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#sec-inf-response" class="auto internal xref">Section 9.1</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">gp_enc_alg</td>
            <td class="text-left" rowspan="1" colspan="1">10</td>
            <td class="text-left" rowspan="1" colspan="1">integer or text string</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#sec-inf-response" class="auto internal xref">Section 9.1</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">sign_alg</td>
            <td class="text-left" rowspan="1" colspan="1">11</td>
            <td class="text-left" rowspan="1" colspan="1">integer or text string</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#sec-inf-response" class="auto internal xref">Section 9.1</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">sign_params</td>
            <td class="text-left" rowspan="1" colspan="1">12</td>
            <td class="text-left" rowspan="1" colspan="1">array</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#sec-inf-response" class="auto internal xref">Section 9.1</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">gp_material</td>
            <td class="text-left" rowspan="1" colspan="1">13</td>
            <td class="text-left" rowspan="1" colspan="1">map</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#self-managed-oscore-group" class="auto internal xref">Appendix C</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">srv_cred</td>
            <td class="text-left" rowspan="1" colspan="1">14</td>
            <td class="text-left" rowspan="1" colspan="1">byte string</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#self-managed-oscore-group" class="auto internal xref">Appendix C</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">srv_identifier</td>
            <td class="text-left" rowspan="1" colspan="1">15</td>
            <td class="text-left" rowspan="1" colspan="1">byte string</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#self-managed-oscore-group" class="auto internal xref">Appendix C</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">exi</td>
            <td class="text-left" rowspan="1" colspan="1">16</td>
            <td class="text-left" rowspan="1" colspan="1">unsigned integer</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#self-managed-oscore-group" class="auto internal xref">Appendix C</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">exp</td>
            <td class="text-left" rowspan="1" colspan="1">17</td>
            <td class="text-left" rowspan="1" colspan="1">unsigned integer</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#self-managed-oscore-group" class="auto internal xref">Appendix C</a>
</td>
          </tr>
        </tbody>
      </table>
</div>
</section>
</div>
<div id="transport-protocol-identifiers">
<section id="section-14">
      <h2 id="name-transport-protocol-informat">
<a href="#section-14" class="section-number selfRef">14. </a><a href="#name-transport-protocol-informat" class="section-name selfRef">Transport Protocol Information</a>
      </h2>
<p id="section-14-1"><a href="#ssssec-udp-transport-specific" class="auto internal xref">Section 4.2.1.1</a> defines the transport-specific information that the server has to specify as elements of 'tpi_details' within the 'tp_info' parameter of the informative response defined in <a href="#ssec-server-side-informative" class="auto internal xref">Section 4.2</a>, when CoAP responses are transported over UDP.<a href="#section-14-1" class="pilcrow">¶</a></p>
<p id="section-14-2"><a href="#_table-transport-information" class="auto internal xref">Table 4</a> defines the corresponding entry that <a href="#iana-coap-transport-information" class="auto internal xref">Section 16.5</a> registers in the "CoAP Transport Information" registry defined in this document.<a href="#section-14-2" class="pilcrow">¶</a></p>
<span id="name-coap-transport-information-"></span><div id="_table-transport-information">
<table class="center" id="table-4">
        <caption>
<a href="#table-4" class="selfRef">Table 4</a>:
<a href="#name-coap-transport-information-" class="selfRef">CoAP Transport Information for CoAP over UDP.</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Scheme ID</th>
            <th class="text-left" rowspan="1" colspan="1">URI Scheme Name</th>
            <th class="text-left" rowspan="1" colspan="1">Transport Information Details</th>
            <th class="text-left" rowspan="1" colspan="1">Reference</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">-1</td>
            <td class="text-left" rowspan="1" colspan="1">coap</td>
            <td class="text-left" rowspan="1" colspan="1">tpi_client <br> tpi_token</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#ssssec-udp-transport-specific" class="auto internal xref">Section 4.2.1.1</a> of [RFC-XXXX]</td>
          </tr>
        </tbody>
      </table>
</div>
<p id="section-14-4">Note to RFC Editor: In the table above, please replace "[RFC-XXXX]" with the RFC number of this specification and delete this paragraph.<a href="#section-14-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-security-considerations">
<section id="section-15">
      <h2 id="name-security-considerations">
<a href="#section-15" class="section-number selfRef">15. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-15-1">In addition to the security considerations from <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>, <span>[<a href="#RFC7641" class="cite xref">RFC7641</a>]</span>, <span>[<a href="#I-D.ietf-core-groupcomm-bis" class="cite xref">I-D.ietf-core-groupcomm-bis</a>]</span>, <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>, and <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>, the following considerations hold for this document.<a href="#section-15-1" class="pilcrow">¶</a></p>
<div id="unprotected-communications">
<section id="section-15.1">
        <h3 id="name-unprotected-communications">
<a href="#section-15.1" class="section-number selfRef">15.1. </a><a href="#name-unprotected-communications" class="section-name selfRef">Unprotected Communications</a>
        </h3>
<p id="section-15.1-1">In case communications are not protected, the server might not be able to effectively authenticate a new client when it registers as an observer. <span><a href="https://rfc-editor.org/rfc/rfc7641#section-7" class="relref">Section 7</a> of [<a href="#RFC7641" class="cite xref">RFC7641</a>]</span> specifies how, in such a case, the server must strictly limit the number of notifications sent between receiving acknowledgements from the client, as confirming to be still interested in the observation; i.e., any notifications sent in Non-confirmable messages must be interspersed with confirmable messages.<a href="#section-15.1-1" class="pilcrow">¶</a></p>
<p id="section-15.1-2">This is not possible to achieve by the same means when using the communication model defined in this document, since multicast notifications are sent as Non-confirmable messages. Nonetheless, the server might obtain such acknowledgements by other means.<a href="#section-15.1-2" class="pilcrow">¶</a></p>
<p id="section-15.1-3">For instance, the method defined in <a href="#sec-rough-counting" class="auto internal xref">Section 8</a> to perform the rough counting of still interested clients triggers (some of) them to explicitly send a new observation request to acknowledge their interest. Then, the server can decide to terminate the group observation altogether, in case not enough clients are estimated to be still active.<a href="#section-15.1-3" class="pilcrow">¶</a></p>
<p id="section-15.1-4">If the method defined in <a href="#sec-rough-counting" class="auto internal xref">Section 8</a> is used, the server <span class="bcp14">SHOULD NOT</span> send more than a strict number of multicast notifications for a given group observation, without having first performed a new rough counting of active clients. Note that, when using the method defined in <a href="#sec-rough-counting" class="auto internal xref">Section 8</a> with unprotected communications, an adversary can craft and inject multiple new observation requests including the Multicast-Response-Feedback-Divider Option, hence inducing the server to overestimate the number of still interested clients, and thus to inappropriately continue the group observation.<a href="#section-15.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="protected-communications">
<section id="section-15.2">
        <h3 id="name-protected-communications">
<a href="#section-15.2" class="section-number selfRef">15.2. </a><a href="#name-protected-communications" class="section-name selfRef">Protected Communications</a>
        </h3>
<p id="section-15.2-1">If multicast notifications for an observed resource are protected using Group OSCORE as per <a href="#sec-secured-notifications" class="auto internal xref">Section 9</a>, it is ensured that those are securely bound to the phantom registration request that started the group observation of that resource. Furthermore, the following applies.<a href="#section-15.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-15.2-2.1">
            <p id="section-15.2-2.1.1">The original registration requests and related unicast (notification) responses <span class="bcp14">MUST</span> also be protected, including and especially the informative responses from the server. An exception is the case discussed in <a href="#deterministic-phantom-Request" class="auto internal xref">Appendix D</a>, where the informative response from the server is not protected.<a href="#section-15.2-2.1.1" class="pilcrow">¶</a></p>
<p id="section-15.2-2.1.2">
Protecting informative responses from the server prevents on-path active adversaries from altering the conveyed IP multicast address and serialized phantom registration request.<a href="#section-15.2-2.1.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-15.2-2.2">
            <p id="section-15.2-2.2.1">A re-registration request, possibly including the Multicast-Response-Feedback-Divider Option to support the rough counting of clients (see <a href="#sec-rough-counting" class="auto internal xref">Section 8</a>), <span class="bcp14">MUST</span> also be protected.<a href="#section-15.2-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-security-considerations-ltmr">
<section id="section-15.3">
        <h3 id="name-listen-to-multicast-response">
<a href="#section-15.3" class="section-number selfRef">15.3. </a><a href="#name-listen-to-multicast-response" class="section-name selfRef">Listen-To-Multicast-Responses Option</a>
        </h3>
<p id="section-15.3-1">The CoAP option Listen-To-Multicast-Responses defined in <a href="#ltmr-option" class="auto internal xref">Section 12.1</a> is of class U for OSCORE and Group OSCORE <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span><span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>.<a href="#section-15.3-1" class="pilcrow">¶</a></p>
<p id="section-15.3-2">This allows the proxy adjacent to the origin server to access the option value conveyed in a ticket request (see <a href="#intermediaries-e2e-security-processing" class="auto internal xref">Section 12.2</a>), and to retrieve from it the transport-specific information about a phantom request. By doing so, the proxy becomes able to configure an observation of the target resource and to receive multicast notifications that match the phantom request.<a href="#section-15.3-2" class="pilcrow">¶</a></p>
<p id="section-15.3-3">Any proxy in the chain, as well as further possible intermediaries or on-path active adversaries, are thus able to remove the option or alter its content, before the ticket request reaches the proxy adjacent to the origin server.<a href="#section-15.3-3" class="pilcrow">¶</a></p>
<p id="section-15.3-4">Removing the option would result in the proxy adjacent to the origin server to not configure the group observation, if that has not happened yet. In such a case, the proxy would not receive the corresponding multicast notifications to be forwarded back to the clients.<a href="#section-15.3-4" class="pilcrow">¶</a></p>
<p id="section-15.3-5">Altering the option content would result in the proxy adjacent to the origin server to incorrectly configure a group observation (e.g., as based on a wrong multicast IP address) hence preventing the correct reception of multicast notifications and their forwarding to the clients; or to configure bogus group observations that are currently not active on the origin server.<a href="#section-15.3-5" class="pilcrow">¶</a></p>
<p id="section-15.3-6">In order to prevent what is described above, the ticket requests conveying the Listen-To-Multicast-Responses Option can be additionally protected hop-by-hop, e.g., by using OSCORE (see <span>[<a href="#I-D.ietf-core-oscore-capable-proxies" class="cite xref">I-D.ietf-core-oscore-capable-proxies</a>]</span>) and/or DTLS <span>[<a href="#RFC9147" class="cite xref">RFC9147</a>]</span>.<a href="#section-15.3-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana">
<section id="section-16">
      <h2 id="name-iana-considerations">
<a href="#section-16" class="section-number selfRef">16. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-16-1">This document has the following actions for IANA.<a href="#section-16-1" class="pilcrow">¶</a></p>
<p id="section-16-2">Note to RFC Editor: Please replace all occurrences of "[RFC-XXXX]" with the RFC number of this specification and delete this paragraph.<a href="#section-16-2" class="pilcrow">¶</a></p>
<div id="media-type">
<section id="section-16.1">
        <h3 id="name-media-type-registrations">
<a href="#section-16.1" class="section-number selfRef">16.1. </a><a href="#name-media-type-registrations" class="section-name selfRef">Media Type Registrations</a>
        </h3>
<p id="section-16.1-1">This document registers the media type "application/informative-response+cbor" for error messages as informative response defined in <a href="#ssec-server-side-informative" class="auto internal xref">Section 4.2</a>, when carrying parameters encoded in CBOR. This registration follows the procedures specified in <span>[<a href="#RFC6838" class="cite xref">RFC6838</a>]</span>.<a href="#section-16.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-16.1-2.1">
            <p id="section-16.1-2.1.1">Type name: application<a href="#section-16.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.1-2.2">
            <p id="section-16.1-2.2.1">Subtype name: informative-response+cbor<a href="#section-16.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.1-2.3">
            <p id="section-16.1-2.3.1">Required parameters: N/A<a href="#section-16.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.1-2.4">
            <p id="section-16.1-2.4.1">Optional parameters: N/A<a href="#section-16.1-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.1-2.5">
            <p id="section-16.1-2.5.1">Encoding considerations: Must be encoded as a CBOR map containing the parameters defined in <a href="#ssec-server-side-informative" class="auto internal xref">Section 4.2</a> of [RFC-XXXX].<a href="#section-16.1-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.1-2.6">
            <p id="section-16.1-2.6.1">Security considerations: See <a href="#sec-security-considerations" class="auto internal xref">Section 15</a> of [RFC-XXXX].<a href="#section-16.1-2.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.1-2.7">
            <p id="section-16.1-2.7.1">Interoperability considerations: N/A<a href="#section-16.1-2.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.1-2.8">
            <p id="section-16.1-2.8.1">Published specification: [RFC-XXXX]<a href="#section-16.1-2.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.1-2.9">
            <p id="section-16.1-2.9.1">Applications that use this media type: The type is used by CoAP servers and clients that support error messages as informative response defined in <a href="#ssec-server-side-informative" class="auto internal xref">Section 4.2</a> of [RFC-XXXX].<a href="#section-16.1-2.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.1-2.10">
            <p id="section-16.1-2.10.1">Fragment identifier considerations: N/A<a href="#section-16.1-2.10.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.1-2.11">
            <p id="section-16.1-2.11.1">Additional information: N/A<a href="#section-16.1-2.11.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.1-2.12">
            <p id="section-16.1-2.12.1">Person &amp; email address to contact for further information: CoRE WG mailing list (core@ietf.org) or IETF Applications and Real-Time Area (art@ietf.org)<a href="#section-16.1-2.12.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.1-2.13">
            <p id="section-16.1-2.13.1">Intended usage: COMMON<a href="#section-16.1-2.13.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.1-2.14">
            <p id="section-16.1-2.14.1">Restrictions on usage: None<a href="#section-16.1-2.14.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.1-2.15">
            <p id="section-16.1-2.15.1">Author/Change controller: IETF<a href="#section-16.1-2.15.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.1-2.16">
            <p id="section-16.1-2.16.1">Provisional registration:  No<a href="#section-16.1-2.16.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="content-format">
<section id="section-16.2">
        <h3 id="name-coap-content-formats-regist">
<a href="#section-16.2" class="section-number selfRef">16.2. </a><a href="#name-coap-content-formats-regist" class="section-name selfRef">CoAP Content-Formats Registry</a>
        </h3>
<p id="section-16.2-1">IANA is asked to add the following entry to the "CoAP Content-Formats" registry within the "Constrained RESTful Environments (CoRE) Parameters" registry group.<a href="#section-16.2-1" class="pilcrow">¶</a></p>
<p id="section-16.2-2">Content Type: application/informative-response+cbor<a href="#section-16.2-2" class="pilcrow">¶</a></p>
<p id="section-16.2-3">Content Coding: -<a href="#section-16.2-3" class="pilcrow">¶</a></p>
<p id="section-16.2-4">ID: TBD (value between 0 and 255)<a href="#section-16.2-4" class="pilcrow">¶</a></p>
<p id="section-16.2-5">Reference: [RFC-XXXX]<a href="#section-16.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-coap-options">
<section id="section-16.3">
        <h3 id="name-coap-option-numbers-registr">
<a href="#section-16.3" class="section-number selfRef">16.3. </a><a href="#name-coap-option-numbers-registr" class="section-name selfRef">CoAP Option Numbers Registry</a>
        </h3>
<p id="section-16.3-1">IANA is asked to enter the following option numbers to the "CoAP Option Numbers" registry within the "Constrained RESTful Environments (CoRE) Parameters" registry group.<a href="#section-16.3-1" class="pilcrow">¶</a></p>
<span id="name-registrations-in-the-coap-o"></span><table class="center" id="table-5">
          <caption>
<a href="#table-5" class="selfRef">Table 5</a>:
<a href="#name-registrations-in-the-coap-o" class="selfRef">Registrations in the CoAP Option Numbers Registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Number</th>
              <th class="text-left" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">TBD</td>
              <td class="text-left" rowspan="1" colspan="1">Multicast-Response-Feedback-Divider</td>
              <td class="text-left" rowspan="1" colspan="1">[RFC-XXXX]</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">TBD</td>
              <td class="text-left" rowspan="1" colspan="1">Listen-To-Multicast-Responses</td>
              <td class="text-left" rowspan="1" colspan="1">[RFC-XXXX]</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="iana-informative-response-params">
<section id="section-16.4">
        <h3 id="name-informative-response-paramete">
<a href="#section-16.4" class="section-number selfRef">16.4. </a><a href="#name-informative-response-paramete" class="section-name selfRef">Informative Response Parameters Registry</a>
        </h3>
<p id="section-16.4-1">This document establishes the "Informative Response Parameters" registry within the "Constrained RESTful Environments (CoRE) Parameters" registry group.<a href="#section-16.4-1" class="pilcrow">¶</a></p>
<p id="section-16.4-2">The registration policy is either "Private Use", "Standards Action with Expert Review", or "Specification Required" or "Expert Review" per <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>. "Expert Review" guidelines are provided in <a href="#iana-review" class="auto internal xref">Section 16.7</a>.<a href="#section-16.4-2" class="pilcrow">¶</a></p>
<p id="section-16.4-3">All assignments according to "Standards Action with Expert Review" are made on a "Standards Action" basis per <span><a href="https://rfc-editor.org/rfc/rfc8126#section-4.9" class="relref">Section 4.9</a> of [<a href="#RFC8126" class="cite xref">RFC8126</a>]</span> with "Expert Review" additionally required per <span><a href="https://rfc-editor.org/rfc/rfc8126#section-4.5" class="relref">Section 4.5</a> of [<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>. The procedure for early IANA allocation of "standards track code points" defined in <span>[<a href="#RFC7120" class="cite xref">RFC7120</a>]</span> also applies. When such a procedure is used, IANA will ask the designated expert(s) to approve the early allocation before registration. In addition, working group chairs are encouraged to consult the expert(s) early during the process outlined in <span><a href="https://rfc-editor.org/rfc/rfc7120#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC7120" class="cite xref">RFC7120</a>]</span>.<a href="#section-16.4-3" class="pilcrow">¶</a></p>
<p id="section-16.4-4">The columns of this registry are:<a href="#section-16.4-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-16.4-5.1">
            <p id="section-16.4-5.1.1">Name: This is a descriptive name that enables easier reference to the item. The name <span class="bcp14">MUST</span> be unique. It is not used in the encoding.<a href="#section-16.4-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.4-5.2">
            <p id="section-16.4-5.2.1">CBOR Key: This is the value used as the CBOR map key of the item. These values <span class="bcp14">MUST</span> be unique. The value can be a positive integer, a negative integer, or a text string. Different ranges of values use different registration policies <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>. Integer values from -256 to 255 as well as text strings of length 1 are designated as "Standards Action With Expert Review". Integer values from -65536 to -257 and from 256 to 65535 as well as text strings of length 2 are designated as "Specification Required". Integer values greater than 65535 as well as text strings of length greater than 2 are designated as "Expert Review". Integer values less than -65536 are marked as "Private Use".<a href="#section-16.4-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.4-5.3">
            <p id="section-16.4-5.3.1">CBOR Type: This contains the CBOR type of the item, or a pointer to the registry that defines its type, when that depends on another item.<a href="#section-16.4-5.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.4-5.4">
            <p id="section-16.4-5.4.1">Reference: This contains a pointer to the public specification for the item.<a href="#section-16.4-5.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-16.4-6">This registry has been initially populated by the entries in <a href="#_table-informative-response-params" class="auto internal xref">Table 3</a>. The "Reference" column for all of those entries refers to sections of this document.<a href="#section-16.4-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-coap-transport-information">
<section id="section-16.5">
        <h3 id="name-coap-transport-information-r">
<a href="#section-16.5" class="section-number selfRef">16.5. </a><a href="#name-coap-transport-information-r" class="section-name selfRef">CoAP Transport Information Registry</a>
        </h3>
<p id="section-16.5-1">This document establishes the "CoAP Transport Information" registry within the "Constrained RESTful Environments (CoRE) Parameters" registry group.<a href="#section-16.5-1" class="pilcrow">¶</a></p>
<p id="section-16.5-2">The registration policy is "Expert Review" <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>. "Expert Review" guidelines are provided in <a href="#iana-review" class="auto internal xref">Section 16.7</a>.<a href="#section-16.5-2" class="pilcrow">¶</a></p>
<p id="section-16.5-3">The columns of this registry are:<a href="#section-16.5-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-16.5-4.1">
            <p id="section-16.5-4.1.1">Scheme ID: This field contains the value used as 'scheme-id' to identify a CRI scheme, per <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-href-18#section-5.1.1" class="relref">Section 5.1.1</a> of [<a href="#I-D.ietf-core-href" class="cite xref">I-D.ietf-core-href</a>]</span>. The value is a negative integer and <span class="bcp14">MUST</span> be unique.<a href="#section-16.5-4.1.1" class="pilcrow">¶</a></p>
<p id="section-16.5-4.1.2">
As a pre-condition for registering a value ID, it is <span class="bcp14">REQUIRED</span> that the "CRI Scheme Numbers" registry defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-href-18#section-11.1" class="relref">Section 11.1</a> of [<a href="#I-D.ietf-core-href" class="cite xref">I-D.ietf-core-href</a>]</span> includes an entry where the value in the column "CRI scheme number" is (-1 - ID).<a href="#section-16.5-4.1.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.5-4.2">
            <p id="section-16.5-4.2.1">URI Scheme Name: This field contains a text string. Its value is the name of the URI scheme that corresponds to the CRI scheme identified by the value of the "Scheme ID" field in the present entry.<a href="#section-16.5-4.2.1" class="pilcrow">¶</a></p>
<p id="section-16.5-4.2.2">
Given the value ID of the "Scheme ID" field in the present entry, then the value of the "URI Scheme Name" field <span class="bcp14">MUST</span> be the same as in the column "URI scheme name" of the entry of the "CRI Scheme Numbers" registry where the value in the column "CRI scheme number" is (-1 - ID).<a href="#section-16.5-4.2.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.5-4.3">
            <p id="section-16.5-4.3.1">Transport Information Details: This field contains a lists of text strings. Each text string is the name of an element that provides transport-specific information related to a pertinent CoAP request. Optional elements are prepended by '?', and <span class="bcp14">MUST</span> be specified next to each other as last ones.<a href="#section-16.5-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.5-4.4">
            <p id="section-16.5-4.4.1">Reference: This contains a pointer to the public specification for the item.<a href="#section-16.5-4.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-16.5-5">This registry has been initially populated by the entry in <a href="#_table-transport-information" class="auto internal xref">Table 4</a>.<a href="#section-16.5-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-target-attributes">
<section id="section-16.6">
        <h3 id="name-target-attributes-registry">
<a href="#section-16.6" class="section-number selfRef">16.6. </a><a href="#name-target-attributes-registry" class="section-name selfRef">Target Attributes Registry</a>
        </h3>
<p id="section-16.6-1">IANA is asked to register the following entry in the "Target Attributes" registry within the "Constrained RESTful Environments (CoRE) Parameters" registry group.<a href="#section-16.6-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-16.6-2.1">
            <p id="section-16.6-2.1.1">Attribute Name: gp-obs<a href="#section-16.6-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.6-2.2">
            <p id="section-16.6-2.2.1">Brief Description: Observable resource supporting group observation<a href="#section-16.6-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.6-2.3">
            <p id="section-16.6-2.3.1">Change Controller: IETF<a href="#section-16.6-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.6-2.4">
            <p id="section-16.6-2.4.1">Reference: <a href="#sec-web-linking" class="auto internal xref">Section 6</a> of [RFC-XXXX]<a href="#section-16.6-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="iana-review">
<section id="section-16.7">
        <h3 id="name-expert-review-instructions">
<a href="#section-16.7" class="section-number selfRef">16.7. </a><a href="#name-expert-review-instructions" class="section-name selfRef">Expert Review Instructions</a>
        </h3>
<p id="section-16.7-1">"Standards Action with Expert Review", "Specification Required", and "Expert Review" are three of the registration policies defined for the IANA registries established in this document. This section gives some general guidelines for what the experts should be looking for, but they are being designated as experts for a reason, so they should be given substantial latitude.<a href="#section-16.7-1" class="pilcrow">¶</a></p>
<p id="section-16.7-2">Expert reviewers should take into consideration the following points:<a href="#section-16.7-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-16.7-3.1">
            <p id="section-16.7-3.1.1">Point squatting should be discouraged. Reviewers are encouraged to get sufficient information for registration requests to ensure that the usage is not going to duplicate one that is already registered and that the point is likely to be used in deployments. The zones tagged as "Private Use" are intended for testing purposes and closed environments. Code points in other ranges should not be assigned for testing.<a href="#section-16.7-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.7-3.2">
            <p id="section-16.7-3.2.1">Specifications are required for the "Standards Action With Expert Review" range of point assignment. Specifications should exist for "Specification Required" ranges, but early assignment before a specification is available is considered to be permissible. When specifications are not provided, the description provided needs to have sufficient information to identify what the point is being used for.<a href="#section-16.7-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.7-3.3">
            <p id="section-16.7-3.3.1">Experts should take into account the expected usage of fields when approving point assignment. Documents published via Standards Action can also register points outside the Standards Action range. The length of the encoded value should be weighed against how many code points of that length are left, the size of device it will be used on, and the number of code points left that encode to that size.<a href="#section-16.7-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="sec-combined-references">
<section id="section-17">
      <h2 id="name-references">
<a href="#section-17" class="section-number selfRef">17. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-17.1">
        <h3 id="name-normative-references">
<a href="#section-17.1" class="section-number selfRef">17.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="COSE.Algorithms">[COSE.Algorithms]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"COSE Algorithms"</span>, <span>&lt;<a href="https://www.iana.org/assignments/cose/cose.xhtml#algorithms">https://www.iana.org/assignments/cose/cose.xhtml#algorithms</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="COSE.Header.Parameters">[COSE.Header.Parameters]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"COSE Header Parameters"</span>, <span>&lt;<a href="https://www.iana.org/assignments/cose/cose.xhtml#header-parameters">https://www.iana.org/assignments/cose/cose.xhtml#header-parameters</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="COSE.Key.Types">[COSE.Key.Types]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"COSE Key Types"</span>, <span>&lt;<a href="https://www.iana.org/assignments/cose/cose.xhtml#key-type">https://www.iana.org/assignments/cose/cose.xhtml#key-type</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-ace-key-groupcomm-oscore">[I-D.ietf-ace-key-groupcomm-oscore]</dt>
        <dd>
<span class="refAuthor">Tiloca, M.</span>, <span class="refAuthor">Park, J.</span>, and <span class="refAuthor">F. Palombini</span>, <span class="refTitle">"Key Management for OSCORE Groups in ACE"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-key-groupcomm-oscore-16</span>, <time datetime="2023-03-06" class="refDate">6 March 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-oscore-16">https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-oscore-16</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-groupcomm-bis">[I-D.ietf-core-groupcomm-bis]</dt>
        <dd>
<span class="refAuthor">Dijk, E.</span> and <span class="refAuthor">M. Tiloca</span>, <span class="refTitle">"Group Communication for the Constrained Application Protocol (CoAP)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-groupcomm-bis-13</span>, <time datetime="2025-02-24" class="refDate">24 February 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-groupcomm-bis-13">https://datatracker.ietf.org/doc/html/draft-ietf-core-groupcomm-bis-13</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-href">[I-D.ietf-core-href]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">H. Birkholz</span>, <span class="refTitle">"Constrained Resource Identifiers"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-href-18</span>, <time datetime="2025-02-03" class="refDate">3 February 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-href-18">https://datatracker.ietf.org/doc/html/draft-ietf-core-href-18</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-oscore-groupcomm">[I-D.ietf-core-oscore-groupcomm]</dt>
        <dd>
<span class="refAuthor">Tiloca, M.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Palombini, F.</span>, <span class="refAuthor">Mattsson, J. P.</span>, and <span class="refAuthor">R. Höglund</span>, <span class="refTitle">"Group Object Security for Constrained RESTful Environments (Group OSCORE)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-oscore-groupcomm-24</span>, <time datetime="2025-02-08" class="refDate">8 February 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-24">https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-24</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4944">[RFC4944]</dt>
        <dd>
<span class="refAuthor">Montenegro, G.</span>, <span class="refAuthor">Kushalnagar, N.</span>, <span class="refAuthor">Hui, J.</span>, and <span class="refAuthor">D. Culler</span>, <span class="refTitle">"Transmission of IPv6 Packets over IEEE 802.15.4 Networks"</span>, <span class="seriesInfo">RFC 4944</span>, <span class="seriesInfo">DOI 10.17487/RFC4944</span>, <time datetime="2007-09" class="refDate">September 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4944">https://www.rfc-editor.org/rfc/rfc4944</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6838">[RFC6838]</dt>
        <dd>
<span class="refAuthor">Freed, N.</span>, <span class="refAuthor">Klensin, J.</span>, and <span class="refAuthor">T. Hansen</span>, <span class="refTitle">"Media Type Specifications and Registration Procedures"</span>, <span class="seriesInfo">BCP 13</span>, <span class="seriesInfo">RFC 6838</span>, <span class="seriesInfo">DOI 10.17487/RFC6838</span>, <time datetime="2013-01" class="refDate">January 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6838">https://www.rfc-editor.org/rfc/rfc6838</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7120">[RFC7120]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refTitle">"Early IANA Allocation of Standards Track Code Points"</span>, <span class="seriesInfo">BCP 100</span>, <span class="seriesInfo">RFC 7120</span>, <span class="seriesInfo">DOI 10.17487/RFC7120</span>, <time datetime="2014-01" class="refDate">January 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7120">https://www.rfc-editor.org/rfc/rfc7120</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7252">[RFC7252]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refAuthor">Hartke, K.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"The Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7252</span>, <span class="seriesInfo">DOI 10.17487/RFC7252</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7252">https://www.rfc-editor.org/rfc/rfc7252</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7641">[RFC7641]</dt>
        <dd>
<span class="refAuthor">Hartke, K.</span>, <span class="refTitle">"Observing Resources in the Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7641</span>, <span class="seriesInfo">DOI 10.17487/RFC7641</span>, <time datetime="2015-09" class="refDate">September 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7641">https://www.rfc-editor.org/rfc/rfc7641</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7967">[RFC7967]</dt>
        <dd>
<span class="refAuthor">Bhattacharyya, A.</span>, <span class="refAuthor">Bandyopadhyay, S.</span>, <span class="refAuthor">Pal, A.</span>, and <span class="refAuthor">T. Bose</span>, <span class="refTitle">"Constrained Application Protocol (CoAP) Option for No Server Response"</span>, <span class="seriesInfo">RFC 7967</span>, <span class="seriesInfo">DOI 10.17487/RFC7967</span>, <time datetime="2016-08" class="refDate">August 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7967">https://www.rfc-editor.org/rfc/rfc7967</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8085">[RFC8085]</dt>
        <dd>
<span class="refAuthor">Eggert, L.</span>, <span class="refAuthor">Fairhurst, G.</span>, and <span class="refAuthor">G. Shepherd</span>, <span class="refTitle">"UDP Usage Guidelines"</span>, <span class="seriesInfo">BCP 145</span>, <span class="seriesInfo">RFC 8085</span>, <span class="seriesInfo">DOI 10.17487/RFC8085</span>, <time datetime="2017-03" class="refDate">March 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8085">https://www.rfc-editor.org/rfc/rfc8085</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8126">https://www.rfc-editor.org/rfc/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8288">[RFC8288]</dt>
        <dd>
<span class="refAuthor">Nottingham, M.</span>, <span class="refTitle">"Web Linking"</span>, <span class="seriesInfo">RFC 8288</span>, <span class="seriesInfo">DOI 10.17487/RFC8288</span>, <time datetime="2017-10" class="refDate">October 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8288">https://www.rfc-editor.org/rfc/rfc8288</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8610">[RFC8610]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Vigano, C.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"Concise Data Definition Language (CDDL): A Notational Convention to Express Concise Binary Object Representation (CBOR) and JSON Data Structures"</span>, <span class="seriesInfo">RFC 8610</span>, <span class="seriesInfo">DOI 10.17487/RFC8610</span>, <time datetime="2019-06" class="refDate">June 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8610">https://www.rfc-editor.org/rfc/rfc8610</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8613">[RFC8613]</dt>
        <dd>
<span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Mattsson, J.</span>, <span class="refAuthor">Palombini, F.</span>, and <span class="refAuthor">L. Seitz</span>, <span class="refTitle">"Object Security for Constrained RESTful Environments (OSCORE)"</span>, <span class="seriesInfo">RFC 8613</span>, <span class="seriesInfo">DOI 10.17487/RFC8613</span>, <time datetime="2019-07" class="refDate">July 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8613">https://www.rfc-editor.org/rfc/rfc8613</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8949">[RFC8949]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">STD 94</span>, <span class="seriesInfo">RFC 8949</span>, <span class="seriesInfo">DOI 10.17487/RFC8949</span>, <time datetime="2020-12" class="refDate">December 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8949">https://www.rfc-editor.org/rfc/rfc8949</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9203">[RFC9203]</dt>
      <dd>
<span class="refAuthor">Palombini, F.</span>, <span class="refAuthor">Seitz, L.</span>, <span class="refAuthor">Selander, G.</span>, and <span class="refAuthor">M. Gunnarsson</span>, <span class="refTitle">"The Object Security for Constrained RESTful Environments (OSCORE) Profile of the Authentication and Authorization for Constrained Environments (ACE) Framework"</span>, <span class="seriesInfo">RFC 9203</span>, <span class="seriesInfo">DOI 10.17487/RFC9203</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9203">https://www.rfc-editor.org/rfc/rfc9203</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-17.2">
        <h3 id="name-informative-references">
<a href="#section-17.2" class="section-number selfRef">17.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.amsuess-core-cachable-oscore">[I-D.amsuess-core-cachable-oscore]</dt>
        <dd>
<span class="refAuthor">Amsüss, C.</span> and <span class="refAuthor">M. Tiloca</span>, <span class="refTitle">"Cacheable OSCORE"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-amsuess-core-cachable-oscore-10</span>, <time datetime="2025-01-08" class="refDate">8 January 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-amsuess-core-cachable-oscore-10">https://datatracker.ietf.org/doc/html/draft-amsuess-core-cachable-oscore-10</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-coap-pubsub">[I-D.ietf-core-coap-pubsub]</dt>
        <dd>
<span class="refAuthor">Jimenez, J.</span>, <span class="refAuthor">Koster, M.</span>, and <span class="refAuthor">A. Keränen</span>, <span class="refTitle">"A publish-subscribe architecture for the Constrained Application Protocol (CoAP)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-coap-pubsub-17</span>, <time datetime="2025-02-05" class="refDate">5 February 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-coap-pubsub-17">https://datatracker.ietf.org/doc/html/draft-ietf-core-coap-pubsub-17</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-coral">[I-D.ietf-core-coral]</dt>
        <dd>
<span class="refAuthor">Amsüss, C.</span> and <span class="refAuthor">T. Fossati</span>, <span class="refTitle">"The Constrained RESTful Application Language (CoRAL)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-coral-06</span>, <time datetime="2024-03-04" class="refDate">4 March 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-coral-06">https://datatracker.ietf.org/doc/html/draft-ietf-core-coral-06</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-oscore-capable-proxies">[I-D.ietf-core-oscore-capable-proxies]</dt>
        <dd>
<span class="refAuthor">Tiloca, M.</span> and <span class="refAuthor">R. Höglund</span>, <span class="refTitle">"OSCORE-capable Proxies"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-oscore-capable-proxies-03</span>, <time datetime="2024-10-21" class="refDate">21 October 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-capable-proxies-03">https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-capable-proxies-03</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-cose-cbor-encoded-cert">[I-D.ietf-cose-cbor-encoded-cert]</dt>
        <dd>
<span class="refAuthor">Mattsson, J. P.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Raza, S.</span>, <span class="refAuthor">Höglund, J.</span>, and <span class="refAuthor">M. Furuhed</span>, <span class="refTitle">"CBOR Encoded X.509 Certificates (C509 Certificates)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-cose-cbor-encoded-cert-12</span>, <time datetime="2025-01-08" class="refDate">8 January 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-cose-cbor-encoded-cert-12">https://datatracker.ietf.org/doc/html/draft-ietf-cose-cbor-encoded-cert-12</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.tiloca-core-oscore-discovery">[I-D.tiloca-core-oscore-discovery]</dt>
        <dd>
<span class="refAuthor">Tiloca, M.</span>, <span class="refAuthor">Amsüss, C.</span>, and <span class="refAuthor">P. Van der Stok</span>, <span class="refTitle">"Discovery of OSCORE Groups with the CoRE Resource Directory"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-tiloca-core-oscore-discovery-16</span>, <time datetime="2024-09-04" class="refDate">4 September 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-tiloca-core-oscore-discovery-16">https://datatracker.ietf.org/doc/html/draft-tiloca-core-oscore-discovery-16</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="MOBICOM99">[MOBICOM99]</dt>
        <dd>
<span class="refAuthor">Ni, S.</span>, <span class="refAuthor">Tseng, Y.</span>, <span class="refAuthor">Chen, Y.</span>, and <span class="refAuthor">J. Sheu</span>, <span class="refTitle">"The Broadcast Storm Problem in a Mobile Ad Hoc Network"</span>, <span class="seriesInfo">Proceedings of the 5th annual ACM/IEEE international conference on Mobile computing and networking </span>, <time datetime="1999-08" class="refDate">August 1999</time>, <span>&lt;<a href="https://people.eecs.berkeley.edu/~culler/cs294-f03/papers/bcast-storm.pdf">https://people.eecs.berkeley.edu/~culler/cs294-f03/papers/bcast-storm.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5280">https://www.rfc-editor.org/rfc/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6690">[RFC6690]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refTitle">"Constrained RESTful Environments (CoRE) Link Format"</span>, <span class="seriesInfo">RFC 6690</span>, <span class="seriesInfo">DOI 10.17487/RFC6690</span>, <time datetime="2012-08" class="refDate">August 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6690">https://www.rfc-editor.org/rfc/rfc6690</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7519">[RFC7519]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Token (JWT)"</span>, <span class="seriesInfo">RFC 7519</span>, <span class="seriesInfo">DOI 10.17487/RFC7519</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7519">https://www.rfc-editor.org/rfc/rfc7519</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8392">[RFC8392]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"CBOR Web Token (CWT)"</span>, <span class="seriesInfo">RFC 8392</span>, <span class="seriesInfo">DOI 10.17487/RFC8392</span>, <time datetime="2018-05" class="refDate">May 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8392">https://www.rfc-editor.org/rfc/rfc8392</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9147">[RFC9147]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"The Datagram Transport Layer Security (DTLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 9147</span>, <span class="seriesInfo">DOI 10.17487/RFC9147</span>, <time datetime="2022-04" class="refDate">April 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9147">https://www.rfc-editor.org/rfc/rfc9147</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9176">[RFC9176]</dt>
        <dd>
<span class="refAuthor">Amsüss, C., Ed.</span>, <span class="refAuthor">Shelby, Z.</span>, <span class="refAuthor">Koster, M.</span>, <span class="refAuthor">Bormann, C.</span>, and <span class="refAuthor">P. van der Stok</span>, <span class="refTitle">"Constrained RESTful Environments (CoRE) Resource Directory"</span>, <span class="seriesInfo">RFC 9176</span>, <span class="seriesInfo">DOI 10.17487/RFC9176</span>, <time datetime="2022-04" class="refDate">April 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9176">https://www.rfc-editor.org/rfc/rfc9176</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9200">[RFC9200]</dt>
      <dd>
<span class="refAuthor">Seitz, L.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Authentication and Authorization for Constrained Environments Using the OAuth 2.0 Framework (ACE-OAuth)"</span>, <span class="seriesInfo">RFC 9200</span>, <span class="seriesInfo">DOI 10.17487/RFC9200</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9200">https://www.rfc-editor.org/rfc/rfc9200</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="appendix-different-sources">
<section id="appendix-A">
      <h2 id="name-different-sources-for-group">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-different-sources-for-group" class="section-name selfRef">Different Sources for Group Observation Data</a>
      </h2>
<p id="appendix-A-1">While the clients usually receive the phantom registration request and other information related to the group observation through an informative response (see <a href="#ssec-server-side-informative" class="auto internal xref">Section 4.2</a>), the server can make the same data available through different means, such as those described in <a href="#appendix-different-sources-pubsub" class="auto internal xref">Appendix A.1</a> and <a href="#appendix-different-sources-introspection" class="auto internal xref">Appendix A.2</a>.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2">In such a case, the server has to first start the group observation (see <a href="#ssec-server-side-request" class="auto internal xref">Section 4.1</a>), before making the corresponding data available.<a href="#appendix-A-2" class="pilcrow">¶</a></p>
<p id="appendix-A-3">After a client has obtained such information from different sources than an informative response, the client may be able to simply set up the right multicast address and start receiving multicast notifications for the group observation. In such a case, the client does not need to perform additional setup traffic, e.g., in order to configure a proxy for listening to multicast notifications on its behalf (see <a href="#intermediaries" class="auto internal xref">Section 11</a> and <a href="#intermediaries-e2e-security" class="auto internal xref">Section 12</a>). Consequently, the server will not receive an observation request due to that client, will not follow-up with a corresponding informative response, and thus its observer counter (see <a href="#sec-server-side" class="auto internal xref">Section 4</a>) is not incremented to reflect the presence of the new client.<a href="#appendix-A-3" class="pilcrow">¶</a></p>
<div id="appendix-different-sources-pubsub">
<section id="appendix-A.1">
        <h3 id="name-topic-discovery-in-publish-">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-topic-discovery-in-publish-" class="section-name selfRef">Topic Discovery in Publish-Subscribe Settings</a>
        </h3>
<p id="appendix-A.1-1">In a Publish-Subscribe scenario <span>[<a href="#I-D.ietf-core-coap-pubsub" class="cite xref">I-D.ietf-core-coap-pubsub</a>]</span>, a group observation can be discovered along with topic metadata.<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
<p id="appendix-A.1-2">To this end, together with topic metadata, the server has to publish the same information associated with the group observation that would be conveyed in the informative response returned to observer clients (see <a href="#ssec-server-side-informative" class="auto internal xref">Section 4.2</a>).<a href="#appendix-A.1-2" class="pilcrow">¶</a></p>
<p id="appendix-A.1-3">This information especially includes the phantom observation request associated with the group observation, as well as the addressing information of the server and the addressing information where multicast notifications are sent to.<a href="#appendix-A.1-3" class="pilcrow">¶</a></p>
<p id="appendix-A.1-4"><a href="#discovery-pub-sub" class="auto internal xref">Figure 8</a> provides an example where a group observation is discovered. The example assumes a CoRAL namespace <span>[<a href="#I-D.ietf-core-coral" class="cite xref">I-D.ietf-core-coral</a>]</span>, that contains properties analogous to those in the Content-Format "application/informative-response+cbor".<a href="#appendix-A.1-4" class="pilcrow">¶</a></p>
<p id="appendix-A.1-5">Note that the information about the transport protocol used for the group observation is not expressed through a dedicated element equivalent to 'tp_id' of the informative response (see <a href="#sssec-transport-specific-encoding" class="auto internal xref">Section 4.2.1</a>). Instead, it is expressed through the scheme component of the two URIs specified as 'tp_info_server' and 'tp_info_client', where the former specifies the addressing information of the server (like 'tpi_server' in <a href="#ssssec-udp-transport-specific" class="auto internal xref">Section 4.2.1.1</a>), while the latter specifies the addressing information where multicast notifications are sent to (like 'tpi_client' in <a href="#ssssec-udp-transport-specific" class="auto internal xref">Section 4.2.1.1</a>).<a href="#appendix-A.1-5" class="pilcrow">¶</a></p>
<span id="name-group-observation-discovery"></span><div id="discovery-pub-sub">
<figure id="figure-8">
          <div class="alignLeft art-text artwork" id="appendix-A.1-6.1">
<pre>
Request:

    GET &lt;/ps/topics?rt=oic.r.temperature&gt;
    Accept: 65087 (application/coral+cbor)

Response:

    2.05 Content
    Content-Format: 65087 (application/coral+cbor)

    rdf:type [ = &lt;http://example.org/pubsub/topic-list&gt;,
           topic [ = &lt;/ps/topics/1234&gt;,
               tp_info_server &lt;coap://[2001:db8::1]&gt;,
               tp_info_client &lt;coap://[ff35:30:2001:db8::123]&gt;,
               tp_info_token "7b"^^xsd::hexBinary,
               ph_req "0160.."^^xsd::hexBinary,
               last_notif "256105.."^^xsd::hexBinary,
               ending "2051251201"^^xsd::unsignedLong,
           ]
    ]
</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-group-observation-discovery" class="selfRef">Group Observation Discovery in a Pub-Sub Scenario</a>
          </figcaption></figure>
</div>
<p id="appendix-A.1-7">With this information from the topic discovery step, the client can already set up its multicast address and start receiving multicast notifications for the group observation in question. Clients that are not directly able to listen to multicast notifications can instead rely on a proxy to do so on their behalf (see <a href="#intermediaries" class="auto internal xref">Section 11</a> and <a href="#intermediaries-e2e-security" class="auto internal xref">Section 12</a>).<a href="#appendix-A.1-7" class="pilcrow">¶</a></p>
<p id="appendix-A.1-8">In heavily asymmetric networks like municipal notification services, discovery and notifications do not necessarily need to use the same network link. For example, a departure monitor could use its (costly and usually-off) cellular uplink to discover the topics it needs to update its display to, and then listen on a LoRA-WAN interface for receiving the actual multicast notifications.<a href="#appendix-A.1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="appendix-different-sources-introspection">
<section id="appendix-A.2">
        <h3 id="name-introspection-at-the-multic">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-introspection-at-the-multic" class="section-name selfRef">Introspection at the Multicast Notification Sender</a>
        </h3>
<p id="appendix-A.2-1">For network debugging purposes, it can be useful to query a server that sends multicast responses as matching a phantom registration request.<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
<p id="appendix-A.2-2">Such an interface is left for other documents to specify on demand. As an example, a possible interface can be as follows, and relies on the already known Token value of intercepted multicast notifications associated with a phantom registration request.<a href="#appendix-A.2-2" class="pilcrow">¶</a></p>
<span id="name-group-observation-discovery-"></span><div id="discovery-introspection">
<figure id="figure-9">
          <div class="alignLeft art-text artwork" id="appendix-A.2-3.1">
<pre>
Request:

GET &lt;/.well-known/core/mc-sender?token=6464&gt;

Response:

2.05 Content
Content-Format: application/informative-response+cbor

{
  / tp_info /    0 : [
                      [ / tpi_server /
                       -1,        / scheme-id -- equivalent to "coap" /
                        h'20010db80000000000000000000000ab' / host-ip /
                      ],
                      [ / tpi_client /
                       -1,        / scheme-id -- equivalent to "coap" /
                       h'ff35003020010db80000000000000023', / host-ip /
                       61616                                   / port /
                      ],
                      h'7b'                               / tpi_token /
                     ],
  / ph_req /     1 : h'0160...528c', / elided for brevity/
  / last_notif / 2 : h'256105...4fa1', / elided for brevity/
  / ending /     4 : 2051251201

}
</pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-group-observation-discovery-" class="selfRef">Group Observation Discovery with Server Introspection</a>
          </figcaption></figure>
</div>
<p id="appendix-A.2-4">For example, a network sniffer could offer sending such a request when unknown multicast notifications are seen in the network. Consequently, it can associate those notifications with a URI, or decrypt them if member of the correct OSCORE group.<a href="#appendix-A.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="appendix-pseudo-code-counting">
<section id="appendix-B">
      <h2 id="name-pseudo-code-for-rough-count">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-pseudo-code-for-rough-count" class="section-name selfRef">Pseudo-Code for Rough Counting of Clients</a>
      </h2>
<p id="appendix-B-1">This appendix provides a description in pseudo-code of the two algorithms used for the rough counting of active observers, as defined in <a href="#sec-rough-counting" class="auto internal xref">Section 8</a>.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">In particular, <a href="#appendix-pseudo-code-counting-client" class="auto internal xref">Appendix B.1</a> describes the algorithm for the client side, while <a href="#appendix-pseudo-code-counting-client-constrained" class="auto internal xref">Appendix B.2</a> describes an optimized version for constrained clients. Finally, <a href="#appendix-pseudo-code-counting-server" class="auto internal xref">Appendix B.3</a> describes the algorithm for the server side.<a href="#appendix-B-2" class="pilcrow">¶</a></p>
<div id="appendix-pseudo-code-counting-client">
<section id="appendix-B.1">
        <h3 id="name-client-side">
<a href="#appendix-B.1" class="section-number selfRef">B.1. </a><a href="#name-client-side" class="section-name selfRef">Client Side</a>
        </h3>
<div class="alignLeft art-text artwork" id="appendix-B.1-1">
<pre>
input:  int Q, // Value of the MRFD option
        int LEISURE_TIME, // DEFAULT_LEISURE from RFC 7252,
                          // unless overridden

output: None


int RAND_MIN = 0;
int RAND_MAX = (2^Q) - 1;
int I = randomInteger(RAND_MIN, RAND_MAX);

if (I == 0) {
    float fraction = randomFloat(0, 1);

    Timer t = new Timer();
    t.setAndStart(fraction * LEISURE_TIME);
    while(!t.isExpired());

    Request req = new Request();
    // Initialize as NON and with maximum
    // No-Response settings, set options ...

    Option opt = new Option(OBSERVE);
    opt.set(0);
    req.setOption(opt);

    opt = new Option(MRFD);
    opt.set(0);
    req.setOption(opt);

    req.send(SRV_ADDR, SRV_PORT);
}
</pre><a href="#appendix-B.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="appendix-pseudo-code-counting-client-constrained">
<section id="appendix-B.2">
        <h3 id="name-client-side-optimized-versi">
<a href="#appendix-B.2" class="section-number selfRef">B.2. </a><a href="#name-client-side-optimized-versi" class="section-name selfRef">Client Side - Optimized Version</a>
        </h3>
<div class="alignLeft art-text artwork" id="appendix-B.2-1">
<pre>
input:  int Q, // Value of the MRFD option
        int LEISURE_TIME, // DEFAULT_LEISURE from RFC 7252,
                          // unless overridden

output: None


const unsigned int UINT_BIT = CHAR_BIT * sizeof(unsigned int);

if (respond_to(Q) == true) {
    float fraction = randomFloat(0, 1);

    Timer t = new Timer();
    t.setAndStart(fraction * LEISURE_TIME);
    while(!t.isExpired());

    Request req = new Request();
    // Initialize as NON and with maximum
    // No-Response settings, set options ...

    Option opt = new Option(OBSERVE);
    opt.set(0);
    req.setOption(opt);

    opt = new Option(MRFD);
    opt.set(0);
    req.setOption(opt);

    req.send(SRV_ADDR, SRV_PORT);
}

bool respond_to(int Q) {
    while (Q &gt;= UINT_BIT) {
        if (rand() != 0) return false;
        Q -= UINT_BIT;
    }
    unsigned int mask = ~((~0u) &lt;&lt; Q);
    unsigned int masked = mask &amp; rand();
    return masked == 0;
}
</pre><a href="#appendix-B.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="appendix-pseudo-code-counting-server">
<section id="appendix-B.3">
        <h3 id="name-server-side">
<a href="#appendix-B.3" class="section-number selfRef">B.3. </a><a href="#name-server-side" class="section-name selfRef">Server Side</a>
        </h3>
<div class="alignLeft art-text artwork" id="appendix-B.3-1">
<pre>
input:  int COUNT, // Current observer counter
        int M, // Desired number of confirmations
        int MAX_CONFIRMATION_WAIT,
        Response notification, // Multicast notification to send

output: int NEW_COUNT // Updated observer counter


int D = 4; // Dampener value
int RETRY_NEXT_THRESHOLD = 4;
float CANCEL_THRESHOLD = 0.2;

int N = max(COUNT, 1);
int Q = max(ceil(log2(N / M)), 0);
Option opt = new Option(MRFD);
opt.set(Q);

notification.setOption(opt);
&lt;Finalize the notification message&gt;
notification.send(GRP_ADDR, GRP_PORT);

Timer t = new Timer();
t.setAndStart(MAX_CONFIRMATION_WAIT); // Time t1
while(!t.isExpired());

// Time t2

int R = &lt;number of requests to the target resource
         received between t1 and t2, and including
         the MRFD option with value 0&gt;;

int E = R * (2^Q);

// Determine after how many multicast notifications
// the next count update will be performed
if ((R == 0) || (max(E/N, N/E) &gt; RETRY_NEXT_THRESHOLD)) {
    &lt;Next count update with the next multicast notification&gt;
}
else {
    &lt;Next count update after 10 multicast notifications&gt;
}

// Compute the new count estimate
int COUNT_PRIME = &lt;current value of the observer counter&gt;;
int NEW_COUNT = COUNT_PRIME + ((E - N) / D);

// Determine whether to cancel the group observation
if (NEW_COUNT &lt; CANCEL_THRESHOLD) {
    &lt;Cancel the group observation&gt;;
    return 0;
}

return NEW_COUNT;
</pre><a href="#appendix-B.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="self-managed-oscore-group">
<section id="appendix-C">
      <h2 id="name-oscore-group-self-managed-b">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-oscore-group-self-managed-b" class="section-name selfRef">OSCORE Group Self-Managed by the Server</a>
      </h2>
<p id="appendix-C-1">For simple settings, where no pre-arranged group with suitable memberships is available, the server can be responsible to set up and manage the OSCORE group used to protect the group observation.<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<p id="appendix-C-2">In such a case, a client would implicitly request to join the OSCORE group when sending the observe registration request to the server. When replying, the server includes the group keying material and related information in the informative response (see <a href="#ssec-server-side-informative" class="auto internal xref">Section 4.2</a>).<a href="#appendix-C-2" class="pilcrow">¶</a></p>
<p id="appendix-C-3">Additionally to what is defined in <a href="#sec-server-side" class="auto internal xref">Section 4</a>, the CBOR map in the informative response payload contains the following fields, whose CBOR abbreviations are defined in <a href="#informative-response-params" class="auto internal xref">Section 13</a>.<a href="#appendix-C-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-4.1">
          <p id="appendix-C-4.1.1">'gp_material': this element is a CBOR map, which includes what the client needs in order to set up the Group OSCORE Security Context.<a href="#appendix-C-4.1.1" class="pilcrow">¶</a></p>
<p id="appendix-C-4.1.2">
This parameter has as value a subset of the Group_OSCORE_Input_Material object, which is defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-oscore-16#section-6.3" class="relref">Section 6.3</a> of [<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="cite xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span> and extends the OSCORE_Input_Material object encoded in CBOR as defined in <span><a href="https://rfc-editor.org/rfc/rfc9203#section-3.2.1" class="relref">Section 3.2.1</a> of [<a href="#RFC9203" class="cite xref">RFC9203</a>]</span>.<a href="#appendix-C-4.1.2" class="pilcrow">¶</a></p>
<p id="appendix-C-4.1.3">
In particular, the following elements of the Group_OSCORE_Input_Material object are included, using the same CBOR abbreviations from the OSCORE Security Context Parameters Registry, as in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-oscore-16#section-6.3" class="relref">Section 6.3</a> of [<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="cite xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span>.<a href="#appendix-C-4.1.3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-4.1.4.1">
              <p id="appendix-C-4.1.4.1.1">'ms', 'contexId', 'cred_fmt', 'sign_enc_alg', 'sign_alg', and 'sign_params'. These elements <span class="bcp14">MUST</span> be included.<a href="#appendix-C-4.1.4.1.1" class="pilcrow">¶</a></p>
<p id="appendix-C-4.1.4.1.2">
Editor's note: as per the text above, the referred version of <span>[<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="cite xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span> still uses 'sign_enc_alg' as parameter name. The next version of <span>[<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="cite xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span> will be updated in order to use 'gp_enc_alg' instead, consistently with the naming used in the latest version of <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>.<a href="#appendix-C-4.1.4.1.2" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-C-4.1.4.2">
              <p id="appendix-C-4.1.4.2.1">'hkdf' and 'salt'. These elements <span class="bcp14">MAY</span> be included.<a href="#appendix-C-4.1.4.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="appendix-C-4.1.5">
The 'group_senderId' element of the Group_OSCORE_Input_Material object <span class="bcp14">MUST NOT</span> be included.<a href="#appendix-C-4.1.5" class="pilcrow">¶</a></p>
<p id="appendix-C-4.1.6">
Note that no information is provided as related to the AEAD Algorithm, or to the Pairwise Key Agreement Algorithm and its parameters. In fact, the clients and the server will never use the pairwise mode of Group OSCORE as per <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-24#section-8" class="relref">Section 8</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>, and will not need to compute a cofactor Diffie-Hellman shared secret in this OSCORE group. It follows that:<a href="#appendix-C-4.1.6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-4.1.7.1">
              <p id="appendix-C-4.1.7.1.1">In the Common Context of the Group OSCORE Security Context, the parameter AEAD Algorithm and the parameter Pairwise Key Agreement Algorithm are not set (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-24#section-2.1.1" class="relref">Section 2.1.1</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span> and <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-24#section-2.1.10" class="relref">Section 2.1.10</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>).<a href="#appendix-C-4.1.7.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-C-4.1.7.2">
              <p id="appendix-C-4.1.7.2.1">Consistently, when building the two OSCORE 'external_aad' to process messages protected with Group OSCORE in this OSCORE group, (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-24#section-3.4" class="relref">Section 3.4</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>), the elements 'alg_aead' and 'alg_pairwise_key_agreement' within the 'algorithms' arrays are set to the CBOR simple value <code>null</code> (0xf6).<a href="#appendix-C-4.1.7.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
        <li class="normal" id="appendix-C-4.2">
          <p id="appendix-C-4.2.1">'srv_cred': this element is a CBOR byte string, with value the original binary representation of the server's authentication credential used in the OSCORE group. In particular, the original binary representation complies with the format specified by the 'cred_fmt' element of 'gp_material'.<a href="#appendix-C-4.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-4.3">
          <p id="appendix-C-4.3.1">'srv_identifier': this element is encoded as a CBOR byte string, with value the Sender ID that the server has in the OSCORE group.<a href="#appendix-C-4.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-4.4">
          <p id="appendix-C-4.4.1">'exi': this element has as value the residual lifetime of the keying material of the OSCORE group specified in the 'gp_material' parameter, encoded as a CBOR unsigned integer.<a href="#appendix-C-4.4.1" class="pilcrow">¶</a></p>
<p id="appendix-C-4.4.2">
The value represents the residual lifetime of the keying material in seconds, i.e., the number of seconds between the current time at the server and the time when the keying material expires. Upon receiving the informative response containing the 'exi' parameter, a client determines the expiration time of the keying material by adding the number of seconds specified in the 'exi' parameter to its current time.<a href="#appendix-C-4.4.2" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-5">If the server has a reliable way to synchronize its internal clock with UTC, then the server includes also the following field:<a href="#appendix-C-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-6.1">
          <p id="appendix-C-6.1.1">'exp': this element has as value the expiration time of the keying material of the OSCORE group specified in the 'gp_material' parameter, encoded as a CBOR unsigned integer.<a href="#appendix-C-6.1.1" class="pilcrow">¶</a></p>
<p id="appendix-C-6.1.2">
The value represents the number of seconds from 1970-01-01T00:00:00Z UTC until the specified UTC date/time, ignoring leap seconds, analogous to what is specified for NumericDate in <span><a href="https://rfc-editor.org/rfc/rfc7519#section-2" class="relref">Section 2</a> of [<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>.<a href="#appendix-C-6.1.2" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-7">If a client has a reliable way to synchronize its internal clock with UTC and the 'exp' parameter is present in the informative response, then the client <span class="bcp14">MUST</span> use the 'exp' parameter value as expiration time for the group keying material.<a href="#appendix-C-7" class="pilcrow">¶</a></p>
<p id="appendix-C-8">Note that the informative response does not require to include an explicit proof-of-possession (PoP) of the server's private key. Although the server is also acting as Group Manager and a PoP evidence of the Group Manager's private key is included in a full-fledged Join Response (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-oscore-16#section-6.3" class="relref">Section 6.3</a> of [<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="cite xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span>), such proof-of-possession will be achieved through every multicast notification that the server sends, as protected with the group mode of Group OSCORE and including a signature computed with its private key.<a href="#appendix-C-8" class="pilcrow">¶</a></p>
<p id="appendix-C-9">A client receiving an informative response uses the information above to set up the Group OSCORE Security Context, as described in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-24#section-2" class="relref">Section 2</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>. Note that the client does not obtain a Sender ID of its own, hence it installs the Security Context like a "silent server" would, i.e., without Sender Context. From then on, the client uses the received keying material to process the incoming multicast notifications from the server.<a href="#appendix-C-9" class="pilcrow">¶</a></p>
<p id="appendix-C-10">Since the server is also acting as Group Manager, the authentication credential of the server provided in the 'srv_cred' element of the informative response is also used in the 'gm_cred' element of the external_aad for encrypting and signing the phantom request and multicast notifications (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-24#section-3.4" class="relref">Section 3.4</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>).<a href="#appendix-C-10" class="pilcrow">¶</a></p>
<p id="appendix-C-11">Furthermore, the server complies with the following points.<a href="#appendix-C-11" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-12.1">
          <p id="appendix-C-12.1.1">The server <span class="bcp14">MUST NOT</span> self-manage OSCORE groups and provide the related keying material in the informative response for any other purpose than the protection of the phantom requests and the multicast notifications in group observations that it hosts, as defined in this document.<a href="#appendix-C-12.1.1" class="pilcrow">¶</a></p>
<p id="appendix-C-12.1.2">
The server <span class="bcp14">MAY</span> use the same self-managed OSCORE group to protect the phantom request and the multicast notifications of multiple group observations that it hosts.<a href="#appendix-C-12.1.2" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-12.2">
          <p id="appendix-C-12.2.1">The server <span class="bcp14">MUST NOT</span> provide in the informative response the keying material of other OSCORE groups it is or has been a member of.<a href="#appendix-C-12.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-13">Upon expiration of the group keying material as indicated in the informative response by the 'exp' parameter (if present) and the 'exi' parameter:<a href="#appendix-C-13" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-14.1">
          <p id="appendix-C-14.1.1">The server <span class="bcp14">MUST</span> stop using the keying material and <span class="bcp14">MUST</span> cancel the group observations for which that keying material is used (see <a href="#ssec-server-side-cancellation" class="auto internal xref">Section 4.5</a> and <a href="#ssec-server-side-cancellation-oscore" class="auto internal xref">Section 9.2.4</a>). If the server creates a new group observation as a replacement or follow-up using the same OSCORE group:<a href="#appendix-C-14.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-14.1.2.1">
              <p id="appendix-C-14.1.2.1.1">The server <span class="bcp14">MUST</span> update the OSCORE Master Secret.<a href="#appendix-C-14.1.2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-C-14.1.2.2">
              <p id="appendix-C-14.1.2.2.1">The server <span class="bcp14">MUST</span> update the ID Context used as Group Identifier (Gid), consistently with <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-24#section-12.2" class="relref">Section 12.2</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>.<a href="#appendix-C-14.1.2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-C-14.1.2.3">
              <p id="appendix-C-14.1.2.3.1">The server <span class="bcp14">MAY</span> update the OSCORE Master Salt.<a href="#appendix-C-14.1.2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
        <li class="normal" id="appendix-C-14.2">
          <p id="appendix-C-14.2.1">The client <span class="bcp14">MUST</span> stop using the keying material and <span class="bcp14">MAY</span> re-register the observation at the server.<a href="#appendix-C-14.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-15">Before the keying material has expired, the server can send a multicast response with response code 5.03 (Service Unavailable) to the observing clients, protected with the current keying material. In particular, while it is analogous to the informative response defined in <a href="#ssec-server-side-informative" class="auto internal xref">Section 4.2</a>, this response has the following differences:<a href="#appendix-C-15" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-16.1">
          <p id="appendix-C-16.1.1">it additionally contains the abovementioned parameters for the next group keying material to be used; and<a href="#appendix-C-16.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-16.2">
          <p id="appendix-C-16.2.1">it <span class="bcp14">MAY</span> omit the 'tp_info' and 'ph_req' parameters, since the associated information is immutable throughout the observation lifetime.<a href="#appendix-C-16.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-17">The response has the same Token value T of the phantom registration request and it does not include an Observe Option. The server <span class="bcp14">MUST</span> use its own Sender Sequence Number as Partial IV to protect the error response, and include its encoding as the Partial IV in the OSCORE Option of the response.<a href="#appendix-C-17" class="pilcrow">¶</a></p>
<p id="appendix-C-18">When some clients leave the OSCORE group and forget about the group observation, the server does not have to provide the remaining clients with any stale Sender IDs, as normally required for Group OSCORE (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-24#section-12.2" class="relref">Section 12.2</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>). In fact, only two entities in the group have a Sender ID, i.e., the server and possibly the Deterministic Client, if the optimization defined in this appendix is combined with the use of phantom requests as deterministic requests (see <a href="#deterministic-phantom-Request" class="auto internal xref">Appendix D</a>). In particular, both of them never change their Sender ID during the group lifetime, and they both remain part of the group until the group ceases to exist.<a href="#appendix-C-18" class="pilcrow">¶</a></p>
<p id="appendix-C-19">As an alternative to renewing the keying material before it expires, the server can simply cancel the group observation (see <a href="#ssec-server-side-cancellation" class="auto internal xref">Section 4.5</a> and <a href="#ssec-server-side-cancellation-oscore" class="auto internal xref">Section 9.2.4</a>), which results in the eventual re-registration of the clients that are still interested in the group observation.<a href="#appendix-C-19" class="pilcrow">¶</a></p>
<p id="appendix-C-20">Applications requiring backward security or forward security are <span class="bcp14">REQUIRED</span> to use an actual group joining process (usually through a dedicated Group Manager), e.g., the ACE joining procedure defined in <span>[<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="cite xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span>. The server can facilitate the clients by providing them with information about the OSCORE group to join, as described in <a href="#sec-inf-response" class="auto internal xref">Section 9.1</a>.<a href="#appendix-C-20" class="pilcrow">¶</a></p>
</section>
</div>
<div id="deterministic-phantom-Request">
<section id="appendix-D">
      <h2 id="name-phantom-request-as-determin">
<a href="#appendix-D" class="section-number selfRef">Appendix D. </a><a href="#name-phantom-request-as-determin" class="section-name selfRef">Phantom Request as Deterministic Request</a>
      </h2>
<p id="appendix-D-1">In some settings, the server can assume that all the approaching clients already have the exact phantom observation request to use, together with the transport-specific information required to listen to corresponding multicast notifications.<a href="#appendix-D-1" class="pilcrow">¶</a></p>
<p id="appendix-D-2">For instance, the clients can be pre-configured with the phantom observation request, or they may be expected to retrieve it through dedicated means (see <a href="#appendix-different-sources" class="auto internal xref">Appendix A</a>). In either case, the server would already have started the group observation, before the associated phantom observation request was disseminated.<a href="#appendix-D-2" class="pilcrow">¶</a></p>
<p id="appendix-D-3">Then, the clients either set up the multicast address and group observation for listening to multicast notifications (if able to directly do so), or rely on a proxy to do so on their behalf (see <a href="#intermediaries" class="auto internal xref">Section 11</a> and <a href="#intermediaries-e2e-security" class="auto internal xref">Section 12</a>).<a href="#appendix-D-3" class="pilcrow">¶</a></p>
<p id="appendix-D-4">If Group OSCORE is used to protect the group observation (see <a href="#sec-secured-notifications" class="auto internal xref">Section 9</a>), and the OSCORE group supports the concept of Deterministic Client <span>[<a href="#I-D.amsuess-core-cachable-oscore" class="cite xref">I-D.amsuess-core-cachable-oscore</a>]</span>, then the server and each client in the OSCORE group can also independently compute the protected phantom observation request.<a href="#appendix-D-4" class="pilcrow">¶</a></p>
<p id="appendix-D-5">In such a case, the unprotected version of the phantom observation request can be made available to the clients as a smaller, plain CoAP message. As above, this can be pre-configured on the clients, or they can obtain it through dedicated means (see <a href="#appendix-different-sources" class="auto internal xref">Appendix A</a>). In either case, the clients and the server can independently protect the plain CoAP message by using the approach defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-amsuess-core-cachable-oscore-10#section-3" class="relref">Section 3</a> of [<a href="#I-D.amsuess-core-cachable-oscore" class="cite xref">I-D.amsuess-core-cachable-oscore</a>]</span>, thus all computing the same protected deterministic request. The latter is used as the actual phantom observation request that the protected multicast notifications will match under the group observation in question.<a href="#appendix-D-5" class="pilcrow">¶</a></p>
<p id="appendix-D-6">When receiving the deterministic request, the server can clearly understand what is happening. In fact, as the result of an early check, the server recognizes the phantom request among the stored ones. This relies on a byte-by-byte comparison of the incoming message minus the transport-related fields, i.e., by considering only: i) the outer REST code; ii) the outer options; and iii) the ciphertext from the message payload.<a href="#appendix-D-6" class="pilcrow">¶</a></p>
<p id="appendix-D-7">If the server recognizes the received deterministic request as one of its self-generated deterministic phantom requests, then the server does not perform any Group OSCORE processing on it. This opens for replying with an unprotected response, although not indicating any OSCORE-related error. In particular, the server <span class="bcp14">MUST</span> reply with an informative response that <span class="bcp14">MUST NOT</span> be protected. If a proxy is deployed between the clients and the server, the proxy is thus able to retrieve from the informative response everything needed to set itself as an observer in the group observation, and to start listening to multicast notifications.<a href="#appendix-D-7" class="pilcrow">¶</a></p>
<p id="appendix-D-8">If relying on a proxy, each client sends the deterministic request to the proxy as a ticket request (see <a href="#intermediaries-e2e-security" class="auto internal xref">Section 12</a>). However, differently from what is defined in <a href="#intermediaries-e2e-security" class="auto internal xref">Section 12</a> where the ticket request is not a deterministic request, the clients do not include a Listen-to-Multicast-Responses Option. This results in the proxy forwarding the ticket request (i.e., the phantom observation request) to the server and obtaining the information required to listen to multicast notifications, unless the proxy has already set itself to do so. Also, the proxy will be able to serve multicast notifications from its cache as per <span>[<a href="#I-D.amsuess-core-cachable-oscore" class="cite xref">I-D.amsuess-core-cachable-oscore</a>]</span>. An example considering such a setup is shown in <a href="#intermediaries-example-e2e-security-det" class="auto internal xref">Appendix G</a>.<a href="#appendix-D-8" class="pilcrow">¶</a></p>
<p id="appendix-D-9">Note that the phantom registration request is, in terms of transport-independent information, identical to the same deterministic request possibly sent by each client (e.g., if a proxy is deployed). Thus, if the server receives such a phantom registration request, the informative response may omit the 'ph_req' parameter (see <a href="#ssec-server-side-informative" class="auto internal xref">Section 4.2</a>). If a client receives an informative response that includes the 'ph_req' parameter, and this specifies transport-independent information different from the one of the sent deterministic request, then the client considers the informative response malformed.<a href="#appendix-D-9" class="pilcrow">¶</a></p>
<p id="appendix-D-10">When using a deterministic request as a phantom observation request, the observer counter at the server (see <a href="#sec-server-side" class="auto internal xref">Section 4</a>) is not reliably incremented when new clients start participating in the group observation. In fact:<a href="#appendix-D-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D-11.1">
          <p id="appendix-D-11.1.1">If a proxy is not deployed, the clients simply set up the right multicast address and port number, and starts listening to multicast notifications bound to the deterministic request. Hence, the observer counter at the server is not incremented as new clients start listening to multicast notifications.<a href="#appendix-D-11.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-D-11.2">
          <p id="appendix-D-11.2.1">If a proxy is deployed, the origin server increments its observer counter after having sent the informative response to the proxy, as a reply to the deterministic request forwarded to the origin server on behalf of the first origin client that contacted the proxy. After that, the same deterministic request sent by any origin client will not be forwarded to the origin server, but will instead produce a cache hit at the proxy that will serve the client accordingly. Hence, the observer counter at the server is not further incremented as additional, new origin clients start participating in the group observation through the proxy.<a href="#appendix-D-11.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-D-12">In either case, the security identity associated with the sender of any deterministic request in the OSCORE group is exactly the same one, i.e., the pair (SID, OSCORE ID Context), where SID is the OSCORE Sender ID of the Deterministic Client in the OSCORE group, which all the clients in the group rely on to produce deterministic requests.<a href="#appendix-D-12" class="pilcrow">¶</a></p>
<p id="appendix-D-13">If the optimization defined in <a href="#self-managed-oscore-group" class="auto internal xref">Appendix C</a> is also used, the 'gp_material' element in the informative response from the server <span class="bcp14">MUST</span> also include the following elements from the Group_OSCORE_Input_Material object.<a href="#appendix-D-13" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D-14.1">
          <p id="appendix-D-14.1.1">'alg', as per <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-oscore-16#section-6.3" class="relref">Section 6.3</a> of [<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="cite xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span>.<a href="#appendix-D-14.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-D-14.2">
          <p id="appendix-D-14.2.1">'det_senderId' and 'det_hash_alg', defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-amsuess-core-cachable-oscore-10#section-4" class="relref">Section 4</a> of [<a href="#I-D.amsuess-core-cachable-oscore" class="cite xref">I-D.amsuess-core-cachable-oscore</a>]</span>. These specify the Sender ID of the Deterministic Client in the OSCORE group, and the hash algorithm used to compute the deterministic request (see <span><a href="https://datatracker.ietf.org/doc/html/draft-amsuess-core-cachable-oscore-10#section-3.4.1" class="relref">Section 3.4.1</a> of [<a href="#I-D.amsuess-core-cachable-oscore" class="cite xref">I-D.amsuess-core-cachable-oscore</a>]</span>).<a href="#appendix-D-14.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-D-15">Note that, like in <a href="#self-managed-oscore-group" class="auto internal xref">Appendix C</a>, no information is provided as related to the Pairwise Key Agreement Algorithm and its parameters. In fact, the clients and the server will not need to compute a cofactor Diffie-Hellman shared secret in this OSCORE group. It follows that:<a href="#appendix-D-15" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D-16.1">
          <p id="appendix-D-16.1.1">In the Common Context of the Group OSCORE Security Context, the parameter Pairwise Key Agreement Algorithm is not set (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-24#section-2.1.10" class="relref">Section 2.1.10</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>).<a href="#appendix-D-16.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-D-16.2">
          <p id="appendix-D-16.2.1">Consistently, when building the two OSCORE 'external_aad' to process messages protected with Group OSCORE in this OSCORE group, (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-24#section-3.4" class="relref">Section 3.4</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>), the element 'alg_pairwise_key_agreement' within the 'algorithms' arrays is set to the CBOR simple value <code>null</code> (0xf6).<a href="#appendix-D-16.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-D-17">If a deterministic request is used as phantom observation request for a group observation, the server does not assist clients that are interested to take part in the group observation but do not support deterministic requests. This is consistent with the fact that the setup in question already relies on a lot of agreed pre-configuration.<a href="#appendix-D-17" class="pilcrow">¶</a></p>
<p id="appendix-D-18">Therefore, the following holds when a group observation for a target resource relies on a deterministic request as a phantom observation request.<a href="#appendix-D-18" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D-19.1">
          <p id="appendix-D-19.1.1">Every client interested to take part in such a group observation: has to support deterministic requests; and has to know the phantom observation request, as a result of pre-configuration or following its retrieval through dedicated means (see <a href="#appendix-different-sources" class="auto internal xref">Appendix A</a>).<a href="#appendix-D-19.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-D-19.2">
          <p id="appendix-D-19.2.1">The server does not simultaneously run a parallel group observation for the same target resource, as associated with a different phantom observation request and intended to clients that do not support deterministic requests.<a href="#appendix-D-19.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-D-19.3">
          <p id="appendix-D-19.3.1">If the server receives an observation request for the target resource that differs from the specific deterministic request associated with the group observation for that target resource, then the server replies as usual with an informative response, including: the transport-specific information, the phantom request (i.e., the expected deterministic request), and (optionally) the latest notification.<a href="#appendix-D-19.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="intermediaries-example">
<section id="appendix-E">
      <h2 id="name-example-with-a-proxy">
<a href="#appendix-E" class="section-number selfRef">Appendix E. </a><a href="#name-example-with-a-proxy" class="section-name selfRef">Example with a Proxy</a>
      </h2>
<p id="appendix-E-1">This section provides an example when a proxy P is used between the clients and the server. The same assumptions and notation used in <a href="#sec-example-no-security" class="auto internal xref">Section 7</a> are used for this example. In addition, the proxy has address PRX_ADDR and listens to the port number PRX_PORT.<a href="#appendix-E-1" class="pilcrow">¶</a></p>
<p id="appendix-E-2">Unless explicitly indicated, all messages transmitted on the wire are sent over unicast.<a href="#appendix-E-2" class="pilcrow">¶</a></p>
<span id="name-example-of-group-observation-"></span><div id="example-proxy-no-oscore">
<figure id="figure-10">
        <div id="appendix-E-3.1">
          <div class="alignLeft art-svg artwork" id="appendix-E-3.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="1664" width="576" viewBox="0 0 576 1664" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 8,48 L 8,992" fill="none" stroke="black"></path>
              <path d="M 8,1056 L 8,1232" fill="none" stroke="black"></path>
              <path d="M 8,1296 L 8,1600" fill="none" stroke="black"></path>
              <path d="M 64,48 L 64,88" fill="none" stroke="black"></path>
              <path d="M 64,104 L 64,920" fill="none" stroke="black"></path>
              <path d="M 64,936 L 64,992" fill="none" stroke="black"></path>
              <path d="M 64,1056 L 64,1232" fill="none" stroke="black"></path>
              <path d="M 64,1296 L 64,1448" fill="none" stroke="black"></path>
              <path d="M 64,1464 L 64,1600" fill="none" stroke="black"></path>
              <path d="M 120,48 L 120,992" fill="none" stroke="black"></path>
              <path d="M 120,1056 L 120,1232" fill="none" stroke="black"></path>
              <path d="M 120,1296 L 120,1600" fill="none" stroke="black"></path>
              <path d="M 192,48 L 192,992" fill="none" stroke="black"></path>
              <path d="M 192,1056 L 192,1232" fill="none" stroke="black"></path>
              <path d="M 192,1296 L 192,1600" fill="none" stroke="black"></path>
              <path d="M 8,96 L 112,96" fill="none" stroke="black"></path>
              <path d="M 120,160 L 184,160" fill="none" stroke="black"></path>
              <path d="M 144,336 L 192,336" fill="none" stroke="black"></path>
              <path d="M 144,384 L 184,384" fill="none" stroke="black"></path>
              <path d="M 128,576 L 192,576" fill="none" stroke="black"></path>
              <path d="M 16,928 L 120,928" fill="none" stroke="black"></path>
              <path d="M 64,1072 L 112,1072" fill="none" stroke="black"></path>
              <path d="M 72,1168 L 120,1168" fill="none" stroke="black"></path>
              <path d="M 128,1376 L 192,1376" fill="none" stroke="black"></path>
              <path d="M 16,1456 L 120,1456" fill="none" stroke="black"></path>
              <path d="M 72,1536 L 120,1536" fill="none" stroke="black"></path>
              <path d="M 132,360 L 144,384" fill="none" stroke="black"></path>
              <path d="M 132,360 L 144,336" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="192,384 180,378.4 180,389.6" fill="black" transform="rotate(0,184,384)"></polygon>
              <polygon class="arrowhead" points="192,160 180,154.4 180,165.6" fill="black" transform="rotate(0,184,160)"></polygon>
              <polygon class="arrowhead" points="136,1376 124,1370.4 124,1381.6" fill="black" transform="rotate(180,128,1376)"></polygon>
              <polygon class="arrowhead" points="136,576 124,570.4 124,581.6" fill="black" transform="rotate(180,128,576)"></polygon>
              <polygon class="arrowhead" points="120,1072 108,1066.4 108,1077.6" fill="black" transform="rotate(0,112,1072)"></polygon>
              <polygon class="arrowhead" points="120,96 108,90.4 108,101.6" fill="black" transform="rotate(0,112,96)"></polygon>
              <polygon class="arrowhead" points="80,1536 68,1530.4 68,1541.6" fill="black" transform="rotate(180,72,1536)"></polygon>
              <polygon class="arrowhead" points="80,1168 68,1162.4 68,1173.6" fill="black" transform="rotate(180,72,1168)"></polygon>
              <polygon class="arrowhead" points="24,1456 12,1450.4 12,1461.6" fill="black" transform="rotate(180,16,1456)"></polygon>
              <polygon class="arrowhead" points="24,928 12,922.4 12,933.6" fill="black" transform="rotate(180,16,928)"></polygon>
              <g class="text">
                <text x="12" y="36">C1</text>
                <text x="68" y="36">C2</text>
                <text x="120" y="36">P</text>
                <text x="192" y="36">S</text>
                <text x="228" y="68">(The</text>
                <text x="272" y="68">value</text>
                <text x="308" y="68">of</text>
                <text x="336" y="68">the</text>
                <text x="388" y="68">resource</text>
                <text x="436" y="68">/r</text>
                <text x="460" y="68">is</text>
                <text x="504" y="68">"1234")</text>
                <text x="236" y="100">Token:</text>
                <text x="284" y="100">0x4a</text>
                <text x="32" y="116">GET</text>
                <text x="244" y="116">Observe:</text>
                <text x="288" y="116">0</text>
                <text x="340" y="116">(register)</text>
                <text x="252" y="132">Proxy-Uri:</text>
                <text x="400" y="132">"coap://sensor.example/r"</text>
                <text x="236" y="164">Token:</text>
                <text x="284" y="164">0x5e</text>
                <text x="144" y="180">GET</text>
                <text x="244" y="180">Observe:</text>
                <text x="288" y="180">0</text>
                <text x="340" y="180">(register)</text>
                <text x="248" y="196">Uri-Host:</text>
                <text x="356" y="196">"sensor.example"</text>
                <text x="248" y="212">Uri-Path:</text>
                <text x="304" y="212">"r"</text>
                <text x="220" y="244">(S</text>
                <text x="272" y="244">allocates</text>
                <text x="328" y="244">the</text>
                <text x="384" y="244">available</text>
                <text x="448" y="244">Token</text>
                <text x="496" y="244">value</text>
                <text x="544" y="244">0x7b)</text>
                <text x="220" y="276">(S</text>
                <text x="256" y="276">sends</text>
                <text x="292" y="276">to</text>
                <text x="332" y="276">itself</text>
                <text x="368" y="276">a</text>
                <text x="408" y="276">phantom</text>
                <text x="488" y="276">observation</text>
                <text x="240" y="292">request</text>
                <text x="300" y="292">PH_REQ</text>
                <text x="340" y="292">as</text>
                <text x="380" y="292">coming</text>
                <text x="428" y="292">from</text>
                <text x="464" y="292">the</text>
                <text x="220" y="308">IP</text>
                <text x="272" y="308">multicast</text>
                <text x="344" y="308">address</text>
                <text x="416" y="308">GRP_ADDR)</text>
                <text x="236" y="388">Token:</text>
                <text x="284" y="388">0x7b</text>
                <text x="168" y="404">GET</text>
                <text x="244" y="404">Observe:</text>
                <text x="288" y="404">0</text>
                <text x="340" y="404">(register)</text>
                <text x="248" y="420">Uri-Host:</text>
                <text x="356" y="420">"sensor.example"</text>
                <text x="248" y="436">Uri-Path:</text>
                <text x="304" y="436">"r"</text>
                <text x="220" y="468">(S</text>
                <text x="264" y="468">creates</text>
                <text x="304" y="468">a</text>
                <text x="336" y="468">group</text>
                <text x="408" y="468">observation</text>
                <text x="468" y="468">of</text>
                <text x="496" y="468">/r)</text>
                <text x="220" y="500">(S</text>
                <text x="276" y="500">increments</text>
                <text x="336" y="500">the</text>
                <text x="388" y="500">observer</text>
                <text x="456" y="500">counter</text>
                <text x="224" y="516">for</text>
                <text x="256" y="516">the</text>
                <text x="296" y="516">group</text>
                <text x="368" y="516">observation</text>
                <text x="428" y="516">of</text>
                <text x="456" y="516">/r)</text>
                <text x="236" y="580">Token:</text>
                <text x="284" y="580">0x5e</text>
                <text x="148" y="596">5.03</text>
                <text x="272" y="596">Content-Format:</text>
                <text x="388" y="596">application/</text>
                <text x="336" y="612">informative-response+cbor</text>
                <text x="244" y="628">Max-Age:</text>
                <text x="288" y="628">0</text>
                <text x="236" y="644">&lt;Other</text>
                <text x="300" y="644">options&gt;</text>
                <text x="244" y="660">Payload:</text>
                <text x="288" y="660">{</text>
                <text x="232" y="676">/</text>
                <text x="272" y="676">tp_info</text>
                <text x="312" y="676">/</text>
                <text x="352" y="676">0</text>
                <text x="368" y="676">:</text>
                <text x="384" y="676">[</text>
                <text x="416" y="692">cri'coap://SRV_ADDR:SRV_PORT/',</text>
                <text x="432" y="708">cri'coap://GRP_ADDR:GRP_PORT/',</text>
                <text x="348" y="724">0x7b],</text>
                <text x="232" y="740">/</text>
                <text x="284" y="740">last_notif</text>
                <text x="336" y="740">/</text>
                <text x="352" y="740">2</text>
                <text x="368" y="740">:</text>
                <text x="416" y="740">bstr(0x45</text>
                <text x="464" y="740">|</text>
                <text x="488" y="740">OPT</text>
                <text x="512" y="740">|</text>
                <text x="540" y="740">0xff</text>
                <text x="568" y="740">|</text>
                <text x="452" y="756">PAYLOAD)</text>
                <text x="216" y="772">}</text>
                <text x="244" y="804">(PAYLOAD</text>
                <text x="292" y="804">in</text>
                <text x="356" y="804">'last_notif'</text>
                <text x="416" y="804">:</text>
                <text x="456" y="804">"1234")</text>
                <text x="228" y="852">(The</text>
                <text x="272" y="852">proxy</text>
                <text x="324" y="852">starts</text>
                <text x="392" y="852">listening</text>
                <text x="444" y="852">to</text>
                <text x="472" y="852">the</text>
                <text x="252" y="868">GRP_ADDR</text>
                <text x="320" y="868">address</text>
                <text x="368" y="868">and</text>
                <text x="400" y="868">the</text>
                <text x="452" y="868">GRP_PORT</text>
                <text x="516" y="868">port.)</text>
                <text x="228" y="900">(The</text>
                <text x="272" y="900">proxy</text>
                <text x="316" y="900">adds</text>
                <text x="348" y="900">C1</text>
                <text x="372" y="900">to</text>
                <text x="400" y="900">its</text>
                <text x="436" y="900">list</text>
                <text x="468" y="900">of</text>
                <text x="528" y="900">observers.)</text>
                <text x="236" y="932">Token:</text>
                <text x="284" y="932">0x4a</text>
                <text x="36" y="948">2.05</text>
                <text x="244" y="948">Observe:</text>
                <text x="304" y="948">54120</text>
                <text x="236" y="964">&lt;Other</text>
                <text x="300" y="964">options&gt;</text>
                <text x="244" y="980">Payload:</text>
                <text x="308" y="980">"1234"</text>
                <text x="16" y="1028">...</text>
                <text x="64" y="1028">...</text>
                <text x="120" y="1028">...</text>
                <text x="184" y="1028">...</text>
                <text x="236" y="1076">Token:</text>
                <text x="284" y="1076">0x01</text>
                <text x="88" y="1092">GET</text>
                <text x="244" y="1092">Observe:</text>
                <text x="288" y="1092">0</text>
                <text x="340" y="1092">(register)</text>
                <text x="252" y="1108">Proxy-Uri:</text>
                <text x="400" y="1108">"coap://sensor.example/r"</text>
                <text x="228" y="1140">(The</text>
                <text x="272" y="1140">proxy</text>
                <text x="312" y="1140">has</text>
                <text x="336" y="1140">a</text>
                <text x="368" y="1140">fresh</text>
                <text x="416" y="1140">cache</text>
                <text x="504" y="1140">representation)</text>
                <text x="236" y="1172">Token:</text>
                <text x="284" y="1172">0x01</text>
                <text x="92" y="1188">2.05</text>
                <text x="244" y="1188">Observe:</text>
                <text x="304" y="1188">54120</text>
                <text x="236" y="1204">&lt;Other</text>
                <text x="300" y="1204">options&gt;</text>
                <text x="244" y="1220">Payload:</text>
                <text x="308" y="1220">"1234"</text>
                <text x="16" y="1268">...</text>
                <text x="64" y="1268">...</text>
                <text x="120" y="1268">...</text>
                <text x="184" y="1268">...</text>
                <text x="228" y="1316">(The</text>
                <text x="272" y="1316">value</text>
                <text x="308" y="1316">of</text>
                <text x="336" y="1316">the</text>
                <text x="388" y="1316">resource</text>
                <text x="220" y="1332">/r</text>
                <text x="264" y="1332">changes</text>
                <text x="308" y="1332">to</text>
                <text x="356" y="1332">"5678".)</text>
                <text x="152" y="1364">(#)</text>
                <text x="236" y="1380">Token:</text>
                <text x="284" y="1380">0x7b</text>
                <text x="148" y="1396">2.05</text>
                <text x="244" y="1396">Observe:</text>
                <text x="292" y="1396">11</text>
                <text x="236" y="1412">&lt;Other</text>
                <text x="300" y="1412">options&gt;</text>
                <text x="244" y="1428">Payload:</text>
                <text x="308" y="1428">"5678"</text>
                <text x="236" y="1460">Token:</text>
                <text x="284" y="1460">0x4a</text>
                <text x="36" y="1476">2.05</text>
                <text x="244" y="1476">Observe:</text>
                <text x="304" y="1476">54123</text>
                <text x="236" y="1492">&lt;Other</text>
                <text x="300" y="1492">options&gt;</text>
                <text x="244" y="1508">Payload:</text>
                <text x="308" y="1508">"5678"</text>
                <text x="236" y="1540">Token:</text>
                <text x="284" y="1540">0x01</text>
                <text x="92" y="1556">2.05</text>
                <text x="244" y="1556">Observe:</text>
                <text x="304" y="1556">54123</text>
                <text x="236" y="1572">&lt;Other</text>
                <text x="300" y="1572">options&gt;</text>
                <text x="244" y="1588">Payload:</text>
                <text x="308" y="1588">"5678"</text>
                <text x="16" y="1652">(#)</text>
                <text x="52" y="1652">Sent</text>
                <text x="92" y="1652">over</text>
                <text x="124" y="1652">IP</text>
                <text x="176" y="1652">multicast</text>
                <text x="228" y="1652">to</text>
                <text x="332" y="1652">GROUP_ADDR:GROUP_PORT.</text>
              </g>
            </svg><a href="#appendix-E-3.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-example-of-group-observation-" class="selfRef">Example of Group Observation with a Proxy</a>
        </figcaption></figure>
</div>
<p id="appendix-E-4">Note that the proxy has all the information to understand the observation request from C2, and can immediately start to serve the still fresh values.<a href="#appendix-E-4" class="pilcrow">¶</a></p>
<p id="appendix-E-5">This behavior is mandated by <span><a href="https://rfc-editor.org/rfc/rfc7641#section-5" class="relref">Section 5</a> of [<a href="#RFC7641" class="cite xref">RFC7641</a>]</span>, i.e., the proxy registers itself only once with the next hop and fans out the notifications it receives to all the registered clients.<a href="#appendix-E-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="intermediaries-example-e2e-security">
<section id="appendix-F">
      <h2 id="name-example-with-a-proxy-and-gr">
<a href="#appendix-F" class="section-number selfRef">Appendix F. </a><a href="#name-example-with-a-proxy-and-gr" class="section-name selfRef">Example with a Proxy and Group OSCORE</a>
      </h2>
<p id="appendix-F-1">This section provides an example when a proxy P is used between the clients and the server, and Group OSCORE is used to protect multicast notifications end-to-end between the server and the clients.<a href="#appendix-F-1" class="pilcrow">¶</a></p>
<p id="appendix-F-2">The same assumptions and notation used in <a href="#sec-example-with-security" class="auto internal xref">Section 10</a> are used for this example. In addition, the proxy has address PRX_ADDR and listens to the port number PRX_PORT.<a href="#appendix-F-2" class="pilcrow">¶</a></p>
<p id="appendix-F-3">Unless explicitly indicated, all messages transmitted on the wire are sent over unicast and protected with OSCORE end-to-end between a client and the server.<a href="#appendix-F-3" class="pilcrow">¶</a></p>
<span id="name-example-of-group-observation-w"></span><div id="example-proxy-oscore">
<figure id="figure-11">
        <div id="appendix-F-4.1">
          <div class="alignLeft art-svg artwork" id="appendix-F-4.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="4304" width="576" viewBox="0 0 576 4304" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 8,48 L 8,2096" fill="none" stroke="black"></path>
              <path d="M 8,2160 L 8,3600" fill="none" stroke="black"></path>
              <path d="M 8,3664 L 8,4176" fill="none" stroke="black"></path>
              <path d="M 72,48 L 72,88" fill="none" stroke="black"></path>
              <path d="M 72,104 L 72,1528" fill="none" stroke="black"></path>
              <path d="M 72,1544 L 72,1640" fill="none" stroke="black"></path>
              <path d="M 72,1656 L 72,2072" fill="none" stroke="black"></path>
              <path d="M 72,2160 L 72,3600" fill="none" stroke="black"></path>
              <path d="M 72,3664 L 72,3960" fill="none" stroke="black"></path>
              <path d="M 72,3976 L 72,4176" fill="none" stroke="black"></path>
              <path d="M 136,48 L 136,2096" fill="none" stroke="black"></path>
              <path d="M 136,2160 L 136,3600" fill="none" stroke="black"></path>
              <path d="M 136,3664 L 136,4176" fill="none" stroke="black"></path>
              <path d="M 216,48 L 216,2096" fill="none" stroke="black"></path>
              <path d="M 216,2160 L 216,3600" fill="none" stroke="black"></path>
              <path d="M 216,3664 L 216,4176" fill="none" stroke="black"></path>
              <path d="M 8,96 L 128,96" fill="none" stroke="black"></path>
              <path d="M 136,320 L 208,320" fill="none" stroke="black"></path>
              <path d="M 160,656 L 216,656" fill="none" stroke="black"></path>
              <path d="M 160,704 L 208,704" fill="none" stroke="black"></path>
              <path d="M 440,960 L 456,960" fill="none" stroke="black"></path>
              <path d="M 144,1088 L 216,1088" fill="none" stroke="black"></path>
              <path d="M 16,1536 L 136,1536" fill="none" stroke="black"></path>
              <path d="M 8,1648 L 128,1648" fill="none" stroke="black"></path>
              <path d="M 16,2080 L 136,2080" fill="none" stroke="black"></path>
              <path d="M 72,2176 L 128,2176" fill="none" stroke="black"></path>
              <path d="M 136,2400 L 208,2400" fill="none" stroke="black"></path>
              <path d="M 144,2656 L 216,2656" fill="none" stroke="black"></path>
              <path d="M 80,3104 L 136,3104" fill="none" stroke="black"></path>
              <path d="M 72,3200 L 128,3200" fill="none" stroke="black"></path>
              <path d="M 80,3568 L 136,3568" fill="none" stroke="black"></path>
              <path d="M 144,3744 L 216,3744" fill="none" stroke="black"></path>
              <path d="M 16,3968 L 136,3968" fill="none" stroke="black"></path>
              <path d="M 80,4080 L 136,4080" fill="none" stroke="black"></path>
              <path d="M 148,680 L 160,704" fill="none" stroke="black"></path>
              <path d="M 148,680 L 160,656" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="448,960 436,954.4 436,965.6" fill="black" transform="rotate(180,440,960)"></polygon>
              <polygon class="arrowhead" points="216,2400 204,2394.4 204,2405.6" fill="black" transform="rotate(0,208,2400)"></polygon>
              <polygon class="arrowhead" points="216,704 204,698.4 204,709.6" fill="black" transform="rotate(0,208,704)"></polygon>
              <polygon class="arrowhead" points="216,320 204,314.4 204,325.6" fill="black" transform="rotate(0,208,320)"></polygon>
              <polygon class="arrowhead" points="152,3744 140,3738.4 140,3749.6" fill="black" transform="rotate(180,144,3744)"></polygon>
              <polygon class="arrowhead" points="152,2656 140,2650.4 140,2661.6" fill="black" transform="rotate(180,144,2656)"></polygon>
              <polygon class="arrowhead" points="152,1088 140,1082.4 140,1093.6" fill="black" transform="rotate(180,144,1088)"></polygon>
              <polygon class="arrowhead" points="136,3200 124,3194.4 124,3205.6" fill="black" transform="rotate(0,128,3200)"></polygon>
              <polygon class="arrowhead" points="136,2176 124,2170.4 124,2181.6" fill="black" transform="rotate(0,128,2176)"></polygon>
              <polygon class="arrowhead" points="136,1648 124,1642.4 124,1653.6" fill="black" transform="rotate(0,128,1648)"></polygon>
              <polygon class="arrowhead" points="136,96 124,90.4 124,101.6" fill="black" transform="rotate(0,128,96)"></polygon>
              <polygon class="arrowhead" points="88,4080 76,4074.4 76,4085.6" fill="black" transform="rotate(180,80,4080)"></polygon>
              <polygon class="arrowhead" points="88,3568 76,3562.4 76,3573.6" fill="black" transform="rotate(180,80,3568)"></polygon>
              <polygon class="arrowhead" points="88,3104 76,3098.4 76,3109.6" fill="black" transform="rotate(180,80,3104)"></polygon>
              <polygon class="arrowhead" points="24,3968 12,3962.4 12,3973.6" fill="black" transform="rotate(180,16,3968)"></polygon>
              <polygon class="arrowhead" points="24,2080 12,2074.4 12,2085.6" fill="black" transform="rotate(180,16,2080)"></polygon>
              <polygon class="arrowhead" points="24,1536 12,1530.4 12,1541.6" fill="black" transform="rotate(180,16,1536)"></polygon>
              <g class="text">
                <text x="12" y="36">C1</text>
                <text x="76" y="36">C2</text>
                <text x="136" y="36">P</text>
                <text x="216" y="36">S</text>
                <text x="252" y="68">(The</text>
                <text x="296" y="68">value</text>
                <text x="332" y="68">of</text>
                <text x="360" y="68">the</text>
                <text x="412" y="68">resource</text>
                <text x="460" y="68">/r</text>
                <text x="484" y="68">is</text>
                <text x="528" y="68">"1234")</text>
                <text x="260" y="100">Token:</text>
                <text x="308" y="100">0x4a</text>
                <text x="40" y="116">FETCH</text>
                <text x="268" y="116">Observe:</text>
                <text x="312" y="116">0</text>
                <text x="364" y="116">(register)</text>
                <text x="264" y="132">OSCORE:</text>
                <text x="320" y="132">{kid:</text>
                <text x="368" y="132">0x01;</text>
                <text x="412" y="132">piv:</text>
                <text x="452" y="132">101;</text>
                <text x="492" y="132">...}</text>
                <text x="272" y="148">Uri-Host:</text>
                <text x="380" y="148">"sensor.example"</text>
                <text x="288" y="164">Proxy-Scheme:</text>
                <text x="372" y="164">"coap"</text>
                <text x="260" y="180">&lt;Other</text>
                <text x="312" y="180">class</text>
                <text x="352" y="180">U/I</text>
                <text x="404" y="180">options&gt;</text>
                <text x="252" y="196">0xff</text>
                <text x="304" y="212">Encrypted_payload</text>
                <text x="384" y="212">{</text>
                <text x="268" y="228">0x01</text>
                <text x="316" y="228">(GET),</text>
                <text x="284" y="244">Observe:</text>
                <text x="328" y="244">0</text>
                <text x="384" y="244">(register),</text>
                <text x="288" y="260">Uri-Path:</text>
                <text x="348" y="260">"r",</text>
                <text x="276" y="276">&lt;Other</text>
                <text x="328" y="276">class</text>
                <text x="360" y="276">E</text>
                <text x="404" y="276">options&gt;</text>
                <text x="240" y="292">}</text>
                <text x="260" y="324">Token:</text>
                <text x="308" y="324">0x5e</text>
                <text x="168" y="340">FETCH</text>
                <text x="268" y="340">Observe:</text>
                <text x="312" y="340">0</text>
                <text x="364" y="340">(register)</text>
                <text x="264" y="356">OSCORE:</text>
                <text x="320" y="356">{kid:</text>
                <text x="368" y="356">0x01;</text>
                <text x="412" y="356">piv:</text>
                <text x="452" y="356">101;</text>
                <text x="492" y="356">...}</text>
                <text x="272" y="372">Uri-Host:</text>
                <text x="380" y="372">"sensor.example"</text>
                <text x="260" y="388">&lt;Other</text>
                <text x="312" y="388">class</text>
                <text x="352" y="388">U/I</text>
                <text x="404" y="388">options&gt;</text>
                <text x="252" y="404">0xff</text>
                <text x="304" y="420">Encrypted_payload</text>
                <text x="384" y="420">{</text>
                <text x="268" y="436">0x01</text>
                <text x="316" y="436">(GET),</text>
                <text x="284" y="452">Observe:</text>
                <text x="328" y="452">0</text>
                <text x="384" y="452">(register),</text>
                <text x="288" y="468">Uri-Path:</text>
                <text x="348" y="468">"r",</text>
                <text x="276" y="484">&lt;Other</text>
                <text x="328" y="484">class</text>
                <text x="360" y="484">E</text>
                <text x="404" y="484">options&gt;</text>
                <text x="240" y="500">}</text>
                <text x="244" y="548">(S</text>
                <text x="296" y="548">allocates</text>
                <text x="352" y="548">the</text>
                <text x="408" y="548">available</text>
                <text x="264" y="564">Token</text>
                <text x="312" y="564">value</text>
                <text x="356" y="564">0x7b</text>
                <text x="388" y="564">.)</text>
                <text x="244" y="596">(S</text>
                <text x="280" y="596">sends</text>
                <text x="316" y="596">to</text>
                <text x="356" y="596">itself</text>
                <text x="392" y="596">a</text>
                <text x="432" y="596">phantom</text>
                <text x="512" y="596">observation</text>
                <text x="264" y="612">request</text>
                <text x="324" y="612">PH_REQ</text>
                <text x="364" y="612">as</text>
                <text x="404" y="612">coming</text>
                <text x="452" y="612">from</text>
                <text x="488" y="612">the</text>
                <text x="244" y="628">IP</text>
                <text x="296" y="628">multicast</text>
                <text x="368" y="628">address</text>
                <text x="440" y="628">GRP_ADDR)</text>
                <text x="184" y="644">(#)</text>
                <text x="260" y="708">Token:</text>
                <text x="308" y="708">0x7b</text>
                <text x="184" y="724">FETCH</text>
                <text x="268" y="724">Observe:</text>
                <text x="312" y="724">0</text>
                <text x="364" y="724">(register)</text>
                <text x="264" y="740">OSCORE:</text>
                <text x="320" y="740">{kid:</text>
                <text x="368" y="740">0x05;</text>
                <text x="412" y="740">piv:</text>
                <text x="452" y="740">501;</text>
                <text x="320" y="756">kid</text>
                <text x="372" y="756">context:</text>
                <text x="448" y="756">0x57ab2e;</text>
                <text x="508" y="756">...}</text>
                <text x="272" y="772">Uri-Host:</text>
                <text x="380" y="772">"sensor.example"</text>
                <text x="260" y="788">&lt;Other</text>
                <text x="312" y="788">class</text>
                <text x="352" y="788">U/I</text>
                <text x="404" y="788">options&gt;</text>
                <text x="252" y="804">0xff</text>
                <text x="304" y="820">Encrypted_payload</text>
                <text x="384" y="820">{</text>
                <text x="268" y="836">0x01</text>
                <text x="316" y="836">(GET),</text>
                <text x="284" y="852">Observe:</text>
                <text x="328" y="852">0</text>
                <text x="384" y="852">(register),</text>
                <text x="288" y="868">Uri-Path:</text>
                <text x="348" y="868">"r",</text>
                <text x="276" y="884">&lt;Other</text>
                <text x="328" y="884">class</text>
                <text x="360" y="884">E</text>
                <text x="404" y="884">options&gt;</text>
                <text x="240" y="900">}</text>
                <text x="280" y="916">&lt;Signature&gt;</text>
                <text x="244" y="948">(S</text>
                <text x="280" y="948">steps</text>
                <text x="324" y="948">SN_5</text>
                <text x="356" y="948">in</text>
                <text x="384" y="948">the</text>
                <text x="424" y="948">Group</text>
                <text x="476" y="948">OSCORE</text>
                <text x="276" y="964">Security</text>
                <text x="344" y="964">Context</text>
                <text x="384" y="964">:</text>
                <text x="412" y="964">SN_5</text>
                <text x="484" y="964">502)</text>
                <text x="244" y="996">(S</text>
                <text x="288" y="996">creates</text>
                <text x="328" y="996">a</text>
                <text x="360" y="996">group</text>
                <text x="432" y="996">observation</text>
                <text x="492" y="996">of</text>
                <text x="520" y="996">/r)</text>
                <text x="244" y="1044">(S</text>
                <text x="300" y="1044">increments</text>
                <text x="360" y="1044">the</text>
                <text x="412" y="1044">observer</text>
                <text x="480" y="1044">counter</text>
                <text x="248" y="1060">for</text>
                <text x="280" y="1060">the</text>
                <text x="320" y="1060">group</text>
                <text x="392" y="1060">observation</text>
                <text x="452" y="1060">of</text>
                <text x="480" y="1060">/r)</text>
                <text x="260" y="1092">Token:</text>
                <text x="308" y="1092">0x5e</text>
                <text x="164" y="1108">2.05</text>
                <text x="264" y="1108">OSCORE:</text>
                <text x="320" y="1108">{piv:</text>
                <text x="364" y="1108">301;</text>
                <text x="404" y="1108">...}</text>
                <text x="268" y="1124">Max-Age:</text>
                <text x="312" y="1124">0</text>
                <text x="260" y="1140">&lt;Other</text>
                <text x="312" y="1140">class</text>
                <text x="352" y="1140">U/I</text>
                <text x="404" y="1140">options&gt;</text>
                <text x="252" y="1156">0xff</text>
                <text x="304" y="1172">Encrypted_payload</text>
                <text x="384" y="1172">{</text>
                <text x="268" y="1188">5.03</text>
                <text x="324" y="1188">(Service</text>
                <text x="416" y="1188">Unavailable),</text>
                <text x="312" y="1204">Content-Format:</text>
                <text x="428" y="1204">application/</text>
                <text x="380" y="1220">informative-response+cbor,</text>
                <text x="276" y="1236">&lt;Other</text>
                <text x="328" y="1236">class</text>
                <text x="360" y="1236">E</text>
                <text x="408" y="1236">options&gt;,</text>
                <text x="272" y="1252">0xff,</text>
                <text x="280" y="1268">Payload</text>
                <text x="320" y="1268">{</text>
                <text x="272" y="1284">/</text>
                <text x="312" y="1284">tp_info</text>
                <text x="352" y="1284">/</text>
                <text x="392" y="1284">0</text>
                <text x="408" y="1284">:</text>
                <text x="424" y="1284">[</text>
                <text x="432" y="1300">cri'coap://SRV_ADDR:SRV_PORT/',</text>
                <text x="448" y="1316">cri'coap://GRP_ADDR:GRP_PORT/',</text>
                <text x="364" y="1332">0x7b],</text>
                <text x="272" y="1348">/</text>
                <text x="308" y="1348">ph_req</text>
                <text x="344" y="1348">/</text>
                <text x="392" y="1348">1</text>
                <text x="408" y="1348">:</text>
                <text x="456" y="1348">bstr(0x05</text>
                <text x="504" y="1348">|</text>
                <text x="440" y="1364">OPT</text>
                <text x="464" y="1364">|</text>
                <text x="492" y="1364">0xff</text>
                <text x="520" y="1364">|</text>
                <text x="456" y="1380">PAYLOAD</text>
                <text x="496" y="1380">|</text>
                <text x="532" y="1380">SIGN),</text>
                <text x="272" y="1396">/</text>
                <text x="324" y="1396">last_notif</text>
                <text x="376" y="1396">/</text>
                <text x="392" y="1396">2</text>
                <text x="408" y="1396">:</text>
                <text x="456" y="1396">bstr(0x45</text>
                <text x="504" y="1396">|</text>
                <text x="440" y="1412">OPT</text>
                <text x="464" y="1412">|</text>
                <text x="492" y="1412">0xff</text>
                <text x="520" y="1412">|</text>
                <text x="456" y="1428">PAYLOAD</text>
                <text x="496" y="1428">|</text>
                <text x="532" y="1428">SIGN),</text>
                <text x="272" y="1444">/</text>
                <text x="316" y="1444">join_uri</text>
                <text x="360" y="1444">/</text>
                <text x="392" y="1444">4</text>
                <text x="408" y="1444">:</text>
                <text x="472" y="1444">"coap://myGM/</text>
                <text x="496" y="1460">ace-group/myGroup",</text>
                <text x="272" y="1476">/</text>
                <text x="308" y="1476">sec_gp</text>
                <text x="344" y="1476">/</text>
                <text x="392" y="1476">5</text>
                <text x="408" y="1476">:</text>
                <text x="456" y="1476">"myGroup"</text>
                <text x="256" y="1492">}</text>
                <text x="240" y="1508">}</text>
                <text x="260" y="1540">Token:</text>
                <text x="308" y="1540">0x4a</text>
                <text x="36" y="1556">2.05</text>
                <text x="264" y="1556">OSCORE:</text>
                <text x="320" y="1556">{piv:</text>
                <text x="364" y="1556">301;</text>
                <text x="404" y="1556">...}</text>
                <text x="260" y="1572">&lt;Other</text>
                <text x="312" y="1572">class</text>
                <text x="352" y="1572">U/I</text>
                <text x="404" y="1572">options&gt;</text>
                <text x="252" y="1588">0xff</text>
                <text x="256" y="1604">(Same</text>
                <text x="356" y="1604">Encrypted_payload)</text>
                <text x="40" y="1636">(#)</text>
                <text x="260" y="1652">Token:</text>
                <text x="308" y="1652">0x4b</text>
                <text x="40" y="1668">FETCH</text>
                <text x="268" y="1668">Observe:</text>
                <text x="312" y="1668">0</text>
                <text x="364" y="1668">(register)</text>
                <text x="264" y="1684">OSCORE:</text>
                <text x="320" y="1684">{kid:</text>
                <text x="364" y="1684">0x05</text>
                <text x="392" y="1684">;</text>
                <text x="420" y="1684">piv:</text>
                <text x="460" y="1684">501;</text>
                <text x="320" y="1700">kid</text>
                <text x="372" y="1700">context:</text>
                <text x="448" y="1700">0x57ab2e;</text>
                <text x="508" y="1700">...}</text>
                <text x="272" y="1716">Uri-Host:</text>
                <text x="380" y="1716">"sensor.example"</text>
                <text x="288" y="1732">Proxy-Scheme:</text>
                <text x="372" y="1732">"coap"</text>
                <text x="356" y="1748">Listen-To-Multicast-Responses:</text>
                <text x="488" y="1748">{</text>
                <text x="380" y="1764">[cri'coap://SRV_ADDR:SRV_PORT/',</text>
                <text x="400" y="1780">cri'coap://GRP_ADDR:GRP_PORT/',</text>
                <text x="312" y="1796">0x7b]</text>
                <text x="240" y="1812">}</text>
                <text x="260" y="1828">&lt;Other</text>
                <text x="312" y="1828">class</text>
                <text x="352" y="1828">U/I</text>
                <text x="404" y="1828">options&gt;</text>
                <text x="252" y="1844">0xff</text>
                <text x="304" y="1860">Encrypted_payload</text>
                <text x="384" y="1860">{</text>
                <text x="268" y="1876">0x01</text>
                <text x="316" y="1876">(GET),</text>
                <text x="284" y="1892">Observe:</text>
                <text x="328" y="1892">0</text>
                <text x="384" y="1892">(register),</text>
                <text x="288" y="1908">Uri-Path:</text>
                <text x="348" y="1908">"r",</text>
                <text x="276" y="1924">&lt;Other</text>
                <text x="328" y="1924">class</text>
                <text x="360" y="1924">E</text>
                <text x="404" y="1924">options&gt;</text>
                <text x="240" y="1940">}</text>
                <text x="280" y="1956">&lt;Signature&gt;</text>
                <text x="252" y="1988">(The</text>
                <text x="296" y="1988">proxy</text>
                <text x="348" y="1988">starts</text>
                <text x="416" y="1988">listening</text>
                <text x="468" y="1988">to</text>
                <text x="496" y="1988">the</text>
                <text x="276" y="2004">GRP_ADDR</text>
                <text x="344" y="2004">address</text>
                <text x="392" y="2004">and</text>
                <text x="424" y="2004">the</text>
                <text x="476" y="2004">GRP_PORT</text>
                <text x="540" y="2004">port.)</text>
                <text x="252" y="2036">(The</text>
                <text x="296" y="2036">proxy</text>
                <text x="340" y="2036">adds</text>
                <text x="372" y="2036">C1</text>
                <text x="396" y="2036">to</text>
                <text x="256" y="2052">its</text>
                <text x="292" y="2052">list</text>
                <text x="324" y="2052">of</text>
                <text x="384" y="2052">observers.)</text>
                <text x="72" y="2100">|</text>
                <text x="104" y="2100">ACK</text>
                <text x="16" y="2132">...</text>
                <text x="72" y="2132">...</text>
                <text x="136" y="2132">...</text>
                <text x="208" y="2132">...</text>
                <text x="260" y="2180">Token:</text>
                <text x="308" y="2180">0x01</text>
                <text x="104" y="2196">FETCH</text>
                <text x="268" y="2196">Observe:</text>
                <text x="312" y="2196">0</text>
                <text x="364" y="2196">(register)</text>
                <text x="264" y="2212">OSCORE:</text>
                <text x="320" y="2212">{kid:</text>
                <text x="368" y="2212">0x02;</text>
                <text x="412" y="2212">piv:</text>
                <text x="452" y="2212">201;</text>
                <text x="492" y="2212">...}</text>
                <text x="272" y="2228">Uri-Host:</text>
                <text x="380" y="2228">"sensor.example"</text>
                <text x="288" y="2244">Proxy-Scheme:</text>
                <text x="372" y="2244">"coap"</text>
                <text x="260" y="2260">&lt;Other</text>
                <text x="312" y="2260">class</text>
                <text x="352" y="2260">U/I</text>
                <text x="404" y="2260">options&gt;</text>
                <text x="252" y="2276">0xff</text>
                <text x="304" y="2292">Encrypted_payload</text>
                <text x="384" y="2292">{</text>
                <text x="268" y="2308">0x01</text>
                <text x="316" y="2308">(GET),</text>
                <text x="284" y="2324">Observe:</text>
                <text x="328" y="2324">0</text>
                <text x="384" y="2324">(register),</text>
                <text x="288" y="2340">Uri-Path:</text>
                <text x="348" y="2340">"r",</text>
                <text x="276" y="2356">&lt;Other</text>
                <text x="328" y="2356">class</text>
                <text x="360" y="2356">E</text>
                <text x="404" y="2356">options&gt;</text>
                <text x="240" y="2372">}</text>
                <text x="260" y="2404">Token:</text>
                <text x="308" y="2404">0x5f</text>
                <text x="168" y="2420">FETCH</text>
                <text x="268" y="2420">Observe:</text>
                <text x="312" y="2420">0</text>
                <text x="364" y="2420">(register)</text>
                <text x="264" y="2436">OSCORE:</text>
                <text x="320" y="2436">{kid:</text>
                <text x="368" y="2436">0x02;</text>
                <text x="412" y="2436">piv:</text>
                <text x="452" y="2436">201;</text>
                <text x="492" y="2436">...}</text>
                <text x="272" y="2452">Uri-Host:</text>
                <text x="380" y="2452">"sensor.example"</text>
                <text x="260" y="2468">&lt;Other</text>
                <text x="312" y="2468">class</text>
                <text x="352" y="2468">U/I</text>
                <text x="404" y="2468">options&gt;</text>
                <text x="252" y="2484">0xff</text>
                <text x="304" y="2500">Encrypted_payload</text>
                <text x="384" y="2500">{</text>
                <text x="268" y="2516">0x01</text>
                <text x="316" y="2516">(GET),</text>
                <text x="284" y="2532">Observe:</text>
                <text x="328" y="2532">0</text>
                <text x="384" y="2532">(register),</text>
                <text x="288" y="2548">Uri-Path:</text>
                <text x="348" y="2548">"r",</text>
                <text x="276" y="2564">&lt;Other</text>
                <text x="328" y="2564">class</text>
                <text x="360" y="2564">E</text>
                <text x="404" y="2564">options&gt;</text>
                <text x="240" y="2580">}</text>
                <text x="244" y="2612">(S</text>
                <text x="300" y="2612">increments</text>
                <text x="360" y="2612">the</text>
                <text x="412" y="2612">observer</text>
                <text x="480" y="2612">counter</text>
                <text x="248" y="2628">for</text>
                <text x="280" y="2628">the</text>
                <text x="320" y="2628">group</text>
                <text x="392" y="2628">observation</text>
                <text x="452" y="2628">of</text>
                <text x="480" y="2628">/r)</text>
                <text x="260" y="2660">Token:</text>
                <text x="308" y="2660">0x5f</text>
                <text x="164" y="2676">2.05</text>
                <text x="264" y="2676">OSCORE:</text>
                <text x="320" y="2676">{piv:</text>
                <text x="364" y="2676">401;</text>
                <text x="404" y="2676">...}</text>
                <text x="268" y="2692">Max-Age:</text>
                <text x="312" y="2692">0</text>
                <text x="260" y="2708">&lt;Other</text>
                <text x="312" y="2708">class</text>
                <text x="352" y="2708">U/I</text>
                <text x="404" y="2708">options&gt;</text>
                <text x="252" y="2724">0xff</text>
                <text x="304" y="2740">Encrypted_payload</text>
                <text x="384" y="2740">{</text>
                <text x="268" y="2756">5.03</text>
                <text x="324" y="2756">(Service</text>
                <text x="416" y="2756">Unavailable),</text>
                <text x="312" y="2772">Content-Format:</text>
                <text x="428" y="2772">application/</text>
                <text x="380" y="2788">informative-response+cbor,</text>
                <text x="276" y="2804">&lt;Other</text>
                <text x="328" y="2804">class</text>
                <text x="360" y="2804">E</text>
                <text x="408" y="2804">options&gt;,</text>
                <text x="272" y="2820">0xff,</text>
                <text x="280" y="2836">Payload</text>
                <text x="320" y="2836">{</text>
                <text x="272" y="2852">/</text>
                <text x="312" y="2852">tp_info</text>
                <text x="352" y="2852">/</text>
                <text x="392" y="2852">0</text>
                <text x="408" y="2852">:</text>
                <text x="424" y="2852">[</text>
                <text x="432" y="2868">cri'coap://SRV_ADDR:SRV_PORT/',</text>
                <text x="448" y="2884">cri'coap://GRP_ADDR:GRP_PORT/',</text>
                <text x="364" y="2900">0x7b],</text>
                <text x="272" y="2916">/</text>
                <text x="308" y="2916">ph_req</text>
                <text x="344" y="2916">/</text>
                <text x="392" y="2916">1</text>
                <text x="408" y="2916">:</text>
                <text x="456" y="2916">bstr(0x05</text>
                <text x="504" y="2916">|</text>
                <text x="440" y="2932">OPT</text>
                <text x="464" y="2932">|</text>
                <text x="492" y="2932">0xff</text>
                <text x="520" y="2932">|</text>
                <text x="456" y="2948">PAYLOAD</text>
                <text x="496" y="2948">|</text>
                <text x="532" y="2948">SIGN),</text>
                <text x="272" y="2964">/</text>
                <text x="324" y="2964">last_notif</text>
                <text x="376" y="2964">/</text>
                <text x="392" y="2964">2</text>
                <text x="408" y="2964">:</text>
                <text x="456" y="2964">bstr(0x45</text>
                <text x="504" y="2964">|</text>
                <text x="440" y="2980">OPT</text>
                <text x="464" y="2980">|</text>
                <text x="492" y="2980">0xff</text>
                <text x="520" y="2980">|</text>
                <text x="456" y="2996">PAYLOAD</text>
                <text x="496" y="2996">|</text>
                <text x="532" y="2996">SIGN),</text>
                <text x="272" y="3012">/</text>
                <text x="316" y="3012">join_uri</text>
                <text x="360" y="3012">/</text>
                <text x="392" y="3012">4</text>
                <text x="408" y="3012">:</text>
                <text x="472" y="3012">"coap://myGM/</text>
                <text x="496" y="3028">ace-group/myGroup",</text>
                <text x="272" y="3044">/</text>
                <text x="308" y="3044">sec_gp</text>
                <text x="344" y="3044">/</text>
                <text x="392" y="3044">5</text>
                <text x="408" y="3044">:</text>
                <text x="456" y="3044">"myGroup"</text>
                <text x="256" y="3060">}</text>
                <text x="240" y="3076">}</text>
                <text x="260" y="3108">Token:</text>
                <text x="308" y="3108">0x01</text>
                <text x="100" y="3124">2.05</text>
                <text x="264" y="3124">OSCORE:</text>
                <text x="320" y="3124">{piv:</text>
                <text x="364" y="3124">401;</text>
                <text x="404" y="3124">...}</text>
                <text x="260" y="3140">&lt;Other</text>
                <text x="312" y="3140">class</text>
                <text x="352" y="3140">U/I</text>
                <text x="404" y="3140">options&gt;</text>
                <text x="252" y="3156">0xff</text>
                <text x="256" y="3172">(Same</text>
                <text x="356" y="3172">Encrypted_payload)</text>
                <text x="104" y="3188">(#)</text>
                <text x="260" y="3204">Token:</text>
                <text x="308" y="3204">0x02</text>
                <text x="104" y="3220">FETCH</text>
                <text x="268" y="3220">Observe:</text>
                <text x="312" y="3220">0</text>
                <text x="364" y="3220">(register)</text>
                <text x="264" y="3236">OSCORE:</text>
                <text x="320" y="3236">{kid:</text>
                <text x="368" y="3236">0x05;</text>
                <text x="412" y="3236">piv:</text>
                <text x="452" y="3236">501;</text>
                <text x="320" y="3252">kid</text>
                <text x="372" y="3252">context:</text>
                <text x="440" y="3252">57ab2e;</text>
                <text x="492" y="3252">...}</text>
                <text x="272" y="3268">Uri-Host:</text>
                <text x="380" y="3268">"sensor.example"</text>
                <text x="288" y="3284">Proxy-Scheme:</text>
                <text x="372" y="3284">"coap"</text>
                <text x="356" y="3300">Listen-To-Multicast-Responses:</text>
                <text x="488" y="3300">{</text>
                <text x="380" y="3316">[cri'coap://SRV_ADDR:SRV_PORT/',</text>
                <text x="400" y="3332">cri'coap://GRP_ADDR:GRP_PORT/',</text>
                <text x="312" y="3348">0x7b]</text>
                <text x="240" y="3364">}</text>
                <text x="260" y="3380">&lt;Other</text>
                <text x="312" y="3380">class</text>
                <text x="352" y="3380">U/I</text>
                <text x="404" y="3380">options&gt;</text>
                <text x="252" y="3396">0xff</text>
                <text x="304" y="3412">Encrypted_payload</text>
                <text x="384" y="3412">{</text>
                <text x="268" y="3428">0x01</text>
                <text x="316" y="3428">(GET),</text>
                <text x="284" y="3444">Observe:</text>
                <text x="328" y="3444">0</text>
                <text x="384" y="3444">(register),</text>
                <text x="288" y="3460">Uri-Path:</text>
                <text x="348" y="3460">"r",</text>
                <text x="276" y="3476">&lt;Other</text>
                <text x="328" y="3476">class</text>
                <text x="360" y="3476">E</text>
                <text x="404" y="3476">options&gt;</text>
                <text x="240" y="3492">}</text>
                <text x="280" y="3508">&lt;Signature&gt;</text>
                <text x="252" y="3540">(The</text>
                <text x="296" y="3540">proxy</text>
                <text x="340" y="3540">adds</text>
                <text x="372" y="3540">C2</text>
                <text x="396" y="3540">to</text>
                <text x="256" y="3556">its</text>
                <text x="292" y="3556">list</text>
                <text x="324" y="3556">of</text>
                <text x="384" y="3556">observers.)</text>
                <text x="104" y="3588">ACK</text>
                <text x="16" y="3636">...</text>
                <text x="72" y="3636">...</text>
                <text x="136" y="3636">...</text>
                <text x="208" y="3636">...</text>
                <text x="252" y="3684">(The</text>
                <text x="296" y="3684">value</text>
                <text x="332" y="3684">of</text>
                <text x="360" y="3684">the</text>
                <text x="412" y="3684">resource</text>
                <text x="252" y="3700">/r</text>
                <text x="296" y="3700">changes</text>
                <text x="340" y="3700">to</text>
                <text x="388" y="3700">"5678".)</text>
                <text x="180" y="3732">(##)</text>
                <text x="260" y="3748">Token:</text>
                <text x="308" y="3748">0x7b</text>
                <text x="164" y="3764">2.05</text>
                <text x="268" y="3764">Observe:</text>
                <text x="316" y="3764">11</text>
                <text x="264" y="3780">OSCORE:</text>
                <text x="320" y="3780">{kid:</text>
                <text x="368" y="3780">0x05;</text>
                <text x="412" y="3780">piv:</text>
                <text x="452" y="3780">502;</text>
                <text x="492" y="3780">...}</text>
                <text x="260" y="3796">&lt;Other</text>
                <text x="312" y="3796">class</text>
                <text x="352" y="3796">U/I</text>
                <text x="404" y="3796">options&gt;</text>
                <text x="252" y="3812">0xff</text>
                <text x="304" y="3828">Encrypted_payload</text>
                <text x="384" y="3828">{</text>
                <text x="268" y="3844">2.05</text>
                <text x="332" y="3844">(Content),</text>
                <text x="284" y="3860">Observe:</text>
                <text x="356" y="3860">[empty],</text>
                <text x="276" y="3876">&lt;Other</text>
                <text x="328" y="3876">class</text>
                <text x="360" y="3876">E</text>
                <text x="408" y="3876">options&gt;,</text>
                <text x="272" y="3892">0xff,</text>
                <text x="284" y="3908">Payload:</text>
                <text x="348" y="3908">"5678"</text>
                <text x="240" y="3924">}</text>
                <text x="280" y="3940">&lt;Signature&gt;</text>
                <text x="40" y="3956">(#)</text>
                <text x="260" y="3972">Token:</text>
                <text x="308" y="3972">0x4b</text>
                <text x="36" y="3988">2.05</text>
                <text x="268" y="3988">Observe:</text>
                <text x="328" y="3988">54123</text>
                <text x="264" y="4004">OSCORE:</text>
                <text x="320" y="4004">{kid:</text>
                <text x="368" y="4004">0x05;</text>
                <text x="412" y="4004">piv:</text>
                <text x="452" y="4004">502;</text>
                <text x="492" y="4004">...}</text>
                <text x="260" y="4020">&lt;Other</text>
                <text x="312" y="4020">class</text>
                <text x="352" y="4020">U/I</text>
                <text x="404" y="4020">options&gt;</text>
                <text x="252" y="4036">0xff</text>
                <text x="256" y="4052">(Same</text>
                <text x="352" y="4052">Encrypted_payload</text>
                <text x="440" y="4052">and</text>
                <text x="500" y="4052">Signature)</text>
                <text x="104" y="4068">(#)</text>
                <text x="260" y="4084">Token:</text>
                <text x="308" y="4084">0x02</text>
                <text x="100" y="4100">2.05</text>
                <text x="268" y="4100">Observe:</text>
                <text x="328" y="4100">54123</text>
                <text x="264" y="4116">OSCORE:</text>
                <text x="320" y="4116">{kid:</text>
                <text x="368" y="4116">0x05;</text>
                <text x="412" y="4116">piv:</text>
                <text x="452" y="4116">502;</text>
                <text x="492" y="4116">...}</text>
                <text x="260" y="4132">&lt;Other</text>
                <text x="312" y="4132">class</text>
                <text x="352" y="4132">U/I</text>
                <text x="404" y="4132">options&gt;</text>
                <text x="252" y="4148">0xff</text>
                <text x="256" y="4164">(Same</text>
                <text x="352" y="4164">Encrypted_payload</text>
                <text x="440" y="4164">and</text>
                <text x="500" y="4164">signature)</text>
                <text x="16" y="4228">(#)</text>
                <text x="60" y="4228">Sent</text>
                <text x="100" y="4228">over</text>
                <text x="156" y="4228">unicast,</text>
                <text x="208" y="4228">and</text>
                <text x="264" y="4228">protected</text>
                <text x="324" y="4228">with</text>
                <text x="368" y="4228">Group</text>
                <text x="420" y="4228">OSCORE</text>
                <text x="492" y="4228">end-to-end</text>
                <text x="72" y="4244">between</text>
                <text x="120" y="4244">the</text>
                <text x="164" y="4244">server</text>
                <text x="208" y="4244">and</text>
                <text x="240" y="4244">the</text>
                <text x="292" y="4244">clients.</text>
                <text x="20" y="4276">(##)</text>
                <text x="60" y="4276">Sent</text>
                <text x="100" y="4276">over</text>
                <text x="132" y="4276">IP</text>
                <text x="184" y="4276">multicast</text>
                <text x="236" y="4276">to</text>
                <text x="340" y="4276">GROUP_ADDR:GROUP_PORT,</text>
                <text x="448" y="4276">and</text>
                <text x="504" y="4276">protected</text>
                <text x="60" y="4292">with</text>
                <text x="104" y="4292">Group</text>
                <text x="156" y="4292">OSCORE</text>
                <text x="228" y="4292">end-to-end</text>
                <text x="304" y="4292">between</text>
                <text x="352" y="4292">the</text>
                <text x="396" y="4292">server</text>
                <text x="440" y="4292">and</text>
                <text x="472" y="4292">the</text>
                <text x="524" y="4292">clients.</text>
              </g>
            </svg><a href="#appendix-F-4.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a>:
<a href="#name-example-of-group-observation-w" class="selfRef">Example of Group Observation with a Proxy and Group OSCORE</a>
        </figcaption></figure>
</div>
<p id="appendix-F-5">Unlike in the unprotected example in <a href="#intermediaries-example" class="auto internal xref">Appendix E</a>, the proxy does <em>not</em> have all the information to perform request deduplication, and can only recognize the identical request once the client sends the ticket request.<a href="#appendix-F-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="intermediaries-example-e2e-security-det">
<section id="appendix-G">
      <h2 id="name-example-with-a-proxy-and-de">
<a href="#appendix-G" class="section-number selfRef">Appendix G. </a><a href="#name-example-with-a-proxy-and-de" class="section-name selfRef">Example with a Proxy and Deterministic Requests</a>
      </h2>
<p id="appendix-G-1">This section provides an example when a proxy P is used between the clients and the server, and Group OSCORE is used to protect multicast notifications end-to-end between the server and the clients.<a href="#appendix-G-1" class="pilcrow">¶</a></p>
<p id="appendix-G-2">In addition, the phantom request is especially a deterministic request (see <a href="#deterministic-phantom-Request" class="auto internal xref">Appendix D</a>), which is protected with the pairwise mode of Group OSCORE as defined in <span>[<a href="#I-D.amsuess-core-cachable-oscore" class="cite xref">I-D.amsuess-core-cachable-oscore</a>]</span>.<a href="#appendix-G-2" class="pilcrow">¶</a></p>
<div id="intermediaries-example-e2e-security-det-intro">
<section id="appendix-G.1">
        <h3 id="name-assumptions-and-walkthrough">
<a href="#appendix-G.1" class="section-number selfRef">G.1. </a><a href="#name-assumptions-and-walkthrough" class="section-name selfRef">Assumptions and Walkthrough</a>
        </h3>
<p id="appendix-G.1-1">The example provided in this appendix as reflected by the message exchange shown in <a href="#intermediaries-example-e2e-security-det-exchange" class="auto internal xref">Appendix G.2</a> assumes the following.<a href="#appendix-G.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="appendix-G.1-2">
<li id="appendix-G.1-2.1">
            <p id="appendix-G.1-2.1.1">The OSCORE group supports deterministic requests. Thus, the server creates the phantom request as a deterministic request <span>[<a href="#I-D.amsuess-core-cachable-oscore" class="cite xref">I-D.amsuess-core-cachable-oscore</a>]</span>, stores it locally as one of its issued phantom requests, and starts the group observation.<a href="#appendix-G.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="appendix-G.1-2.2">
            <p id="appendix-G.1-2.2.1">The server makes the phantom request available through other means, e.g., a pub-sub broker, together with the transport-specific information for listening to multicast notifications bound to the phantom request (see <a href="#appendix-different-sources" class="auto internal xref">Appendix A</a>).<a href="#appendix-G.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="appendix-G.1-2.3">
            <p id="appendix-G.1-2.3.1">Since the phantom request is a deterministic request, the server can more efficiently make it available in its smaller, plain version. The clients can obtain it from the particular alternative source and protect it as per <span><a href="https://datatracker.ietf.org/doc/html/draft-amsuess-core-cachable-oscore-10#section-3" class="relref">Section 3</a> of [<a href="#I-D.amsuess-core-cachable-oscore" class="cite xref">I-D.amsuess-core-cachable-oscore</a>]</span>, thus all computing the same deterministic request to be used as phantom observation request.<a href="#appendix-G.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="appendix-G.1-2.4">
            <p id="appendix-G.1-2.4.1">If the client does not rely on a proxy between itself and the server, it simply sets the group observation and starts listening to multicast notifications. Building on Step 2 above, the same would happen if the phantom request was not specifically a deterministic request.<a href="#appendix-G.1-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li id="appendix-G.1-2.5">
            <p id="appendix-G.1-2.5.1">If the client relies on a proxy between itself and the server, it uses the phantom request as a ticket request (see <a href="#intermediaries-e2e-security" class="auto internal xref">Section 12</a>). However, unlike the case considered in <a href="#intermediaries-e2e-security" class="auto internal xref">Section 12</a> where the ticket request is not a deterministic request, the client does not include a Listen-to-Multicast-Responses Option in the phantom request sent to the proxy.<a href="#appendix-G.1-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li id="appendix-G.1-2.6">
            <p id="appendix-G.1-2.6.1">Unlike for the case considered in <a href="#intermediaries-e2e-security" class="auto internal xref">Section 12</a>, here the proxy does not know that the request is exactly a ticket request for subscribing to multicast notifications. Thus, the proxy simply forwards the ticket request to the server like it normally would.<a href="#appendix-G.1-2.6.1" class="pilcrow">¶</a></p>
</li>
          <li id="appendix-G.1-2.7">
            <p id="appendix-G.1-2.7.1">The server receives the ticket request, which is a deviation from the case where the ticket request is not a deterministic request and stops at the proxy (see <a href="#intermediaries-e2e-security" class="auto internal xref">Section 12</a>). Then, the server recognizes the phantom request among the stored ones, through a byte-by-byte comparison of the incoming message minus the transport-related fields (see <a href="#deterministic-phantom-Request" class="auto internal xref">Appendix D</a>). Consequently, the server does not perform any Group OSCORE processing on it.<a href="#appendix-G.1-2.7.1" class="pilcrow">¶</a></p>
</li>
          <li id="appendix-G.1-2.8">
            <p id="appendix-G.1-2.8.1">The server replies with an unprotected informative response (see <a href="#ssec-server-side-informative" class="auto internal xref">Section 4.2</a>), including: the transport-specific information, (optionally) the phantom request, and (optionally) the latest notification.<a href="#appendix-G.1-2.8.1" class="pilcrow">¶</a></p>
<p id="appendix-G.1-2.8.2">
Note that the phantom request can be omitted, since it is the deterministic phantom request from the client, and thus "in terms of transport-independent information, identical to the registration request from the client" (see <a href="#ssec-server-side-informative" class="auto internal xref">Section 4.2</a>).<a href="#appendix-G.1-2.8.2" class="pilcrow">¶</a></p>
</li>
          <li id="appendix-G.1-2.9">
            <p id="appendix-G.1-2.9.1">From the received informative response, the proxy retrieves everything needed to set itself as an observer in the group observation, and it starts listening to multicast notifications. If the informative response included a latest notification, the proxy caches it and forwards it back to the client, otherwise it replies with an empty ACK (if it has not done it already and the request from the client was Confirmable).<a href="#appendix-G.1-2.9.1" class="pilcrow">¶</a></p>
</li>
          <li id="appendix-G.1-2.10">
            <p id="appendix-G.1-2.10.1">Like in the case with a non-deterministic phantom request considered in <a href="#intermediaries-e2e-security" class="auto internal xref">Section 12</a>, the proxy fans out the multicast notifications to the origin clients as they come. Also, as new clients following the first one contact the proxy, this does not have to contact the server again as in <a href="#intermediaries-e2e-security" class="auto internal xref">Section 12</a>, since the deterministic phantom request would produce a cache hit as per <span>[<a href="#I-D.amsuess-core-cachable-oscore" class="cite xref">I-D.amsuess-core-cachable-oscore</a>]</span>. Thus, the proxy can serve such clients with the latest fresh multicast notification from its cache.<a href="#appendix-G.1-2.10.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="intermediaries-example-e2e-security-det-exchange">
<section id="appendix-G.2">
        <h3 id="name-message-exchange">
<a href="#appendix-G.2" class="section-number selfRef">G.2. </a><a href="#name-message-exchange" class="section-name selfRef">Message Exchange</a>
        </h3>
<p id="appendix-G.2-1">The same assumptions and notation used in <a href="#sec-example-with-security" class="auto internal xref">Section 10</a> are used for this example. As a recap of some specific values:<a href="#appendix-G.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-G.2-2.1">
            <p id="appendix-G.2-2.1.1">Two clients C1 and C2 register to observe a resource /r at a server S, which has address SRV_ADDR and listens to the port number SRV_PORT. Before the following exchanges occur, no clients are observing the resource /r , which has value "1234".<a href="#appendix-G.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-G.2-2.2">
            <p id="appendix-G.2-2.2.1">The server S sends multicast notifications to the IP multicast address GRP_ADDR and port number GRP_PORT, and starts the group observation already after creating the deterministic phantom request to early disseminate.<a href="#appendix-G.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-G.2-2.3">
            <p id="appendix-G.2-2.3.1">S is a member of the OSCORE group with 'kid context' = 0x57ab2e as Group ID. In the OSCORE group, S has 'kid' = 0x05 as Sender ID, and SN_5 = 501 as Sender Sequence Number.<a href="#appendix-G.2-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="appendix-G.2-3">In addition:<a href="#appendix-G.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-G.2-4.1">
            <p id="appendix-G.2-4.1.1">The proxy has address PRX_ADDR and listens to the port number PRX_PORT.<a href="#appendix-G.2-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-G.2-4.2">
            <p id="appendix-G.2-4.2.1">The deterministic client in the OSCORE group has 'kid' = 0x09.<a href="#appendix-G.2-4.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="appendix-G.2-5">Unless explicitly indicated, all messages transmitted on the wire are sent over unicast and protected with Group OSCORE end-to-end between a client and the server.<a href="#appendix-G.2-5" class="pilcrow">¶</a></p>
<span id="name-example-of-group-observation-wi"></span><div id="example-proxy-oscore-det-request">
<figure id="figure-12">
          <div id="appendix-G.2-6.1">
            <div class="alignLeft art-svg artwork" id="appendix-G.2-6.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="3424" width="576" viewBox="0 0 576 3424" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,48 L 8,2112" fill="none" stroke="black"></path>
                <path d="M 8,2176 L 8,2688" fill="none" stroke="black"></path>
                <path d="M 8,2752 L 8,3312" fill="none" stroke="black"></path>
                <path d="M 72,48 L 72,664" fill="none" stroke="black"></path>
                <path d="M 72,680 L 72,1912" fill="none" stroke="black"></path>
                <path d="M 72,1928 L 72,2112" fill="none" stroke="black"></path>
                <path d="M 72,2176 L 72,2688" fill="none" stroke="black"></path>
                <path d="M 72,2752 L 72,3096" fill="none" stroke="black"></path>
                <path d="M 72,3112 L 72,3312" fill="none" stroke="black"></path>
                <path d="M 136,48 L 136,2112" fill="none" stroke="black"></path>
                <path d="M 136,2176 L 136,2688" fill="none" stroke="black"></path>
                <path d="M 136,2752 L 136,3312" fill="none" stroke="black"></path>
                <path d="M 216,48 L 216,2112" fill="none" stroke="black"></path>
                <path d="M 216,2176 L 216,2688" fill="none" stroke="black"></path>
                <path d="M 216,2752 L 216,3312" fill="none" stroke="black"></path>
                <path d="M 512,1152 L 512,1160" fill="none" stroke="black"></path>
                <path d="M 160,240 L 216,240" fill="none" stroke="black"></path>
                <path d="M 160,288 L 208,288" fill="none" stroke="black"></path>
                <path d="M 8,672 L 128,672" fill="none" stroke="black"></path>
                <path d="M 136,912 L 208,912" fill="none" stroke="black"></path>
                <path d="M 144,1552 L 216,1552" fill="none" stroke="black"></path>
                <path d="M 16,1920 L 136,1920" fill="none" stroke="black"></path>
                <path d="M 72,2224 L 128,2224" fill="none" stroke="black"></path>
                <path d="M 80,2496 L 136,2496" fill="none" stroke="black"></path>
                <path d="M 144,2832 L 216,2832" fill="none" stroke="black"></path>
                <path d="M 16,3104 L 136,3104" fill="none" stroke="black"></path>
                <path d="M 80,3216 L 136,3216" fill="none" stroke="black"></path>
                <path d="M 148,264 L 160,288" fill="none" stroke="black"></path>
                <path d="M 148,264 L 160,240" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="216,912 204,906.4 204,917.6" fill="black" transform="rotate(0,208,912)"></polygon>
                <polygon class="arrowhead" points="216,288 204,282.4 204,293.6" fill="black" transform="rotate(0,208,288)"></polygon>
                <polygon class="arrowhead" points="152,2832 140,2826.4 140,2837.6" fill="black" transform="rotate(180,144,2832)"></polygon>
                <polygon class="arrowhead" points="152,1552 140,1546.4 140,1557.6" fill="black" transform="rotate(180,144,1552)"></polygon>
                <polygon class="arrowhead" points="136,2224 124,2218.4 124,2229.6" fill="black" transform="rotate(0,128,2224)"></polygon>
                <polygon class="arrowhead" points="136,672 124,666.4 124,677.6" fill="black" transform="rotate(0,128,672)"></polygon>
                <polygon class="arrowhead" points="88,3216 76,3210.4 76,3221.6" fill="black" transform="rotate(180,80,3216)"></polygon>
                <polygon class="arrowhead" points="88,2496 76,2490.4 76,2501.6" fill="black" transform="rotate(180,80,2496)"></polygon>
                <polygon class="arrowhead" points="24,3104 12,3098.4 12,3109.6" fill="black" transform="rotate(180,16,3104)"></polygon>
                <polygon class="arrowhead" points="24,1920 12,1914.4 12,1925.6" fill="black" transform="rotate(180,16,1920)"></polygon>
                <g class="text">
                  <text x="12" y="36">C1</text>
                  <text x="76" y="36">C2</text>
                  <text x="136" y="36">P</text>
                  <text x="216" y="36">S</text>
                  <text x="252" y="68">(The</text>
                  <text x="296" y="68">value</text>
                  <text x="332" y="68">of</text>
                  <text x="360" y="68">the</text>
                  <text x="412" y="68">resource</text>
                  <text x="460" y="68">/r</text>
                  <text x="484" y="68">is</text>
                  <text x="528" y="68">"1234")</text>
                  <text x="244" y="100">(S</text>
                  <text x="296" y="100">allocates</text>
                  <text x="352" y="100">the</text>
                  <text x="408" y="100">available</text>
                  <text x="264" y="116">Token</text>
                  <text x="312" y="116">value</text>
                  <text x="356" y="116">0x7b</text>
                  <text x="388" y="116">.)</text>
                  <text x="244" y="148">(S</text>
                  <text x="280" y="148">sends</text>
                  <text x="316" y="148">to</text>
                  <text x="356" y="148">itself</text>
                  <text x="392" y="148">a</text>
                  <text x="432" y="148">phantom</text>
                  <text x="512" y="148">observation</text>
                  <text x="272" y="164">request</text>
                  <text x="332" y="164">PH_REQ</text>
                  <text x="372" y="164">as</text>
                  <text x="412" y="164">coming</text>
                  <text x="460" y="164">from</text>
                  <text x="496" y="164">the</text>
                  <text x="252" y="180">IP</text>
                  <text x="304" y="180">multicast</text>
                  <text x="376" y="180">address</text>
                  <text x="448" y="180">GRP_ADDR.</text>
                  <text x="256" y="196">The</text>
                  <text x="296" y="196">Group</text>
                  <text x="348" y="196">OSCORE</text>
                  <text x="420" y="196">processing</text>
                  <text x="492" y="196">occurs</text>
                  <text x="532" y="196">as</text>
                  <text x="280" y="212">specified</text>
                  <text x="336" y="212">for</text>
                  <text x="360" y="212">a</text>
                  <text x="424" y="212">deterministic</text>
                  <text x="516" y="212">request)</text>
                  <text x="260" y="292">Token:</text>
                  <text x="308" y="292">0x7b</text>
                  <text x="184" y="308">FETCH</text>
                  <text x="272" y="308">Uri-Host:</text>
                  <text x="380" y="308">"sensor.example"</text>
                  <text x="268" y="324">Observe:</text>
                  <text x="312" y="324">0</text>
                  <text x="364" y="324">(register)</text>
                  <text x="264" y="340">OSCORE:</text>
                  <text x="320" y="340">{kid:</text>
                  <text x="364" y="340">0x09</text>
                  <text x="392" y="340">;</text>
                  <text x="420" y="340">piv:</text>
                  <text x="448" y="340">0</text>
                  <text x="464" y="340">;</text>
                  <text x="320" y="356">kid</text>
                  <text x="372" y="356">context:</text>
                  <text x="444" y="356">0x57ab2e</text>
                  <text x="488" y="356">;</text>
                  <text x="512" y="356">...</text>
                  <text x="536" y="356">}</text>
                  <text x="260" y="372">&lt;Other</text>
                  <text x="312" y="372">class</text>
                  <text x="352" y="372">U/I</text>
                  <text x="404" y="372">options&gt;</text>
                  <text x="252" y="388">0xff</text>
                  <text x="304" y="404">Encrypted_payload</text>
                  <text x="384" y="404">{</text>
                  <text x="268" y="420">0x01</text>
                  <text x="316" y="420">(GET),</text>
                  <text x="284" y="436">Observe:</text>
                  <text x="328" y="436">0</text>
                  <text x="384" y="436">(register),</text>
                  <text x="288" y="452">Uri-Path:</text>
                  <text x="348" y="452">"r",</text>
                  <text x="276" y="468">&lt;Other</text>
                  <text x="328" y="468">class</text>
                  <text x="360" y="468">E</text>
                  <text x="404" y="468">options&gt;</text>
                  <text x="240" y="484">}</text>
                  <text x="244" y="516">(S</text>
                  <text x="288" y="516">creates</text>
                  <text x="328" y="516">a</text>
                  <text x="360" y="516">group</text>
                  <text x="432" y="516">observation</text>
                  <text x="492" y="516">of</text>
                  <text x="520" y="516">/r)</text>
                  <text x="252" y="548">(The</text>
                  <text x="300" y="548">server</text>
                  <text x="348" y="548">does</text>
                  <text x="384" y="548">not</text>
                  <text x="432" y="548">respond</text>
                  <text x="476" y="548">to</text>
                  <text x="520" y="548">PH_REQ.</text>
                  <text x="256" y="564">The</text>
                  <text x="300" y="564">server</text>
                  <text x="356" y="564">stores</text>
                  <text x="412" y="564">PH_REQ</text>
                  <text x="472" y="564">locally</text>
                  <text x="520" y="564">and</text>
                  <text x="264" y="580">makes</text>
                  <text x="300" y="580">it</text>
                  <text x="352" y="580">available</text>
                  <text x="404" y="580">at</text>
                  <text x="428" y="580">an</text>
                  <text x="476" y="580">external</text>
                  <text x="544" y="580">source)</text>
                  <text x="248" y="628">(C1</text>
                  <text x="296" y="628">obtains</text>
                  <text x="356" y="628">PH_REQ</text>
                  <text x="400" y="628">and</text>
                  <text x="440" y="628">sends</text>
                  <text x="476" y="628">it</text>
                  <text x="500" y="628">to</text>
                  <text x="524" y="628">P)</text>
                  <text x="260" y="676">Token:</text>
                  <text x="308" y="676">0x4a</text>
                  <text x="40" y="692">FETCH</text>
                  <text x="272" y="692">Uri-Host:</text>
                  <text x="380" y="692">"sensor.example"</text>
                  <text x="268" y="708">Observe:</text>
                  <text x="312" y="708">0</text>
                  <text x="364" y="708">(register)</text>
                  <text x="264" y="724">OSCORE:</text>
                  <text x="320" y="724">{kid:</text>
                  <text x="364" y="724">0x09</text>
                  <text x="392" y="724">;</text>
                  <text x="420" y="724">piv:</text>
                  <text x="448" y="724">0</text>
                  <text x="464" y="724">;</text>
                  <text x="320" y="740">kid</text>
                  <text x="372" y="740">context:</text>
                  <text x="444" y="740">0x57ab2e</text>
                  <text x="488" y="740">;</text>
                  <text x="512" y="740">...</text>
                  <text x="536" y="740">}</text>
                  <text x="288" y="756">Proxy-Scheme:</text>
                  <text x="372" y="756">"coap"</text>
                  <text x="260" y="772">&lt;Other</text>
                  <text x="312" y="772">class</text>
                  <text x="352" y="772">U/I</text>
                  <text x="404" y="772">options&gt;</text>
                  <text x="252" y="788">0xff</text>
                  <text x="304" y="804">Encrypted_payload</text>
                  <text x="384" y="804">{</text>
                  <text x="268" y="820">0x01</text>
                  <text x="316" y="820">(GET),</text>
                  <text x="284" y="836">Observe:</text>
                  <text x="328" y="836">0</text>
                  <text x="384" y="836">(register),</text>
                  <text x="288" y="852">Uri-Path:</text>
                  <text x="348" y="852">"r",</text>
                  <text x="276" y="868">&lt;Other</text>
                  <text x="328" y="868">class</text>
                  <text x="360" y="868">E</text>
                  <text x="404" y="868">options&gt;</text>
                  <text x="240" y="884">}</text>
                  <text x="260" y="916">Token:</text>
                  <text x="308" y="916">0x5e</text>
                  <text x="168" y="932">FETCH</text>
                  <text x="272" y="932">Uri-Host:</text>
                  <text x="380" y="932">"sensor.example"</text>
                  <text x="268" y="948">Observe:</text>
                  <text x="312" y="948">0</text>
                  <text x="364" y="948">(register)</text>
                  <text x="264" y="964">OSCORE:</text>
                  <text x="320" y="964">{kid:</text>
                  <text x="364" y="964">0x09</text>
                  <text x="392" y="964">;</text>
                  <text x="420" y="964">piv:</text>
                  <text x="448" y="964">0</text>
                  <text x="464" y="964">;</text>
                  <text x="320" y="980">kid</text>
                  <text x="372" y="980">context:</text>
                  <text x="444" y="980">0x57ab2e</text>
                  <text x="488" y="980">;</text>
                  <text x="512" y="980">...</text>
                  <text x="536" y="980">}</text>
                  <text x="260" y="996">&lt;Other</text>
                  <text x="312" y="996">class</text>
                  <text x="352" y="996">U/I</text>
                  <text x="404" y="996">options&gt;</text>
                  <text x="252" y="1012">0xff</text>
                  <text x="304" y="1028">Encrypted_payload</text>
                  <text x="384" y="1028">{</text>
                  <text x="268" y="1044">0x01</text>
                  <text x="316" y="1044">(GET),</text>
                  <text x="284" y="1060">Observe:</text>
                  <text x="328" y="1060">0</text>
                  <text x="384" y="1060">(register),</text>
                  <text x="288" y="1076">Uri-Path:</text>
                  <text x="348" y="1076">"r",</text>
                  <text x="276" y="1092">&lt;Other</text>
                  <text x="328" y="1092">class</text>
                  <text x="360" y="1092">E</text>
                  <text x="404" y="1092">options&gt;</text>
                  <text x="240" y="1108">}</text>
                  <text x="244" y="1140">(S</text>
                  <text x="300" y="1140">recognizes</text>
                  <text x="372" y="1140">PH_REQ</text>
                  <text x="432" y="1140">through</text>
                  <text x="516" y="1140">byte-by-byte</text>
                  <text x="284" y="1156">comparison</text>
                  <text x="360" y="1156">against</text>
                  <text x="408" y="1156">the</text>
                  <text x="452" y="1156">stored</text>
                  <text x="496" y="1156">one</text>
                  <text x="536" y="1156">and</text>
                  <text x="264" y="1172">skips</text>
                  <text x="304" y="1172">any</text>
                  <text x="344" y="1172">Group</text>
                  <text x="396" y="1172">OSCORE</text>
                  <text x="472" y="1172">processing)</text>
                  <text x="244" y="1204">(S</text>
                  <text x="292" y="1204">prepares</text>
                  <text x="344" y="1204">the</text>
                  <text x="384" y="1204">"last</text>
                  <text x="464" y="1204">notification"</text>
                  <text x="276" y="1220">response</text>
                  <text x="344" y="1220">defined</text>
                  <text x="404" y="1220">below)</text>
                  <text x="252" y="1252">0x45</text>
                  <text x="296" y="1252">(2.05</text>
                  <text x="356" y="1252">Content)</text>
                  <text x="268" y="1268">Observe:</text>
                  <text x="316" y="1268">10</text>
                  <text x="264" y="1284">OSCORE:</text>
                  <text x="320" y="1284">{kid:</text>
                  <text x="364" y="1284">0x05</text>
                  <text x="392" y="1284">;</text>
                  <text x="420" y="1284">piv:</text>
                  <text x="456" y="1284">501</text>
                  <text x="480" y="1284">;</text>
                  <text x="508" y="1284">...}</text>
                  <text x="268" y="1300">Max-Age:</text>
                  <text x="324" y="1300">3000</text>
                  <text x="260" y="1316">&lt;Other</text>
                  <text x="312" y="1316">class</text>
                  <text x="352" y="1316">U/I</text>
                  <text x="404" y="1316">options&gt;</text>
                  <text x="252" y="1332">0xff</text>
                  <text x="304" y="1348">Encrypted_payload</text>
                  <text x="384" y="1348">{</text>
                  <text x="268" y="1364">0x45</text>
                  <text x="312" y="1364">(2.05</text>
                  <text x="376" y="1364">Content),</text>
                  <text x="284" y="1380">Observe:</text>
                  <text x="356" y="1380">[empty],</text>
                  <text x="284" y="1396">Payload:</text>
                  <text x="348" y="1396">"1234"</text>
                  <text x="240" y="1412">}</text>
                  <text x="280" y="1428">&lt;Signature&gt;</text>
                  <text x="244" y="1460">(S</text>
                  <text x="300" y="1460">increments</text>
                  <text x="360" y="1460">the</text>
                  <text x="412" y="1460">observer</text>
                  <text x="480" y="1460">counter</text>
                  <text x="248" y="1476">for</text>
                  <text x="280" y="1476">the</text>
                  <text x="320" y="1476">group</text>
                  <text x="392" y="1476">observation</text>
                  <text x="452" y="1476">of</text>
                  <text x="480" y="1476">/r)</text>
                  <text x="244" y="1508">(S</text>
                  <text x="292" y="1508">responds</text>
                  <text x="340" y="1508">to</text>
                  <text x="368" y="1508">the</text>
                  <text x="408" y="1508">proxy</text>
                  <text x="452" y="1508">with</text>
                  <text x="484" y="1508">an</text>
                  <text x="288" y="1524">unprotected</text>
                  <text x="384" y="1524">informative</text>
                  <text x="472" y="1524">response)</text>
                  <text x="176" y="1540">(#)</text>
                  <text x="260" y="1556">Token:</text>
                  <text x="308" y="1556">0x5e</text>
                  <text x="164" y="1572">5.03</text>
                  <text x="296" y="1572">Content-Format:</text>
                  <text x="412" y="1572">application/</text>
                  <text x="352" y="1588">informative-response+cbor</text>
                  <text x="268" y="1604">Max-Age:</text>
                  <text x="312" y="1604">0</text>
                  <text x="252" y="1620">0xff</text>
                  <text x="264" y="1636">Payload</text>
                  <text x="304" y="1636">{</text>
                  <text x="256" y="1652">/</text>
                  <text x="296" y="1652">tp_info</text>
                  <text x="336" y="1652">/</text>
                  <text x="376" y="1652">0</text>
                  <text x="392" y="1652">:</text>
                  <text x="408" y="1652">[</text>
                  <text x="432" y="1668">cri'coap://SRV_ADDR:SRV_PORT/',</text>
                  <text x="448" y="1684">cri'coap://GRP_ADDR:GRP_PORT/',</text>
                  <text x="364" y="1700">0x7b],</text>
                  <text x="256" y="1716">/</text>
                  <text x="308" y="1716">last_notif</text>
                  <text x="360" y="1716">/</text>
                  <text x="376" y="1716">2</text>
                  <text x="392" y="1716">:</text>
                  <text x="424" y="1716">&lt;this</text>
                  <text x="480" y="1716">conveys</text>
                  <text x="384" y="1732">the</text>
                  <text x="424" y="1732">"last</text>
                  <text x="504" y="1732">notification"</text>
                  <text x="404" y="1748">response</text>
                  <text x="476" y="1748">prepared</text>
                  <text x="540" y="1748">above&gt;</text>
                  <text x="240" y="1764">}</text>
                  <text x="244" y="1796">(P</text>
                  <text x="292" y="1796">extracts</text>
                  <text x="356" y="1796">PH_REQ</text>
                  <text x="400" y="1796">and</text>
                  <text x="444" y="1796">starts</text>
                  <text x="512" y="1796">listening</text>
                  <text x="252" y="1812">to</text>
                  <text x="304" y="1812">multicast</text>
                  <text x="400" y="1812">notifications</text>
                  <text x="476" y="1812">with</text>
                  <text x="520" y="1812">Token</text>
                  <text x="260" y="1828">0x7b</text>
                  <text x="292" y="1828">at</text>
                  <text x="380" y="1828">GRP_ADDR:GRP_PORT)</text>
                  <text x="244" y="1860">(P</text>
                  <text x="292" y="1860">extracts</text>
                  <text x="344" y="1860">the</text>
                  <text x="384" y="1860">"last</text>
                  <text x="464" y="1860">notification"</text>
                  <text x="280" y="1876">response,</text>
                  <text x="348" y="1876">caches</text>
                  <text x="388" y="1876">it</text>
                  <text x="416" y="1876">and</text>
                  <text x="468" y="1876">forwards</text>
                  <text x="252" y="1892">it</text>
                  <text x="284" y="1892">back</text>
                  <text x="316" y="1892">to</text>
                  <text x="344" y="1892">C1)</text>
                  <text x="260" y="1924">Token:</text>
                  <text x="308" y="1924">0x4a</text>
                  <text x="36" y="1940">2.05</text>
                  <text x="268" y="1940">Observe:</text>
                  <text x="328" y="1940">54120</text>
                  <text x="264" y="1956">OSCORE:</text>
                  <text x="320" y="1956">{kid:</text>
                  <text x="364" y="1956">0x05</text>
                  <text x="392" y="1956">;</text>
                  <text x="420" y="1956">piv:</text>
                  <text x="456" y="1956">501</text>
                  <text x="480" y="1956">;</text>
                  <text x="508" y="1956">...}</text>
                  <text x="268" y="1972">Max-Age:</text>
                  <text x="324" y="1972">2995</text>
                  <text x="260" y="1988">&lt;Other</text>
                  <text x="312" y="1988">class</text>
                  <text x="352" y="1988">U/I</text>
                  <text x="404" y="1988">options&gt;</text>
                  <text x="252" y="2004">0xff</text>
                  <text x="304" y="2020">Encrypted_payload</text>
                  <text x="384" y="2020">{</text>
                  <text x="268" y="2036">0x45</text>
                  <text x="312" y="2036">(2.05</text>
                  <text x="376" y="2036">Content),</text>
                  <text x="284" y="2052">Observe:</text>
                  <text x="356" y="2052">[empty],</text>
                  <text x="284" y="2068">Payload:</text>
                  <text x="348" y="2068">"1234"</text>
                  <text x="240" y="2084">}</text>
                  <text x="280" y="2100">&lt;Signature&gt;</text>
                  <text x="16" y="2148">...</text>
                  <text x="72" y="2148">...</text>
                  <text x="136" y="2148">...</text>
                  <text x="208" y="2148">...</text>
                  <text x="248" y="2196">(C2</text>
                  <text x="296" y="2196">obtains</text>
                  <text x="356" y="2196">PH_REQ</text>
                  <text x="400" y="2196">and</text>
                  <text x="440" y="2196">sends</text>
                  <text x="476" y="2196">it</text>
                  <text x="500" y="2196">to</text>
                  <text x="524" y="2196">P)</text>
                  <text x="260" y="2228">Token:</text>
                  <text x="308" y="2228">0x01</text>
                  <text x="104" y="2244">FETCH</text>
                  <text x="272" y="2244">Uri-Host:</text>
                  <text x="380" y="2244">"sensor.example"</text>
                  <text x="268" y="2260">Observe:</text>
                  <text x="312" y="2260">0</text>
                  <text x="364" y="2260">(register)</text>
                  <text x="264" y="2276">OSCORE:</text>
                  <text x="320" y="2276">{kid:</text>
                  <text x="364" y="2276">0x09</text>
                  <text x="392" y="2276">;</text>
                  <text x="420" y="2276">piv:</text>
                  <text x="448" y="2276">0</text>
                  <text x="464" y="2276">;</text>
                  <text x="320" y="2292">kid</text>
                  <text x="372" y="2292">context:</text>
                  <text x="448" y="2292">0x57ab2e;</text>
                  <text x="508" y="2292">...}</text>
                  <text x="288" y="2308">Proxy-Scheme:</text>
                  <text x="372" y="2308">"coap"</text>
                  <text x="260" y="2324">&lt;Other</text>
                  <text x="312" y="2324">class</text>
                  <text x="352" y="2324">U/I</text>
                  <text x="404" y="2324">options&gt;</text>
                  <text x="252" y="2340">0xff</text>
                  <text x="304" y="2356">Encrypted_payload</text>
                  <text x="384" y="2356">{</text>
                  <text x="268" y="2372">0x01</text>
                  <text x="316" y="2372">(GET),</text>
                  <text x="284" y="2388">Observe:</text>
                  <text x="328" y="2388">0</text>
                  <text x="384" y="2388">(register),</text>
                  <text x="288" y="2404">Uri-Path:</text>
                  <text x="348" y="2404">"r",</text>
                  <text x="276" y="2420">&lt;Other</text>
                  <text x="328" y="2420">class</text>
                  <text x="360" y="2420">E</text>
                  <text x="404" y="2420">options&gt;</text>
                  <text x="240" y="2436">}</text>
                  <text x="244" y="2468">(P</text>
                  <text x="284" y="2468">serves</text>
                  <text x="324" y="2468">C2</text>
                  <text x="356" y="2468">from</text>
                  <text x="388" y="2468">it</text>
                  <text x="428" y="2468">cache)</text>
                  <text x="260" y="2500">Token:</text>
                  <text x="308" y="2500">0x01</text>
                  <text x="100" y="2516">2.05</text>
                  <text x="268" y="2516">Observe:</text>
                  <text x="328" y="2516">54120</text>
                  <text x="264" y="2532">OSCORE:</text>
                  <text x="320" y="2532">{kid:</text>
                  <text x="364" y="2532">0x05</text>
                  <text x="392" y="2532">;</text>
                  <text x="420" y="2532">piv:</text>
                  <text x="456" y="2532">501</text>
                  <text x="480" y="2532">;</text>
                  <text x="508" y="2532">...}</text>
                  <text x="268" y="2548">Max-Age:</text>
                  <text x="324" y="2548">1800</text>
                  <text x="260" y="2564">&lt;Other</text>
                  <text x="312" y="2564">class</text>
                  <text x="352" y="2564">U/I</text>
                  <text x="404" y="2564">options&gt;</text>
                  <text x="252" y="2580">0xff</text>
                  <text x="304" y="2596">Encrypted_payload</text>
                  <text x="384" y="2596">{</text>
                  <text x="268" y="2612">0x45</text>
                  <text x="312" y="2612">(2.05</text>
                  <text x="376" y="2612">Content),</text>
                  <text x="284" y="2628">Observe:</text>
                  <text x="356" y="2628">[empty],</text>
                  <text x="284" y="2644">Payload:</text>
                  <text x="348" y="2644">"1234"</text>
                  <text x="240" y="2660">}</text>
                  <text x="280" y="2676">&lt;Signature&gt;</text>
                  <text x="16" y="2724">...</text>
                  <text x="72" y="2724">...</text>
                  <text x="136" y="2724">...</text>
                  <text x="208" y="2724">...</text>
                  <text x="252" y="2772">(The</text>
                  <text x="296" y="2772">value</text>
                  <text x="332" y="2772">of</text>
                  <text x="360" y="2772">the</text>
                  <text x="412" y="2772">resource</text>
                  <text x="252" y="2788">/r</text>
                  <text x="296" y="2788">changes</text>
                  <text x="340" y="2788">to</text>
                  <text x="388" y="2788">"5678".)</text>
                  <text x="180" y="2820">(##)</text>
                  <text x="260" y="2836">Token:</text>
                  <text x="308" y="2836">0x7b</text>
                  <text x="164" y="2852">2.05</text>
                  <text x="268" y="2852">Observe:</text>
                  <text x="316" y="2852">11</text>
                  <text x="264" y="2868">OSCORE:</text>
                  <text x="320" y="2868">{kid:</text>
                  <text x="368" y="2868">0x05;</text>
                  <text x="412" y="2868">piv:</text>
                  <text x="448" y="2868">502</text>
                  <text x="472" y="2868">;</text>
                  <text x="500" y="2868">...}</text>
                  <text x="260" y="2884">&lt;Other</text>
                  <text x="312" y="2884">class</text>
                  <text x="352" y="2884">U/I</text>
                  <text x="404" y="2884">options&gt;</text>
                  <text x="252" y="2900">0xff</text>
                  <text x="304" y="2916">Encrypted_payload</text>
                  <text x="384" y="2916">{</text>
                  <text x="268" y="2932">0x45</text>
                  <text x="312" y="2932">(2.05</text>
                  <text x="376" y="2932">Content),</text>
                  <text x="284" y="2948">Observe:</text>
                  <text x="356" y="2948">[empty],</text>
                  <text x="276" y="2964">&lt;Other</text>
                  <text x="328" y="2964">class</text>
                  <text x="360" y="2964">E</text>
                  <text x="408" y="2964">options&gt;,</text>
                  <text x="272" y="2980">0xff,</text>
                  <text x="284" y="2996">Payload:</text>
                  <text x="348" y="2996">"5678"</text>
                  <text x="240" y="3012">}</text>
                  <text x="280" y="3028">&lt;Signature&gt;</text>
                  <text x="244" y="3060">(P</text>
                  <text x="288" y="3060">updates</text>
                  <text x="336" y="3060">its</text>
                  <text x="376" y="3060">cache</text>
                  <text x="424" y="3060">entry</text>
                  <text x="260" y="3076">with</text>
                  <text x="300" y="3076">this</text>
                  <text x="376" y="3076">notification)</text>
                  <text x="260" y="3108">Token:</text>
                  <text x="308" y="3108">0x4a</text>
                  <text x="36" y="3124">2.05</text>
                  <text x="268" y="3124">Observe:</text>
                  <text x="328" y="3124">54123</text>
                  <text x="264" y="3140">OSCORE:</text>
                  <text x="320" y="3140">{kid:</text>
                  <text x="368" y="3140">0x05;</text>
                  <text x="412" y="3140">piv:</text>
                  <text x="448" y="3140">502</text>
                  <text x="472" y="3140">;</text>
                  <text x="500" y="3140">...}</text>
                  <text x="260" y="3156">&lt;Other</text>
                  <text x="312" y="3156">class</text>
                  <text x="352" y="3156">U/I</text>
                  <text x="404" y="3156">options&gt;</text>
                  <text x="252" y="3172">0xff</text>
                  <text x="256" y="3188">(Same</text>
                  <text x="352" y="3188">Encrypted_payload</text>
                  <text x="440" y="3188">and</text>
                  <text x="500" y="3188">signature)</text>
                  <text x="260" y="3220">Token:</text>
                  <text x="308" y="3220">0x01</text>
                  <text x="100" y="3236">2.05</text>
                  <text x="268" y="3236">Observe:</text>
                  <text x="328" y="3236">54123</text>
                  <text x="264" y="3252">OSCORE:</text>
                  <text x="320" y="3252">{kid:</text>
                  <text x="368" y="3252">0x05;</text>
                  <text x="412" y="3252">piv:</text>
                  <text x="448" y="3252">502</text>
                  <text x="472" y="3252">;</text>
                  <text x="500" y="3252">...}</text>
                  <text x="260" y="3268">&lt;Other</text>
                  <text x="312" y="3268">class</text>
                  <text x="352" y="3268">U/I</text>
                  <text x="404" y="3268">options&gt;</text>
                  <text x="252" y="3284">0xff</text>
                  <text x="256" y="3300">(Same</text>
                  <text x="352" y="3300">Encrypted_payload</text>
                  <text x="440" y="3300">and</text>
                  <text x="500" y="3300">signature)</text>
                  <text x="16" y="3364">(#)</text>
                  <text x="60" y="3364">Sent</text>
                  <text x="100" y="3364">over</text>
                  <text x="152" y="3364">unicast</text>
                  <text x="200" y="3364">and</text>
                  <text x="268" y="3364">unprotected.</text>
                  <text x="20" y="3396">(##)</text>
                  <text x="60" y="3396">Sent</text>
                  <text x="100" y="3396">over</text>
                  <text x="132" y="3396">IP</text>
                  <text x="184" y="3396">multicast</text>
                  <text x="236" y="3396">to</text>
                  <text x="340" y="3396">GROUP_ADDR:GROUP_PORT,</text>
                  <text x="448" y="3396">and</text>
                  <text x="504" y="3396">protected</text>
                  <text x="60" y="3412">with</text>
                  <text x="104" y="3412">Group</text>
                  <text x="156" y="3412">OSCORE</text>
                  <text x="228" y="3412">end-to-end</text>
                  <text x="304" y="3412">between</text>
                  <text x="352" y="3412">the</text>
                  <text x="396" y="3412">server</text>
                  <text x="440" y="3412">and</text>
                  <text x="472" y="3412">the</text>
                  <text x="524" y="3412">clients.</text>
                </g>
              </svg><a href="#appendix-G.2-6.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-12" class="selfRef">Figure 12</a>:
<a href="#name-example-of-group-observation-wi" class="selfRef">Example of Group Observation with a Proxy and Group OSCORE, where the Phantom Request is a Deterministic Request</a>
          </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="sec-document-updates">
<section id="appendix-H">
      <h2 id="name-document-updates">
<a href="#appendix-H" class="section-number selfRef">Appendix H. </a><a href="#name-document-updates" class="section-name selfRef">Document Updates</a>
      </h2>
<p id="appendix-H-1">This section is to be removed before publishing as an RFC.<a href="#appendix-H-1" class="pilcrow">¶</a></p>
<div id="sec-10-11">
<section id="appendix-H.1">
        <h3 id="name-version-10-to-11">
<a href="#appendix-H.1" class="section-number selfRef">H.1. </a><a href="#name-version-10-to-11" class="section-name selfRef">Version -10 to -11</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-H.1-1.1">
            <p id="appendix-H.1-1.1.1">Do not rule out original observation requests sent over multicast.<a href="#appendix-H.1-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-H.1-1.2">
            <p id="appendix-H.1-1.2.1">Defined 'ending' parameter for the informative response payload.<a href="#appendix-H.1-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-H.1-1.3">
            <p id="appendix-H.1-1.3.1">Minor fixes in examples.<a href="#appendix-H.1-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-H.1-1.4">
            <p id="appendix-H.1-1.4.1">Clarifications and editorial improvements.<a href="#appendix-H.1-1.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-09-10">
<section id="appendix-H.2">
        <h3 id="name-version-09-to-10">
<a href="#appendix-H.2" class="section-number selfRef">H.2. </a><a href="#name-version-09-to-10" class="section-name selfRef">Version -09 to -10</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-H.2-1.1">
            <p id="appendix-H.2-1.1.1">Fixed section numbers of referred documents.<a href="#appendix-H.2-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-H.2-1.2">
            <p id="appendix-H.2-1.2.1">Revised registration policies in the IANA considerations.<a href="#appendix-H.2-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-H.2-1.3">
            <p id="appendix-H.2-1.3.1">Clarifications and editorial improvements.<a href="#appendix-H.2-1.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-08-09">
<section id="appendix-H.3">
        <h3 id="name-version-08-to-09">
<a href="#appendix-H.3" class="section-number selfRef">H.3. </a><a href="#name-version-08-to-09" class="section-name selfRef">Version -08 to -09</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-H.3-1.1">
            <p id="appendix-H.3-1.1.1">Revised 'tp_info' also to use CRIs for transport information.<a href="#appendix-H.3-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-H.3-1.2">
            <p id="appendix-H.3-1.2.1">Section restructuring: impact from proxies on rough counting of clients.<a href="#appendix-H.3-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-H.3-1.3">
            <p id="appendix-H.3-1.3.1">Revised and repositioned text on deterministic phantom requests.<a href="#appendix-H.3-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-H.3-1.4">
            <p id="appendix-H.3-1.4.1">Fixes in the examples with message exchanges.<a href="#appendix-H.3-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-H.3-1.5">
            <p id="appendix-H.3-1.5.1">Clarifications and editorial improvements.<a href="#appendix-H.3-1.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-07-08">
<section id="appendix-H.4">
        <h3 id="name-version-07-to-08">
<a href="#appendix-H.4" class="section-number selfRef">H.4. </a><a href="#name-version-07-to-08" class="section-name selfRef">Version -07 to -08</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-H.4-1.1">
            <p id="appendix-H.4-1.1.1">Fixed the CDDL definition 'srv_addr' in 'tp_info'.<a href="#appendix-H.4-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-H.4-1.2">
            <p id="appendix-H.4-1.2.1">Early mentioning that 'srv_addr' cannot instruct redirection.<a href="#appendix-H.4-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-H.4-1.3">
            <p id="appendix-H.4-1.3.1">The replay protection of multicast notifications is as per Group OSCORE.<a href="#appendix-H.4-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-H.4-1.4">
            <p id="appendix-H.4-1.4.1">Consistently use the format uint for the Multicast-Response-Feedback-Divider Option.<a href="#appendix-H.4-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-H.4-1.5">
            <p id="appendix-H.4-1.5.1">Fixed consumption of proxy-related options in a ticket request sent to the proxy.<a href="#appendix-H.4-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-H.4-1.6">
            <p id="appendix-H.4-1.6.1">Possible use of the option Proxy-Cri or Proxy-Scheme-Number in a ticket request.<a href="#appendix-H.4-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-H.4-1.7">
            <p id="appendix-H.4-1.7.1">Explained non-provisioning of some parameters in self-managed OSCORE groups.<a href="#appendix-H.4-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-H.4-1.8">
            <p id="appendix-H.4-1.8.1">Use of 'exi' for relative expiration time in self-managed OSCORE groups.<a href="#appendix-H.4-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-H.4-1.9">
            <p id="appendix-H.4-1.9.1">Improved notation in the examples of message exchanges with proxy.<a href="#appendix-H.4-1.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-H.4-1.10">
            <p id="appendix-H.4-1.10.1">Clarifications and editorial improvements.<a href="#appendix-H.4-1.10.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-06-07">
<section id="appendix-H.5">
        <h3 id="name-version-06-to-07">
<a href="#appendix-H.5" class="section-number selfRef">H.5. </a><a href="#name-version-06-to-07" class="section-name selfRef">Version -06 to -07</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-H.5-1.1">
            <p id="appendix-H.5-1.1.1">Added more details on proxies that do not support the Multicast-Response-Feedback-Divider Option.<a href="#appendix-H.5-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-H.5-1.2">
            <p id="appendix-H.5-1.2.1">Added more details on the reliability of the client rough counting.<a href="#appendix-H.5-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-H.5-1.3">
            <p id="appendix-H.5-1.3.1">Added more details on the unreliability of counting new clients, when the phantom request is obtained from other sources or is an OSCORE deterministic request.<a href="#appendix-H.5-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-H.5-1.4">
            <p id="appendix-H.5-1.4.1">Revised parameter naming.<a href="#appendix-H.5-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-H.5-1.5">
            <p id="appendix-H.5-1.5.1">Fixes in IANA considerations.<a href="#appendix-H.5-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-H.5-1.6">
            <p id="appendix-H.5-1.6.1">Editorial improvements.<a href="#appendix-H.5-1.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-05-06">
<section id="appendix-H.6">
        <h3 id="name-version-05-to-06">
<a href="#appendix-H.6" class="section-number selfRef">H.6. </a><a href="#name-version-05-to-06" class="section-name selfRef">Version -05 to -06</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-H.6-1.1">
            <p id="appendix-H.6-1.1.1">Clarified rough counting of clients when a proxy is used<a href="#appendix-H.6-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-H.6-1.2">
            <p id="appendix-H.6-1.2.1">IANA considerations: registration of target attribute "gp-obs"<a href="#appendix-H.6-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-H.6-1.3">
            <p id="appendix-H.6-1.3.1">Editorial improvements.<a href="#appendix-H.6-1.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-04-05">
<section id="appendix-H.7">
        <h3 id="name-version-04-to-05">
<a href="#appendix-H.7" class="section-number selfRef">H.7. </a><a href="#name-version-04-to-05" class="section-name selfRef">Version -04 to -05</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-H.7-1.1">
            <p id="appendix-H.7-1.1.1">If the phantom request is an OSCORE deterministic request, there is no parallel group observation for clients that lack support.<a href="#appendix-H.7-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-H.7-1.2">
            <p id="appendix-H.7-1.2.1">Clarification on pre-configured clients.<a href="#appendix-H.7-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-H.7-1.3">
            <p id="appendix-H.7-1.3.1">Clarified early publication of phantom request.<a href="#appendix-H.7-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-H.7-1.4">
            <p id="appendix-H.7-1.4.1">Fixes in IANA considerations.<a href="#appendix-H.7-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-H.7-1.5">
            <p id="appendix-H.7-1.5.1">Fixed example with proxy and Group OSCORE.<a href="#appendix-H.7-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-H.7-1.6">
            <p id="appendix-H.7-1.6.1">Editorial improvements.<a href="#appendix-H.7-1.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-03-04">
<section id="appendix-H.8">
        <h3 id="name-version-03-to-04">
<a href="#appendix-H.8" class="section-number selfRef">H.8. </a><a href="#name-version-03-to-04" class="section-name selfRef">Version -03 to -04</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-H.8-1.1">
            <p id="appendix-H.8-1.1.1">Added a new section on prerequisites.<a href="#appendix-H.8-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-H.8-1.2">
            <p id="appendix-H.8-1.2.1">Added a new section overviewing alternative variants.<a href="#appendix-H.8-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-H.8-1.3">
            <p id="appendix-H.8-1.3.1">Consistent renaming of 'cli_addr' to 'cli_host' in 'tp_info'.<a href="#appendix-H.8-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-H.8-1.4">
            <p id="appendix-H.8-1.4.1">Added pre-requirements for early retrieval of phantom request.<a href="#appendix-H.8-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-H.8-1.5">
            <p id="appendix-H.8-1.5.1">Revised example with early retrieval of phantom request.<a href="#appendix-H.8-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-H.8-1.6">
            <p id="appendix-H.8-1.6.1">Clarified use, rationale and example of phantom request as deterministic request.<a href="#appendix-H.8-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-H.8-1.7">
            <p id="appendix-H.8-1.7.1">Editorial improvements.<a href="#appendix-H.8-1.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-02-03">
<section id="appendix-H.9">
        <h3 id="name-version-02-to-03">
<a href="#appendix-H.9" class="section-number selfRef">H.9. </a><a href="#name-version-02-to-03" class="section-name selfRef">Version -02 to -03</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-H.9-1.1">
            <p id="appendix-H.9-1.1.1">Distinction between authentication credential and public key.<a href="#appendix-H.9-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-H.9-1.2">
            <p id="appendix-H.9-1.2.1">Fixed processing of informative response at the client, when Group OSCORE is used.<a href="#appendix-H.9-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-H.9-1.3">
            <p id="appendix-H.9-1.3.1">Discussed scenarios with pre-configured address/port and Token value.<a href="#appendix-H.9-1.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-01-02">
<section id="appendix-H.10">
        <h3 id="name-version-01-to-02">
<a href="#appendix-H.10" class="section-number selfRef">H.10. </a><a href="#name-version-01-to-02" class="section-name selfRef">Version -01 to -02</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-H.10-1.1">
            <p id="appendix-H.10-1.1.1">Clarifications on client rough counting and IP multicast scope.<a href="#appendix-H.10-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-H.10-1.2">
            <p id="appendix-H.10-1.2.1">The 'ph_req' parameter is optional in the informative response.<a href="#appendix-H.10-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-H.10-1.3">
            <p id="appendix-H.10-1.3.1">New parameter 'next_not_before' for the informative response.<a href="#appendix-H.10-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-H.10-1.4">
            <p id="appendix-H.10-1.4.1">Optimization when rekeying the self-managed OSCORE group.<a href="#appendix-H.10-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-H.10-1.5">
            <p id="appendix-H.10-1.5.1">Security considerations on unsecured multicast notifications.<a href="#appendix-H.10-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-H.10-1.6">
            <p id="appendix-H.10-1.6.1">Protection of the ticket request sent to a proxy.<a href="#appendix-H.10-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-H.10-1.7">
            <p id="appendix-H.10-1.7.1">RFC8126 terminology in IANA considerations.<a href="#appendix-H.10-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-H.10-1.8">
            <p id="appendix-H.10-1.8.1">Editorial improvements.<a href="#appendix-H.10-1.8.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-00-01">
<section id="appendix-H.11">
        <h3 id="name-version-00-to-01">
<a href="#appendix-H.11" class="section-number selfRef">H.11. </a><a href="#name-version-00-to-01" class="section-name selfRef">Version -00 to -01</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-H.11-1.1">
            <p id="appendix-H.11-1.1.1">Simplified cancellation of the group observation, without using a phantom cancellation request.<a href="#appendix-H.11-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-H.11-1.2">
            <p id="appendix-H.11-1.2.1">Aligned parameter semantics with core-oscore-groupcomm and ace-key-groupcomm-oscore.<a href="#appendix-H.11-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-H.11-1.3">
            <p id="appendix-H.11-1.3.1">Clarifications about self-managed OSCORE group and use of deterministic requests for cacheable OSCORE.<a href="#appendix-H.11-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-H.11-1.4">
            <p id="appendix-H.11-1.4.1">New example with a proxy, Group OSCORE and a deterministic phantom request.<a href="#appendix-H.11-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-H.11-1.5">
            <p id="appendix-H.11-1.5.1">Fixes in the examples and editorial improvements.<a href="#appendix-H.11-1.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="acknowldegment">
<section id="appendix-I">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-I-1">The authors sincerely thank <span class="contact-name">Carsten Bormann</span>, <span class="contact-name">Klaus Hartke</span>, <span class="contact-name">Jaime Jiménez</span>, <span class="contact-name">John Preuß Mattsson</span>, <span class="contact-name">Jim Schaad</span>, <span class="contact-name">Ludwig Seitz</span>, and <span class="contact-name">Göran Selander</span> for their comments and feedback.<a href="#appendix-I-1" class="pilcrow">¶</a></p>
<p id="appendix-I-2">The work on this document has been partly supported by the Sweden's Innovation Agency VINNOVA and the Celtic-Next projects CRITISEC and CYPRESS; and by the H2020 project SIFIS-Home (Grant agreement 952652).<a href="#appendix-I-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-J">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Marco Tiloca</span></div>
<div dir="auto" class="left"><span class="org">RISE AB</span></div>
<div dir="auto" class="left"><span class="street-address">Isafjordsgatan 22</span></div>
<div dir="auto" class="left">SE-<span class="postal-code">16440 Stockholm</span> <span class="locality">Kista</span>
</div>
<div dir="auto" class="left"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:marco.tiloca@ri.se" class="email">marco.tiloca@ri.se</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Rikard Höglund</span></div>
<div dir="auto" class="left"><span class="org">RISE AB</span></div>
<div dir="auto" class="left"><span class="street-address">Isafjordsgatan 22</span></div>
<div dir="auto" class="left">SE-<span class="postal-code">16440 Stockholm</span> <span class="locality">Kista</span>
</div>
<div dir="auto" class="left"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:rikard.hoglund@ri.se" class="email">rikard.hoglund@ri.se</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Christian Amsüss</span></div>
<div dir="auto" class="left"><span class="street-address">Hollandstr. 12/4</span></div>
<div dir="auto" class="left">
<span class="postal-code">1020</span> <span class="locality">Vienna</span>
</div>
<div dir="auto" class="left"><span class="country-name">Austria</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:christian@amsuess.com" class="email">christian@amsuess.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Francesca Palombini</span></div>
<div dir="auto" class="left"><span class="org">Ericsson AB</span></div>
<div dir="auto" class="left"><span class="street-address">Torshamnsgatan 23</span></div>
<div dir="auto" class="left">SE-<span class="postal-code">16440 Stockholm</span> <span class="locality">Kista</span>
</div>
<div dir="auto" class="left"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:francesca.palombini@ericsson.com" class="email">francesca.palombini@ericsson.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
